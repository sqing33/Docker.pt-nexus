# <img width="52" height="50" alt="image" src="https://github.com/user-attachments/assets/d4c7835c-0de6-4d28-9b56-68fb473cfb2f" /> PT Nexus

## 一、项目概述

**PT Nexus** 是一款 PT 种子聚合查看平台，分析来自 **qBittorrent** 与 **Transmission** 下载器的种子数据与流量信息。

## 二、功能特性

### 1. 流量统计与分析

- **实时与历史速度监控**：记录下载器的实时上/下行速度，并支持查看历史速度曲线图。
- **多维度流量图表**：通过图表展示多种时间范围的流量数据变化。

### 2. 聚合种子管理

- **跨客户端种子聚合**：将来自 qBittorrent 和 Transmission 的所有种子聚合到统一视图中，方便查看每个种子在已有站点的做种信息，进行统一的筛选、排序和查询。
- **详情页一键跳转**：自动提取种子注释中的 URL 或 ID，并结合预设的站点规则，生成可直接点击的种子详情页链接。

### 3. 站点与发布组统计

- **站点做种统计**：自动统计每个 PT 站点的做种数量和总体积。
- **发布组做种统计**：根据种子名称自动识别所属的发布组（官组或压制组），并对各组的做种数量和体积进行统计。

### 4. 现代化技术栈

- **数据库支持**：支持 **SQLite**（默认，零配置）、**MySQL** 和 **PostgreSQL** 三种数据库后端。
- **全功能 API**：前后端分离架构，所有数据均通过 API 交互，方便二次开发或集成。
- **容器化部署**：提供开箱即用的 Docker Compose 配置，实现简单快速的部署与管理。
- **Go 代理增强功能**：为 qBittorrent 提供高性能 API 代理，解决网络延迟和远程文件处理问题。

## 三、Docker 部署

### Go 代理增强功能

PT Nexus 现在包含一个为 qBittorrent 设计的高性能 Go 语言 API 代理服务。它彻底解决了在广域网环境下直连 qBittorrent 时遇到的**网络延迟高、连接不稳定、无法处理远程文件**等核心痛点。

#### 核心功能

- **高效种子信息聚合**：并发处理来自多个下载器的请求，极大地缩短了数据获取时间，可按需获取种子详细信息并经过 Gzip 压缩减少网络传输量。
- **远程媒体处理**：支持远程截图和 MediaInfo 分析功能，可自动处理服务器上的视频文件并上传到图床，返回 BBCode 格式的图片链接。
- **稳定服务器统计**：快速获取下载器的实时上传/下载速度和累计流量数据，作为下载器健康状况的可靠数据源。
- **健康检查**：提供轻量级端点用于监控代理服务是否正常运行。

#### 部署说明

Go 代理服务已集成到 Docker 镜像中，无需额外配置即可使用。代理服务在容器内监听 9090 端口，提供以下 API 端点：
- `/api/torrents/all` - 并发获取种子列表
- `/api/stats/server` - 获取服务器统计信息
- `/api/media/screenshot` - 远程截图并上传图床
- `/api/media/mediainfo` - 远程获取 MediaInfo
- `/api/health` - 健康检查端点

### 环境变量

新版本完全通过环境变量进行配置，无需手动修改配置文件。

| 分类       | 参数                 | 说明                                | 示例            |
| :--------- | :------------------- | :---------------------------------- | :-------------- |
| **通用**   | `TZ`                 | 设置容器时区，确保时间与日志准确。  | `Asia/Shanghai` |
| **数据库** | `DB_TYPE`            | 选择数据库类型。`sqlite`、`mysql`或`postgresql`。 | `sqlite`        |
|            | `MYSQL_HOST`         | **(MySQL 专用)** 数据库主机地址。   | `192.168.1.100` |
|            | `MYSQL_PORT`         | **(MySQL 专用)** 数据库端口。       | `3306`          |
|            | `MYSQL_DATABASE`     | **(MySQL 专用)** 数据库名称。       | `pt_nexus`      |
|            | `MYSQL_USER`         | **(MySQL 专用)** 数据库用户名。     | `root`          |
|            | `MYSQL_PASSWORD`     | **(MySQL 专用)** 数据库密码。       | `your_password` |
|            | `POSTGRES_HOST`      | **(PostgreSQL 专用)** 数据库主机地址。 | `192.168.1.100` |
|            | `POSTGRES_PORT`      | **(PostgreSQL 专用)** 数据库端口。     | `5432`          |
|            | `POSTGRES_DATABASE`  | **(PostgreSQL 专用)** 数据库名称。     | `pt_nexus`      |
|            | `POSTGRES_USER`      | **(PostgreSQL 专用)** 数据库用户名。   | `postgres`      |
|            | `POSTGRES_PASSWORD`  | **(PostgreSQL 专用)** 数据库密码。     | `your_password` |

### Docker Compose 示例

建议使用 Docker Compose 进行部署，这是最简单且最可靠的方式。

1.  创建一个 `docker-compose.yml` 文件：

    ```yaml
    services:
      pt-nexus:
        image: ghcr.io/sqing33/pt-nexus
        container_name: pt-nexus
        ports:
          - 5272:15272
        volumes:
          - .:/app/data
        environment:
          - TZ=Asia/Shanghai
          - DB_TYPE=sqlite
    ```

2.  在与 `docker-compose.yml` 相同的目录下，运行以下命令启动服务：
    ```bash
    docker-compose up -d
    ```
3.  服务启动后，通过 `http://<你的服务器IP>:5272` 访问 PT Nexus 界面。
4.  进入设置页面，添加下载器，如添加后数据未更新则点击右上角`刷新`按钮。

> **注意**：Go 代理服务已集成在容器中，会自动启动并监听 9090 端口，无需额外配置。

## 四、更新日志

### v1.2.1（2025-8-25）

- 适配了更多站点的种子查询
- 修复种子页面总上传量始终为 0 的问题
- 修复站点信息页面 UI 问题

### v1.2（2025-8-25）

- 适配了更多站点的种子查询
- 修改种子查询页面为站点名称首字母排序
- 修改站点筛选和路径筛选的 UI
- 新增下载器实时速率开关，关闭则 1 分钟更新一次上传下载量（开启为每秒一次）
- 新增下载器图表上传下载显示切换开关，可单独查看上传数据或下载数据
- 修复速率图表图例数值显示不完全的问题
- 修复站点信息页面表格在窗口变窄的情况下数据展示不完全的问题

### v1.1.1（2025-8-23）

- 适配 mysql

### v1.1（2025-8-23）

- 新增设置页面，实现多下载器支持。

### v1.0（2025-8-19）

- 完成下载统计、种子查询、站点信息查询功能。
