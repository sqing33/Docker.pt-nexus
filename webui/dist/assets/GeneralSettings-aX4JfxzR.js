import{d as Qe,r as c,N as W,o as Je,c as y,h as a,b as s,n as ke,l as U,j as N,w as t,e as x,F as M,f as w,z as g,x as i,a8 as we,i as r,W as xe,a9 as Ve,aa as pe,ab as ge,a1 as B,R as se,ac as Xe,ad as Ze,t as V,u as _e,v as es,k as te,$ as ss,M as ts,D as as,ae as Ce,af as ze,P as ls,g as u,B as os,q as ns,m as rs}from"./index-C8dd3Dm3.js";const ds={class:"settings-container"},is={class:"settings-grid"},us={class:"card-header"},cs={class:"header-content"},ps={class:"card-content"},gs={class:"password-hint"},_s={class:"settings-card glass-card glass-rounded glass-transparent-header glass-transparent-body"},ms={class:"card-header"},fs={class:"header-content"},vs={class:"card-content"},ys={class:"settings-card glass-card glass-rounded glass-transparent-header glass-transparent-body"},hs={class:"card-header"},bs={class:"header-content"},ks={class:"card-content"},ws={style:{display:"flex","align-items":"center",gap:"15px"}},xs={style:{flex:"1",display:"flex","flex-direction":"column","justify-content":"center"}},Vs={style:{display:"flex",margin:"auto",gap:"20px","justify-content":"center",padding:"15px 0"}},Cs={style:{height:"500px","overflow-y":"auto"}},zs={key:0,style:{"text-align":"center",padding:"20px",color:"#999"}},Us={key:1},Ps={style:{color:"#999","margin-right":"10px"}},Is={style:{"margin-left":"10px"}},Ts={style:{"text-align":"right"}},Ss={class:"settings-card glass-card glass-rounded glass-transparent-header glass-transparent-body"},Ns={class:"card-header"},Ms={class:"header-content"},As={class:"card-content"},Fs={key:"agsv",class:"credential-section"},Rs={class:"credential-header"},Es={class:"credential-form"},Bs={key:"other",class:"placeholder-section"},Ls={class:"settings-card glass-card glass-rounded glass-transparent-header glass-transparent-body"},Ys={class:"card-header"},$s={class:"header-content"},Gs={class:"card-content"},js={style:{display:"flex","align-items":"center",gap:"20px",padding:"15px 0"}},Ds={class:"form-item",style:{"margin-bottom":"16px"}},Ks={style:{display:"flex","align-items":"center","justify-content":"space-between","margin-bottom":"6px"}},Os={class:"settings-card glass-card glass-rounded glass-transparent-header glass-transparent-body"},qs={class:"card-header"},Ws={class:"header-content"},Hs={class:"card-content"},Qs={style:{display:"flex","align-items":"center",gap:"16px","flex-wrap":"wrap"}},Js={style:{display:"flex","align-items":"center",gap:"12px","flex-wrap":"nowrap",width:"100%","margin-top":"8px"}},Xs={style:{"margin-top":"8px"}},Zs={class:"settings-card glass-card glass-rounded glass-transparent-header glass-transparent-body"},et={class:"card-header"},st={class:"header-content"},tt={class:"card-content"},at={style:{display:"flex","align-items":"center",gap:"30px"}},lt={style:{display:"flex","align-items":"center",gap:"12px"}},ot={style:{display:"flex","align-items":"center",gap:"12px"}},nt={style:{display:"flex","align-items":"center",gap:"10px"}},rt={key:0,style:{display:"flex","flex-wrap":"wrap",gap:"8px"}},dt={style:{display:"flex","align-items":"center",gap:"10px"}},it={class:"settings-card glass-card glass-rounded glass-transparent-header glass-transparent-body"},ut={class:"card-header"},ct={class:"header-content"},pt={class:"card-content placeholder-content"},gt={style:{"min-height":"300px"}},_t={key:0,style:{"text-align":"center",padding:"40px",color:"var(--el-text-color-secondary)"}},mt={key:1},ft={style:{"margin-bottom":"16px",display:"flex","justify-content":"space-between","align-items":"center"}},vt={style:{color:"var(--el-text-color-regular)"}},yt={class:"path-tree-container"},ht={style:{"text-align":"right"}},bt=Qe({__name:"GeneralSettings",setup(kt){const H=c(!1),Q=c(!1),me=c("admin"),J=c(!1),f=c({old_password:"",username:"",password:""}),m=W({token:"",path_filter_enabled:!1,selected_paths:[]}),S=c([]),L=c(!1),Y=c(!1),$=c([]),P=c(),G=c([]),fe=c(!1),d=W({image_hoster:"pixhost",agsv_email:"",agsv_password:"",default_downloader:"",publish_batch_concurrency_mode:"cpu",publish_batch_concurrency_manual:5}),Ue=[{value:"pixhost",label:"Pixhost (免费)"},{value:"agsv",label:"末日图床 (需账号)"}],ae=c(!1),C=c(null),ve=c([]),z=c(""),A=c(!1),F=c(""),Pe=()=>{A.value=!A.value,A.value?F.value=z.value:F.value=z.value?"*".repeat(z.value.length):""},Ie=l=>{l.length>0&&l.split("").every(o=>o==="*")||(z.value=l,m.token=l)},X=c(!1),j=c([]),le=c(!1),oe=c(!1),R=W({background_url:""}),ne=c(!1),I=W({anonymous_upload:!0,cspt_ptgen_token:""}),Te=()=>{window.open("https://cspt.top/ptgen.php","_blank")};c(!1);const v=W({category:{enabled:!0,category:""},tags:{enabled:!0,tags:["PT Nexus","站点/{站点名称}"]}}),Z=c(""),ye=()=>{const l=Z.value;if(l&&l.trim()){const e=l.trim();v.tags.tags.includes(e)?g.warning("该标签已存在"):(v.tags.tags.push(e),D(),Z.value="")}},Se=l=>{v.tags.tags.splice(l,1),D()},D=async()=>{try{const l={category:v.category,tags:v.tags};console.log("正在保存标签配置:",l);const e=await w.post("/api/config/tags",l);console.log("保存结果:",e.data)}catch(l){const e=l.response?.data?.message||"保存失败。";console.error("保存失败:",e),g.error(e)}},E=async()=>{fe.value=!0;try{const l={image_hoster:d.image_hoster,agsv_email:d.agsv_email,agsv_password:d.agsv_password,default_downloader:d.default_downloader,publish_batch_concurrency_mode:d.publish_batch_concurrency_mode,publish_batch_concurrency_manual:d.publish_batch_concurrency_manual,cspt_ptgen_token:I.cspt_ptgen_token};await w.post("/api/settings/cross_seed",l)}catch(l){const e=l.response?.data?.error||"保存失败。";g.error(e)}finally{fe.value=!1}},Ne=async()=>{ae.value=!0;try{const l=await w.get("/api/settings/cross_seed/publish_concurrency_info");l.data?.success&&(C.value=l.data)}catch{}finally{ae.value=!1}},Me=()=>{if(d.publish_batch_concurrency_mode==="manual"){const l=Number(d.publish_batch_concurrency_manual||0);(!Number.isFinite(l)||l<1)&&(d.publish_batch_concurrency_manual=C.value?.effective_suggested_concurrency||5)}E()},Ae=()=>{const l=Number(d.publish_batch_concurrency_manual||0);d.publish_batch_concurrency_manual=Math.max(1,Math.floor(l||1)),E()},Fe=async()=>{try{const l=await w.get("/api/auth/status");l.data?.success&&(me.value=l.data.username||"admin",J.value=!!l.data.must_change_password,f.value.username=me.value);const o=(await w.get("/api/settings")).data;if(o.iyuu_token){z.value=o.iyuu_token;const p="*".repeat(o.iyuu_token.length);m.token=p,F.value=p}else z.value="",m.token="",F.value="";o.iyuu_settings&&(m.path_filter_enabled=o.iyuu_settings.path_filter_enabled||!1,m.selected_paths=o.iyuu_settings.selected_paths||[]),Object.assign(d,o.cross_seed||{}),o.ui_settings&&o.ui_settings.background_url&&(R.background_url=o.ui_settings.background_url),o.upload_settings&&(I.anonymous_upload=o.upload_settings.anonymous_upload!==!1),o.cross_seed&&o.cross_seed.cspt_ptgen_token&&(I.cspt_ptgen_token=o.cross_seed.cspt_ptgen_token),o.tags_config&&(o.tags_config.category&&(v.category.enabled=o.tags_config.category.enabled,v.category.category=o.tags_config.category.category),o.tags_config.tags&&(v.tags.enabled=o.tags_config.tags.enabled,v.tags.tags=o.tags_config.tags.tags||[]));const b=await w.get("/api/downloaders_list");ve.value=b.data,await Ne(),m.path_filter_enabled&&await K()}catch{g.error("无法加载设置。")}},Re=l=>{const e=[],o=new Map;return l.sort().forEach(b=>{const p=b.replace(/^\/|\/$/g,"").split("/");let h="",_=e;p.forEach((k,T)=>{if(h=T===0?`/${k}`:`${h}/${k}`,!o.has(h)){const q={path:T===p.length-1?b:h,label:k,children:[]};o.set(h,q),_.push(q)}_=o.get(h).children})}),o.forEach(b=>{b.children&&b.children.length===0&&delete b.children}),e},K=async()=>{L.value=!0;try{const l=await w.get("/api/paths");l.data.success?(S.value=l.data.paths||[],G.value=Re(S.value)):(g.error(l.data.error||"获取路径列表失败"),S.value=[],G.value=[])}catch(l){const e=l.response?.data?.error||"获取路径列表失败";g.error(e),S.value=[],G.value=[]}finally{L.value=!1}},he=async()=>{if(!Q.value){Q.value=!0;try{const l={path_filter_enabled:m.path_filter_enabled,selected_paths:m.selected_paths};if(await w.post("/api/iyuu/settings",l),z.value&&m.token!=="********"){const e={iyuu_token:z.value};await w.post("/api/settings",e),A.value=!1;const o=z.value?"*".repeat(z.value.length):"";F.value=o,m.token=o}else if(!z.value&&m.token){const e={iyuu_token:m.token};await w.post("/api/settings",e),z.value=m.token}g.success("IYUU 设置已保存！")}catch(l){const e=l.response?.data?.error||"保存失败。";g.error(e)}finally{Q.value=!1}}},Ee=async()=>{try{g.success("IYUU 查询已触发，请稍后查看结果。"),w.post("/api/iyuu/trigger_query").catch(l=>{console.error("IYUU 查询后台执行失败:",l)}),re()}catch(l){const e=l.response?.data?.message||"触发查询失败。";g.error(e)}},re=async()=>{le.value=!0,X.value=!0;try{const l=await w.get("/api/iyuu/logs");l.data.success?j.value=l.data.logs||[]:(g.error(l.data.message||"获取日志失败"),j.value=[])}catch(l){const e=l.response?.data?.message||"获取日志失败";g.error(e),j.value=[]}finally{le.value=!1}},Be=async()=>{if(!H.value){if(!f.value.old_password){g.warning("请填写当前密码");return}if(!f.value.username&&!f.value.password){g.warning("请输入新用户名或新密码");return}if(f.value.username&&f.value.username.trim().length<3){g.warning("用户名至少 3 个字符");return}if(f.value.password&&f.value.password.length<6){g.warning("密码至少 6 位");return}H.value=!0;try{const l={old_password:f.value.old_password};f.value.username&&(l.username=f.value.username),f.value.password&&(l.password=f.value.password);const e=await w.post("/api/auth/change_password",l);e.data?.success?(g.success("保存成功，请重新登录"),localStorage.removeItem("token"),window.location.href="/login"):g.error(e.data?.message||"保存失败")}catch(l){g.error(l?.response?.data?.message||"保存失败")}finally{H.value=!1}}},Le=async()=>{oe.value=!0;try{const l={ui_settings:{background_url:R.background_url}};await w.post("/api/settings",l),g.success("背景设置已保存！"),window.dispatchEvent(new CustomEvent("background-updated",{detail:{backgroundUrl:R.background_url}}))}catch(l){const e=l.response?.data?.error||"保存失败。";g.error(e)}finally{oe.value=!1}},Ye=async()=>{ne.value=!0;try{const l={anonymous_upload:I.anonymous_upload};await w.post("/api/upload_settings",l);const e={image_hoster:d.image_hoster,agsv_email:d.agsv_email,agsv_password:d.agsv_password,default_downloader:d.default_downloader,cspt_ptgen_token:I.cspt_ptgen_token,publish_batch_concurrency_mode:d.publish_batch_concurrency_mode,publish_batch_concurrency_manual:d.publish_batch_concurrency_manual};await w.post("/api/settings/cross_seed",e),g.success("上传设置已保存！")}catch(l){const e=l.response?.data?.error||"保存失败。";g.error(e)}finally{ne.value=!1}},$e=async l=>{l&&S.value.length===0&&await K()},de=()=>P.value?P.value.getCheckedNodes().filter(e=>!e.children||e.children.length===0).map(e=>e.path):[],Ge=()=>{$.value=de()},je=async()=>{S.value.length===0&&await K(),Y.value=!0,await ns(),P.value&&(P.value.setCheckedKeys([]),P.value.setCheckedKeys(m.selected_paths))},De=()=>{if(P.value){const l=[],e=o=>{o.forEach(b=>{!b.children||b.children.length===0?l.push(b.path):e(b.children)})};e(G.value),P.value.setCheckedKeys(l),$.value=l}},Ke=()=>{P.value&&(P.value.setCheckedKeys([]),$.value=[])},Oe=()=>{m.selected_paths=de(),Y.value=!1,g.success(`已选择 ${m.selected_paths.length} 个路径`),he()};return Je(()=>{Fe()}),(l,e)=>{const o=x("el-icon"),b=x("el-tag"),p=x("el-button"),h=x("el-input"),_=x("el-form-item"),k=x("el-text"),T=x("el-form"),O=x("el-switch"),q=x("el-dialog"),ie=x("el-option"),be=x("el-select"),ue=x("el-radio"),qe=x("el-input-number"),We=x("el-radio-group"),He=x("el-tree"),ce=es("loading");return u(),y(M,null,[a("div",ds,[a("div",is,[a("div",{class:ke(["settings-card glass-card glass-rounded glass-transparent-header glass-transparent-body",{"temp-password-highlight":J.value}])},[a("div",us,[a("div",cs,[s(o,{class:"header-icon"},{default:t(()=>[s(i(we))]),_:1}),e[23]||(e[23]=a("h3",null,"账户信息",-1)),J.value?(u(),U(b,{key:0,type:"danger",size:"small",effect:"dark"},{default:t(()=>[s(o,{style:{"vertical-align":"middle","margin-right":"4px"}},{default:t(()=>[s(i(xe))]),_:1}),e[22]||(e[22]=r(" 临时密码-请立即修改 ",-1))]),_:1})):N("",!0)]),s(p,{type:"primary",loading:H.value,onClick:Be,size:"small"},{default:t(()=>[...e[24]||(e[24]=[r(" 保存 ",-1)])]),_:1},8,["loading"])]),a("div",ps,[s(T,{model:f.value,"label-position":"top",class:"settings-form"},{default:t(()=>[s(_,{label:"用户名",class:"form-item"},{default:t(()=>[s(h,{modelValue:f.value.username,"onUpdate:modelValue":e[0]||(e[0]=n=>f.value.username=n),placeholder:"请输入用户名",clearable:""},{prefix:t(()=>[s(o,null,{default:t(()=>[s(i(we))]),_:1})]),_:1},8,["modelValue"])]),_:1}),s(_,{label:"当前密码",required:"",class:"form-item"},{default:t(()=>[s(h,{modelValue:f.value.old_password,"onUpdate:modelValue":e[1]||(e[1]=n=>f.value.old_password=n),type:"password",placeholder:"请输入当前密码","show-password":""},{prefix:t(()=>[s(o,null,{default:t(()=>[s(i(Ve))]),_:1})]),_:1},8,["modelValue"])]),_:1}),s(_,{label:"新密码",class:"form-item"},{default:t(()=>[s(h,{modelValue:f.value.password,"onUpdate:modelValue":e[2]||(e[2]=n=>f.value.password=n),type:"password",placeholder:"至少 6 位","show-password":""},{prefix:t(()=>[s(o,null,{default:t(()=>[s(i(pe))]),_:1})]),_:1},8,["modelValue"]),a("div",gs,[s(k,{type:"info",size:"small"},{default:t(()=>[...e[25]||(e[25]=[r("留空表示不修改密码",-1)])]),_:1})])]),_:1}),e[27]||(e[27]=a("div",{class:"form-spacer"},null,-1)),J.value?(u(),U(k,{key:0,type:"warning",size:"small",class:"security-hint"},{default:t(()=>[s(o,{size:"12"},{default:t(()=>[s(i(xe))]),_:1}),e[26]||(e[26]=r(" 为确保安全，请立即设置新用户名与密码 ",-1))]),_:1})):N("",!0)]),_:1},8,["model"])])],2),a("div",_s,[a("div",ms,[a("div",fs,[s(o,{class:"header-icon"},{default:t(()=>[s(i(ge))]),_:1}),e[28]||(e[28]=a("h3",null,"背景设置",-1))]),s(p,{type:"primary",loading:oe.value,onClick:Le,size:"small"},{default:t(()=>[...e[29]||(e[29]=[r(" 保存 ",-1)])]),_:1},8,["loading"])]),a("div",vs,[s(T,{model:R,"label-position":"top",class:"settings-form"},{default:t(()=>[s(_,{label:"背景图片URL",class:"form-item"},{default:t(()=>[s(h,{modelValue:R.background_url,"onUpdate:modelValue":e[3]||(e[3]=n=>R.background_url=n),placeholder:"请输入背景图片的URL地址",clearable:""},{prefix:t(()=>[s(o,null,{default:t(()=>[s(i(ge))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e[31]||(e[31]=a("div",{class:"form-spacer"},null,-1)),s(k,{type:"info",size:"small",class:"proxy-hint"},{default:t(()=>[s(o,{size:"12"},{default:t(()=>[s(i(B))]),_:1}),e[30]||(e[30]=r(" 设置应用程序的背景图片，支持在线图片URL ",-1))]),_:1})]),_:1},8,["model"])])]),a("div",ys,[a("div",hs,[a("div",bs,[s(o,{class:"header-icon"},{default:t(()=>[s(i(se))]),_:1}),e[32]||(e[32]=a("h3",null,"IYUU设置",-1))]),s(p,{type:"primary",loading:Q.value,onClick:he,size:"small"},{default:t(()=>[...e[33]||(e[33]=[r(" 保存 ",-1)])]),_:1},8,["loading"])]),a("div",ks,[s(T,{model:m,"label-position":"top",class:"settings-form"},{default:t(()=>[s(_,{label:"IYUU Token",class:"form-item"},{default:t(()=>[s(h,{modelValue:F.value,"onUpdate:modelValue":e[4]||(e[4]=n=>F.value=n),type:A.value?"text":"password",placeholder:"请输入IYUU Token",onInput:Ie},{prefix:t(()=>[s(o,null,{default:t(()=>[s(i(pe))]),_:1})]),suffix:t(()=>[s(o,{onClick:Pe,style:{cursor:"pointer"},class:ke({"is-active":A.value})},{default:t(()=>[A.value?(u(),U(i(Ze),{key:1})):(u(),U(i(Xe),{key:0}))]),_:1},8,["class"])]),_:1},8,["modelValue","type"])]),_:1}),s(_,{label:"查询路径限制",class:"form-item"},{default:t(()=>[a("div",ws,[s(O,{modelValue:m.path_filter_enabled,"onUpdate:modelValue":e[5]||(e[5]=n=>m.path_filter_enabled=n),"active-text":"启用路径过滤","inactive-text":"禁用路径过滤",onChange:$e},null,8,["modelValue"]),m.path_filter_enabled?(u(),U(p,{key:0,type:"primary",size:"small",onClick:je},{default:t(()=>[r(" 选择路径 ("+V(m.selected_paths.length)+") ",1)]),_:1})):N("",!0)])]),_:1}),a("div",xs,[s(_,{label:"",class:"form-item"},{default:t(()=>[a("div",Vs,[s(p,{type:"success",onClick:Ee,size:"default",style:{"font-size":"14px",padding:"12px 24px"}},{default:t(()=>[...e[34]||(e[34]=[r(" 手动触发查询 ",-1)])]),_:1}),s(p,{type:"primary",onClick:re,size:"default",style:{"font-size":"14px",padding:"12px 24px"}},{default:t(()=>[...e[35]||(e[35]=[r(" 查看日志 ",-1)])]),_:1})])]),_:1}),s(k,{type:"info",size:"small",style:{display:"block","text-align":"center",margin:"10px 0"}},{default:t(()=>[s(o,{size:"12"},{default:t(()=>[s(i(B))]),_:1}),e[36]||(e[36]=r(" 种子查询页面的红色表示可辅种但未在做种 ",-1))]),_:1})]),e[38]||(e[38]=a("div",{class:"form-spacer"},null,-1)),s(k,{type:"info",size:"small",class:"proxy-hint"},{default:t(()=>[s(o,{size:"12"},{default:t(()=>[s(i(B))]),_:1}),e[37]||(e[37]=r(" 用于与IYUU平台进行数据同步和通信的身份验证令牌 ",-1))]),_:1})]),_:1},8,["model"])])]),s(q,{modelValue:X.value,"onUpdate:modelValue":e[7]||(e[7]=n=>X.value=n),title:"IYUU 查询日志",width:"800px",top:"50px"},{footer:t(()=>[a("div",Ts,[s(p,{onClick:e[6]||(e[6]=n=>X.value=!1)},{default:t(()=>[...e[39]||(e[39]=[r("关闭",-1)])]),_:1}),s(p,{type:"primary",onClick:re},{default:t(()=>[...e[40]||(e[40]=[r("刷新",-1)])]),_:1})])]),default:t(()=>[_e((u(),y("div",Cs,[j.value.length===0?(u(),y("div",zs," 暂无日志记录 ")):(u(),y("div",Us,[(u(!0),y(M,null,te(j.value,(n,ee)=>(u(),y("div",{key:ee,style:{padding:"8px 0","border-bottom":"1px solid #eee","font-size":"12px"}},[a("span",Ps,"["+V(n.timestamp)+"]",1),a("span",{style:os({color:n.level==="ERROR"?"#F56C6C":n.level==="WARNING"?"#E6A23C":n.level==="INFO"?"#409EFF":"#67C23A"})},"["+V(n.level)+"]",5),a("span",Is,V(n.message),1)]))),128))]))])),[[ce,le.value]])]),_:1},8,["modelValue"]),a("div",Ss,[a("div",Ns,[a("div",Ms,[s(o,{class:"header-icon"},{default:t(()=>[s(i(ge))]),_:1}),e[41]||(e[41]=a("h3",null,"图床设置",-1))])]),a("div",As,[s(T,{model:d,"label-position":"top",class:"settings-form"},{default:t(()=>[s(_,{label:"截图图床",class:"form-item"},{default:t(()=>[s(be,{modelValue:d.image_hoster,"onUpdate:modelValue":e[8]||(e[8]=n=>d.image_hoster=n),placeholder:"请选择图床服务",onChange:E},{default:t(()=>[(u(),y(M,null,te(Ue,n=>s(ie,{key:n.value,label:n.label,value:n.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),s(ss,{name:"slide",mode:"out-in"},{default:t(()=>[d.image_hoster==="agsv"?(u(),y("div",Fs,[a("div",Rs,[s(o,{class:"credential-icon"},{default:t(()=>[s(i(Ve))]),_:1}),e[42]||(e[42]=a("span",{class:"credential-title"},"末日图床账号凭据",-1))]),a("div",Es,[s(_,{label:"邮箱",class:"form-item compact"},{default:t(()=>[s(h,{modelValue:d.agsv_email,"onUpdate:modelValue":e[9]||(e[9]=n=>d.agsv_email=n),placeholder:"请输入邮箱",size:"small",onBlur:E},null,8,["modelValue"])]),_:1}),s(_,{label:"密码",class:"form-item compact"},{default:t(()=>[s(h,{modelValue:d.agsv_password,"onUpdate:modelValue":e[10]||(e[10]=n=>d.agsv_password=n),type:"password",placeholder:"请输入密码","show-password":"",size:"small",onBlur:E},null,8,["modelValue"])]),_:1})])])):(u(),y("div",Bs,[s(k,{type:"info",size:"small"},{default:t(()=>[...e[43]||(e[43]=[r("当前图床无需额外配置，但是需要代理才能上传",-1)])]),_:1})]))]),_:1})]),_:1},8,["model"])])]),a("div",Ls,[a("div",Ys,[a("div",$s,[s(o,{class:"header-icon"},{default:t(()=>[s(i(se))]),_:1}),e[44]||(e[44]=a("h3",null,"转种设置",-1))]),s(p,{type:"primary",onClick:Ye,loading:ne.value,size:"small"},{default:t(()=>[...e[45]||(e[45]=[r(" 保存 ",-1)])]),_:1},8,["loading"])]),a("div",Gs,[s(T,{model:I,"label-position":"top",class:"settings-form"},{default:t(()=>[s(_,{label:"",class:"form-item"},{default:t(()=>[a("div",js,[s(O,{modelValue:I.anonymous_upload,"onUpdate:modelValue":e[11]||(e[11]=n=>I.anonymous_upload=n),"active-text":"启用匿名","inactive-text":"禁用匿名"},null,8,["modelValue"])])]),_:1}),a("div",Ds,[a("div",Ks,[e[47]||(e[47]=a("span",{style:{"font-weight":"500",color:"var(--el-text-color-regular)","font-size":"13px"}}," 财神 PTGen API Token（每日100次） ",-1)),s(p,{type:"primary",link:"",onClick:Te,style:{"white-space":"nowrap"}},{default:t(()=>[s(o,{style:{"margin-right":"4px"}},{default:t(()=>[s(i(ts))]),_:1}),e[46]||(e[46]=r(" 获取Token ",-1))]),_:1})]),s(h,{modelValue:I.cspt_ptgen_token,"onUpdate:modelValue":e[12]||(e[12]=n=>I.cspt_ptgen_token=n),type:"password",placeholder:"请输入财神 PTGen API Token","show-password":""},{prefix:t(()=>[s(o,null,{default:t(()=>[s(i(pe))]),_:1})]),_:1},8,["modelValue"])]),e[55]||(e[55]=a("div",{class:"form-spacer"},null,-1)),s(k,{type:"info",size:"small",class:"proxy-hint"},{default:t(()=>[s(o,{size:"12"},{default:t(()=>[s(i(B))]),_:1}),e[48]||(e[48]=r(" 启用后，发布种子时将使用匿名模式，不显示上传者信息",-1)),e[49]||(e[49]=a("br",null,null,-1)),e[50]||(e[50]=r(" 配置财神 PTGen API Token 后，优先使用该API获取影片信息",-1)),e[51]||(e[51]=a("br",null,null,-1)),e[52]||(e[52]=r(" 财神 PTGen API 每日限量 100+ 次，上限随等级提升",-1)),e[53]||(e[53]=a("br",null,null,-1)),e[54]||(e[54]=r(" 使用完会自动切换内置的其他 PTGen API ",-1))]),_:1})]),_:1},8,["model"])])]),a("div",Os,[a("div",qs,[a("div",Ws,[s(o,{class:"header-icon"},{default:t(()=>[s(i(as))]),_:1}),e[56]||(e[56]=a("h3",null,"发种设置",-1))])]),a("div",Hs,[s(T,{model:d,"label-position":"top",class:"settings-form"},{default:t(()=>[s(_,{label:"默认下载器",class:"form-item"},{default:t(()=>[s(be,{modelValue:d.default_downloader,"onUpdate:modelValue":e[13]||(e[13]=n=>d.default_downloader=n),placeholder:"请选择默认下载器",clearable:"",onChange:E},{default:t(()=>[s(ie,{label:"使用源种子所在的下载器",value:""}),(u(!0),y(M,null,te(ve.value,n=>(u(),U(ie,{key:n.id,label:n.name,value:n.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e[61]||(e[61]=a("div",{class:"form-spacer"},null,-1)),s(k,{type:"info",size:"small",class:"proxy-hint"},{default:t(()=>[s(o,{size:"12"},{default:t(()=>[s(i(B))]),_:1}),e[57]||(e[57]=r(' 发种完成后自动将种子添加到指定的下载器。选择"使用源种子所在的下载器"或不选择任何下载器，则添加到源种子所在的下载器。 ',-1))]),_:1}),e[62]||(e[62]=a("div",{class:"form-spacer"},null,-1)),s(_,{label:"批量发布并发策略",class:"form-item"},{default:t(()=>[s(We,{modelValue:d.publish_batch_concurrency_mode,"onUpdate:modelValue":e[15]||(e[15]=n=>d.publish_batch_concurrency_mode=n),onChange:Me},{default:t(()=>[a("div",Qs,[s(ue,{label:"cpu"},{default:t(()=>[...e[58]||(e[58]=[r("自动（CPU线程数×2）",-1)])]),_:1}),s(ue,{label:"all"},{default:t(()=>[...e[59]||(e[59]=[r("所有站点同时发布",-1)])]),_:1})]),a("div",Js,[s(ue,{label:"manual",style:{"white-space":"nowrap"}},{default:t(()=>[...e[60]||(e[60]=[r("手动设置并发数",-1)])]),_:1}),d.publish_batch_concurrency_mode==="manual"?(u(),U(qe,{key:0,modelValue:d.publish_batch_concurrency_manual,"onUpdate:modelValue":e[14]||(e[14]=n=>d.publish_batch_concurrency_manual=n),size:"small",min:1,max:C.value?.max_concurrency||200,style:{width:"150px",height:"25px"},onChange:Ae},null,8,["modelValue","max"])):N("",!0)])]),_:1},8,["modelValue"]),_e((u(),y("div",Xs,[d.publish_batch_concurrency_mode==="cpu"?(u(),U(k,{key:0,type:"info",size:"small"},{default:t(()=>[r(" 当前服务器 CPU 线程数 "+V(C.value?.cpu_threads??"-")+"，推荐并发 "+V(C.value?.suggested_concurrency??"-")+" ",1),C.value&&C.value.effective_suggested_concurrency!==C.value.suggested_concurrency?(u(),y(M,{key:0},[r(" （受上限 "+V(C.value.max_concurrency)+" 影响，实际将使用 "+V(C.value.effective_suggested_concurrency)+"） ",1)],64)):N("",!0)]),_:1})):d.publish_batch_concurrency_mode==="all"?(u(),U(k,{key:1,type:"info",size:"small"},{default:t(()=>[r(" 将并发等于“本次选择的目标站点数量”（上限 "+V(C.value?.max_concurrency??"-")+"）。 ",1)]),_:1})):(u(),U(k,{key:2,type:"info",size:"small"},{default:t(()=>[r(" 手动并发数将在发布时生效（上限 "+V(C.value?.max_concurrency??"-")+"）。 ",1)]),_:1}))])),[[ce,ae.value]])]),_:1})]),_:1},8,["model"])])]),a("div",Zs,[a("div",et,[a("div",st,[s(o,{class:"header-icon"},{default:t(()=>[s(i(Ce))]),_:1}),e[63]||(e[63]=a("h3",null,"下载器标签/分类设置",-1))])]),a("div",tt,[s(T,{model:v,"label-position":"top",class:"settings-form"},{default:t(()=>[s(_,{label:"",class:"form-item"},{default:t(()=>[a("div",at,[a("div",lt,[s(o,{size:"20"},{default:t(()=>[s(i(Ce))]),_:1}),e[64]||(e[64]=a("span",{style:{"font-weight":"500","font-size":"14px"}},"标签",-1)),s(O,{modelValue:v.tags.enabled,"onUpdate:modelValue":e[16]||(e[16]=n=>v.tags.enabled=n),onChange:D},null,8,["modelValue"])]),a("div",ot,[s(o,{size:"20"},{default:t(()=>[s(i(ze))]),_:1}),e[65]||(e[65]=a("span",{style:{"font-weight":"500","font-size":"14px"}},"分类",-1)),s(O,{modelValue:v.category.enabled,"onUpdate:modelValue":e[17]||(e[17]=n=>v.category.enabled=n),onChange:D},null,8,["modelValue"])])])]),_:1}),v.tags.enabled?(u(),y(M,{key:0},[s(_,{label:"自定义标签",class:"form-item",style:{margin:"0"}}),s(_,{label:"",class:"form-item"},{default:t(()=>[a("div",nt,[s(h,{modelValue:Z.value,"onUpdate:modelValue":e[18]||(e[18]=n=>Z.value=n),placeholder:"输入新标签",style:{height:"32px",width:"200px"},onKeyup:ls(ye,["enter"])},null,8,["modelValue"]),s(p,{type:"primary",size:"small",onClick:ye},{default:t(()=>[...e[66]||(e[66]=[r(" 添加标签 ",-1)])]),_:1})])]),_:1}),s(_,{label:"",class:"form-item"},{default:t(()=>[v.tags.tags.length>0?(u(),y("div",rt,[(u(!0),y(M,null,te(v.tags.tags,(n,ee)=>(u(),U(b,{key:ee,closable:"",onClose:wt=>Se(ee),size:"small"},{default:t(()=>[r(V(n),1)]),_:2},1032,["onClose"]))),128))])):N("",!0)]),_:1})],64)):N("",!0),v.category.enabled?(u(),y(M,{key:1},[s(_,{label:"自定义分类",class:"form-item",style:{margin:"0"}}),s(_,{class:"form-item"},{default:t(()=>[a("div",dt,[s(h,{modelValue:v.category.category,"onUpdate:modelValue":e[19]||(e[19]=n=>v.category.category=n),placeholder:"输入分类名称",size:"small",clearable:"",style:{height:"32px",width:"200px"}},null,8,["modelValue"]),s(p,{type:"primary",size:"small",onClick:D},{default:t(()=>[...e[67]||(e[67]=[r(" 保存 ",-1)])]),_:1})])]),_:1})],64)):N("",!0),e[73]||(e[73]=a("div",{class:"form-spacer"},null,-1)),s(k,{type:"info",size:"small",class:"proxy-hint"},{default:t(()=>[s(o,{size:"12"},{default:t(()=>[s(i(B))]),_:1}),e[68]||(e[68]=r(" 启用标签与分类功能后，会自动为种子添加标签与分类",-1)),e[69]||(e[69]=a("br",null,null,-1)),e[70]||(e[70]=r(' 默认添加"站点/{站点名称}"和"PT Nexus"标签',-1)),e[71]||(e[71]=a("br",null,null,-1)),e[72]||(e[72]=r(" 自定义标签：可以为转种的种子添加自定义标签 ",-1))]),_:1})]),_:1},8,["model"])])]),a("div",it,[a("div",ut,[a("div",ct,[s(o,{class:"header-icon"},{default:t(()=>[s(i(se))]),_:1}),e[74]||(e[74]=a("h3",null,"功能扩展",-1))])]),a("div",pt,[s(o,{class:"placeholder-icon"},{default:t(()=>[s(i(se))]),_:1}),e[75]||(e[75]=a("p",{class:"placeholder-text"},"功能扩展中",-1))])])])]),a("div",null,[a("div",null,[s(q,{modelValue:Y.value,"onUpdate:modelValue":e[21]||(e[21]=n=>Y.value=n),title:"选择IYUU查询路径",width:"600px",top:"50px"},{footer:t(()=>[a("div",ht,[s(p,{onClick:e[20]||(e[20]=n=>Y.value=!1)},{default:t(()=>[...e[81]||(e[81]=[r("取消",-1)])]),_:1}),s(p,{type:"primary",onClick:Oe,disabled:$.value.length===0},{default:t(()=>[r(" 确定选择 ("+V($.value.length)+") ",1)]),_:1},8,["disabled"])])]),default:t(()=>[_e((u(),y("div",gt,[!L.value&&S.value.length===0?(u(),y("div",_t,[s(o,{style:{"font-size":"48px","margin-bottom":"16px",opacity:"0.5"}},{default:t(()=>[s(i(ze))]),_:1}),e[77]||(e[77]=a("p",null,"暂无可用的保存路径",-1)),s(p,{type:"primary",onClick:K,style:{"margin-top":"16px"}},{default:t(()=>[...e[76]||(e[76]=[r(" 刷新路径列表 ",-1)])]),_:1})])):S.value.length>0?(u(),y("div",mt,[a("div",ft,[a("span",vt," 已选择 "+V(de().length)+" / "+V(S.value.length)+" 个路径 ",1),a("div",null,[s(p,{size:"small",onClick:De},{default:t(()=>[...e[78]||(e[78]=[r("全选",-1)])]),_:1}),s(p,{size:"small",onClick:Ke},{default:t(()=>[...e[79]||(e[79]=[r("清空",-1)])]),_:1}),s(p,{size:"small",onClick:K,loading:L.value},{default:t(()=>[...e[80]||(e[80]=[r("刷新",-1)])]),_:1},8,["loading"])])]),a("div",yt,[s(He,{ref_key:"pathTreeRef",ref:P,data:G.value,"show-checkbox":"","node-key":"path","default-expand-all":"","expand-on-click-node":!1,"check-on-click-node":"","check-strictly":!0,props:{class:"path-tree-node"},onCheck:Ge},null,8,["data"])])])):N("",!0)])),[[ce,L.value]])]),_:1},8,["modelValue"])])])],64)}}}),Vt=rs(bt,[["__scopeId","data-v-2a321489"]]);export{Vt as default};
