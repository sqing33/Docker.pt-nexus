import{d as kt,r as p,C as Oe,c as T,o as St,D as bt,a as v,m as C,k as x,u as ve,v as Ct,w as a,e as n,f as k,G as M,i,F as U,l as B,t as f,j as r,H as It,z as _,q as Nt,h as d,n as me,B as zt,p as $t}from"./index-DKGo2H6i.js";import{u as Et,C as Tt}from"./CrossSeedPanel-bK3Sfm3w.js";const Ut={class:"torrents-view"},Vt={class:"expand-content"},Dt=["onClick"],jt=["href"],Ot=["onClick"],Pt={class:"name-header-container"},Ft={key:0,class:"current-filters",style:{"margin-right":"15px",display:"flex","align-items":"center"}},Lt={style:{"white-space":"normal"}},Mt={style:{display:"inline-block",width:"100%","text-align":"center"}},Bt=["title"],Rt={style:{display:"flex","justify-content":"center","align-items":"center",width:"100%",height:"100%"}},qt={key:0},Kt={style:{padding:"1px 0",width:"100%"}},Jt={style:{"text-align":"center","font-size":"12px","margin-top":"5px","line-height":"1"}},Yt={style:{display:"flex","justify-content":"center","align-items":"center",width:"100%",height:"100%"}},At={style:{display:"flex","justify-content":"center","align-items":"center",width:"100%",height:"100%"}},Wt={key:0},Xt={key:1},Qt={style:{display:"flex","justify-content":"center","align-items":"center",width:"100%",height:"100%"}},Gt={key:3,class:"modal-overlay"},Ht={class:"modal-header"},Zt={key:0,class:"cross-seed-content"},es={class:"filter-card-header"},ts={class:"filter-card-body"},ss={class:"site-filter-container"},ls={style:{display:"flex","align-items":"center",gap:"15px","margin-bottom":"5px"}},as={style:{display:"flex","align-items":"center",gap:"10px"}},ns={key:0,style:{display:"flex","align-items":"center"}},os={key:1,style:{display:"flex","align-items":"center"}},is={class:"site-checkbox-container"},rs={style:{"margin-bottom":"10px"}},ds={key:0,style:{display:"flex","align-items":"center"}},us={style:{"margin-bottom":"10px"}},cs={key:0,style:{display:"flex","align-items":"center"}},ps={class:"path-tree-container"},fs={style:{"margin-bottom":"10px"}},vs={key:0,style:{display:"flex","align-items":"center"}},ms={class:"filter-card-footer"},gs={class:"filter-card-header"},ys={class:"site-operation-body"},hs={class:"torrent-name-container"},_s={class:"torrent-name"},ws={key:0,class:"site-operation-link"},xs={key:1,class:"site-operation-input"},ks={class:"site-operation-buttons"},Ss={key:6,class:"filter-overlay"},bs={class:"filter-card-header"},Cs={class:"source-site-selection-body"},Is={class:"source-site-tip"},Ns={key:0,class:"cached-sites-section"},zs={class:"cached-sites-label"},$s={class:"site-list-box glass-site-box cached-sites-box"},Es={key:1,class:"uncached-sites-section"},Ts={class:"site-list-box glass-site-box"},Us={class:"filter-card-footer"},Vs=kt({__name:"TorrentsView",emits:["ready"],setup(Ds,{emit:Pe}){const Fe=Pe,ge=p(null),ee=p(!0),te=p([]),R=p(null),ye=p(!1),j=p(""),O=p({prop:"name",order:"ascending"}),y=Oe({paths:[],states:[],existSiteNames:[],notExistSiteNames:[],downloaderIds:[]}),c=Oe({...y}),z=p("exist"),he=T({get:()=>z.value==="exist"?c.existSiteNames:c.notExistSiteNames,set:t=>{z.value==="exist"?c.existSiteNames=t:c.notExistSiteNames=t}}),q=p(!1),$=p(1),V=p(50),se=p(0),Le=p([]),_e=p([]),we=p([]),le=p({}),xe=p([]),ke=p([]),ae=p([]),S=p(null),Se=p([]),X=p(!1),K=p([]),ne=p(!1),D=p([]),be=p(!1),I=Et(),Me=T(()=>!!I.taskId),N=T(()=>I.workingParams);T(()=>I.sourceInfo?.name||"");const P=p(!1),J=p(""),w=p(null),E=p(""),H=p({}),oe=T(()=>{const t=new Intl.Collator("zh-CN",{numeric:!0});return[...we.value].sort(t.compare)}),Y=p(""),Ce=T(()=>{if(!Y.value)return oe.value;const t=Y.value.toLowerCase();return oe.value.filter(e=>e.toLowerCase().includes(t))}),Be=T(()=>{const t=y,e=[];return t.paths&&t.paths.length>0&&e.push(`路径: ${t.paths.length}`),t.states&&t.states.length>0&&e.push(`状态: ${t.states.length}`),t.existSiteNames&&t.existSiteNames.length>0&&e.push(`存在于: ${t.existSiteNames.length}`),t.notExistSiteNames&&t.notExistSiteNames.length>0&&e.push(`不存在于: ${t.notExistSiteNames.length}`),t.downloaderIds&&t.downloaderIds.length>0&&e.push(`下载器: ${t.downloaderIds.length}`),e.join(", ")}),Re=T(()=>{const t=y;return t.paths&&t.paths.length>0||t.states&&t.states.length>0||t.existSiteNames&&t.existSiteNames.length>0||t.notExistSiteNames&&t.notExistSiteNames.length>0||t.downloaderIds&&t.downloaderIds.length>0});T(()=>{const t=Ce.value;return z.value==="exist"?t.filter(e=>!c.notExistSiteNames.includes(e)):t.filter(e=>!c.existSiteNames.includes(e))});const Ie=t=>z.value==="exist"?!c.notExistSiteNames.includes(t):!c.existSiteNames.includes(t),qe=[{color:"#f56c6c",percentage:80},{color:"#e6a23c",percentage:99},{color:"#67c23a",percentage:100}],Q=async()=>{try{const t={page_size:V.value,sort_prop:O.value.prop,sort_order:O.value.order,name_search:j.value,active_filters:y};await fetch("/api/ui_settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}catch(t){console.error("无法保存UI设置:",t.message)}},Ke=async()=>{try{const t=await fetch("/api/ui_settings");if(!t.ok){console.warn("无法加载UI设置，将使用默认值。");return}const e=await t.json();if(V.value=e.page_size??50,O.value={prop:e.sort_prop||"name",order:"sort_order"in e?e.sort_order:"ascending"},j.value=e.name_search??"",e.active_filters){Object.assign(y,e.active_filters),y.existSiteNames||(y.existSiteNames=[]),y.notExistSiteNames||(y.notExistSiteNames=[]);const l=y;l.siteExistence&&delete l.siteExistence,l.siteNames&&delete l.siteNames}}catch(t){console.error("加载UI设置时出错:",t)}finally{ye.value=!0}},Je=t=>{const e=[],l=new Map;return t.sort().forEach(o=>{const u=o.replace(/^\/|\/$/g,"").split("/");let h="",g=e;u.forEach((F,W)=>{if(h=W===0?`/${F}`:`${h}/${F}`,!l.has(h)){const L={path:W===u.length-1?o:h,label:F,children:[]};l.set(h,L),g.push(L)}g=l.get(h).children})}),l.forEach(o=>{o.children&&o.children.length===0&&delete o.children}),e},Ye=async()=>{try{const t=await fetch("/api/all_downloaders");if(!t.ok)throw new Error("无法获取下载器列表");const e=await t.json();ke.value=e.filter(l=>l.enabled),ae.value=e}catch(t){R.value=t.message}},Ae=async()=>{try{const t=await fetch("/api/sites/status");if(!t.ok)throw new Error("无法获取站点状态列表");const e=await t.json();K.value=e.filter(l=>l.is_source)}catch(t){R.value=t.message}},b=async()=>{ee.value=!0,R.value=null;try{const t=new URLSearchParams({page:$.value.toString(),pageSize:V.value.toString(),nameSearch:j.value,sortProp:O.value.prop||"name",sortOrder:O.value.order||"ascending",existSiteNames:JSON.stringify(y.existSiteNames),notExistSiteNames:JSON.stringify(y.notExistSiteNames),path_filters:JSON.stringify(y.paths||[]),state_filters:JSON.stringify(y.states),downloader_filters:JSON.stringify(y.downloaderIds)}),e=await fetch(`/api/data?${t.toString()}`);if(!e.ok)throw new Error(`网络错误: ${e.status}`);const l=await e.json();if(l.error)throw new Error(l.error);te.value=l.data,se.value=l.total,V.value!==l.pageSize&&(V.value=l.pageSize),Le.value=l.unique_paths,_e.value=l.unique_states,we.value=l.all_discovered_sites,le.value=l.site_link_rules,y.paths=l.active_path_filters,Se.value=Je(l.unique_paths)}catch(t){R.value=t.message}finally{ee.value=!1}},We=async t=>{I.reset();const e=Object.entries(t.sites).map(([l,o])=>({siteName:l,...o})).filter(l=>{if(!(l.migration===1||l.migration===3))return!1;const u=l.comment&&l.comment.includes("details.php?id="),h=l.comment&&/^\d+$/.test(l.comment.trim());return u||h});I.setParams(t),await Xe(t),e.length===0&&_.warning("该种子暂无可用的源站点，您可以使用 IYUU 查询来发现更多站点。"),X.value=!0},Xe=async t=>{be.value=!0,D.value=[];try{const l=await(await fetch(`/api/cached_sites?name=${encodeURIComponent(t.name)}&size=${t.size}`)).json();l.success?(D.value=l.cached_sites||[],console.log("缓存站点查询结果:",D.value)):console.warn("查询缓存站点失败:",l.error)}catch(e){console.error("查询缓存站点时出错:",e)}finally{be.value=!1}},Ne=async t=>{const e=N.value;if(!e||!t){_.error("发生内部错误：未找到选中的种子或站点信息。");return}const l=e.sites[t.siteName],o=t.siteName;if(!l){_.error(`未找到站点 [${o}] 的数据。`);return}if(!G(l,o)){_.info(`站点 [${o}] 缺少详情链接，正在触发 IYUU 查询...`),H.value[o]=!0,await Ue(),H.value[o]=!1;return}let u=null;const h=l?.comment?.match(/id=(\d+)/);if(h&&h[1])u=h[1];else if(l?.comment&&/^\d+$/.test(l.comment.trim()))u=l.comment.trim();else{_.error(`无法从源站点 ${o} 的详情页链接中提取种子ID。请尝试使用IYUU查询更新链接。`);return}l&&(l.torrentId=u);const g=K.value.find(W=>W.name===o)?.site||o.toLowerCase();_.success(`准备从站点 [${o}] 开始迁移种子...`);const F={name:o,site:g,torrentId:u};I.setSourceInfo(F),I.setTaskId(e.name+"_"+Date.now()),X.value=!1},A=t=>{if(!!!(N.value&&N.value.sites[t]))return!1;const l=K.value.find(o=>o.name===t);return!!(l&&l.has_cookie)},ze=()=>{I.reset()},$e=(t,e)=>{J.value=t,w.value=e,E.value="",P.value=!0},Ee=async()=>{if(!J.value||!w.value){_.error("缺少必要的参数");return}if(!E.value||E.value.trim()===""){_.error("请输入详情页链接或ID");return}try{const t=await fetch("/api/sites/update_comment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({torrent_name:J.value,site_name:w.value.name,comment:E.value.trim()})}),e=await t.json();t.ok&&e.success?(_.success("详情页链接已成功添加"),P.value=!1,E.value="",await b()):_.error(e.error||"添加详情页链接失败")}catch(t){console.error("添加详情页链接时出错:",t),_.error("添加详情页链接时发生网络错误")}},Qe=async()=>{if(!J.value||!w.value){_.error("缺少必要的参数");return}try{const t=await fetch("/api/sites/set_not_exist",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({torrent_name:J.value,site_name:w.value.name})});if(t.ok)_.success("站点状态已成功设置为不存在"),P.value=!1,b();else{const e=await t.json();_.error(e.error||"设置站点状态失败")}}catch(t){console.error("设置站点状态时出错:",t),_.error("设置站点状态时发生错误")}},Ge=()=>{_.success("转种操作已完成！"),I.reset(),b()},He=()=>{_.success("转种操作已完成！"),I.reset(),b()},Te=t=>{if(!N.value)return null;const e=N.value.sites[t];return e?{siteName:t,...e}:null},Ue=async()=>{const t=N.value;if(!t){_.error("未找到选中的种子信息");return}ne.value=!0;try{const e=await fetch("/api/iyuu_query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t.name,size:t.size})}),l=await e.json();if(e.ok&&l.success){_.success(l.message||"IYUU查询已完成"),await b();const o=te.value.find(u=>u.name===t.name&&u.size===t.size);o&&I.setParams(o)}else _.error(l.error||"IYUU查询失败")}catch(e){console.error("触发IYUU查询时出错:",e),_.error("触发IYUU查询时发生网络错误")}finally{ne.value=!1}},Ze=t=>{V.value=t,$.value=1,b(),Q()},et=t=>{$.value=t,b()},tt=t=>{O.value=t,$.value=1,b(),Q()},st=()=>{Object.assign(c,y),q.value=!0,Nt(()=>{S.value&&S.value.setCheckedKeys(y.paths,!1)})},lt=async()=>{if(S.value){const t=S.value.getCheckedKeys(!1);c.paths=t}Object.assign(y,c),q.value=!1,$.value=1,await b(),Q()},at=()=>{c.paths=[],c.states=[],c.existSiteNames=[],c.notExistSiteNames=[],c.downloaderIds=[],z.value="exist",Y.value="",S.value&&S.value.setCheckedKeys([],!1)},nt=()=>{if(c.existSiteNames=[],z.value==="exist"&&S.value){const t=S.value.getCheckedKeys(!0);c.paths=t}},ot=()=>{if(c.notExistSiteNames=[],z.value==="not-exist"&&S.value){const t=S.value.getCheckedKeys(!0);c.paths=t}},it=()=>{c.paths=[],S.value&&S.value.setCheckedKeys([],!1)},rt=()=>{c.states=[]},dt=()=>{c.downloaderIds=[]},ut=async()=>{y.paths=[],y.states=[],y.existSiteNames=[],y.notExistSiteNames=[],y.downloaderIds=[],j.value="",z.value="exist",Y.value="",S.value&&S.value.setCheckedKeys([],!1),$.value=1,await b(),Q()},ie=t=>{if(t==null||t<=0)return"0 B";const e=["B","KB","MB","GB","TB","PB"],l=Math.floor(Math.log(t)/Math.log(1024));return`${(t/Math.pow(1024,l)).toFixed(2)} ${e[l]}`},G=(t,e)=>{const{comment:l}=t;return!!(l&&(l.startsWith("http")||/^\d+$/.test(l)&&le.value[e]))},re=(t,e)=>{const{comment:l}=t;if(l.startsWith("http"))return l;const o=le.value[e];return o&&/^\d+$/.test(l)?`${(o.base_url.startsWith("http")?o.base_url:`https://${o.base_url}`).replace(/\/$/,"")}/details.php?id=${l}`:null},de=t=>t.state==="未做种"?"danger":t.state==="不存在"?"info":t.comment?"success":t.state==="做种中"?"primary":"info",ue=t=>{if(!t)return"未知下载器";const e=ae.value.find(l=>l.id===t);return e?e.name:"未知下载器"},ct=t=>{if(!t||!ae.value.find(u=>u.id===t))return"info";let l=0;for(let u=0;u<t.length;u++)l=t.charCodeAt(u)+((l<<5)-l);const o=["primary","success","warning","danger","info"];return o[Math.abs(l)%o.length]},pt=t=>[...t].sort((l,o)=>{const u=ue(l),h=ue(o);return u.localeCompare(h,"zh-CN")}),ft=(t,e=50)=>{if(!t||t.length<=e)return t;const l=Math.floor((e-3)/2);let o=t.substring(0,l),u=t.substring(t.length-l);const h=o.lastIndexOf("/"),g=u.indexOf("/");return h>0&&g>=0&&(o=o.substring(0,h),u=u.substring(g+1)),`${o}...${u}`},Ve=(t,e)=>{if(!!!(N.value&&N.value.sites[t.name]))return"info";const o=N.value.sites[t.name];return t.has_cookie&&o.comment?"success":t.has_cookie?"primary":"error"},vt=t=>t.includes("下载")?"primary":t.includes("做种")?"success":t.includes("暂停")?"warning":t.includes("错误")||t.includes("丢失")?"danger":"info",mt=t=>ge.value?.toggleRowExpansion(t),gt=(t,e)=>{xe.value=e.map(l=>l.unique_id)},yt=({row:t})=>xe.value.includes(t.unique_id)?"expanded-row":"";return St(async()=>{await Ke(),b(),Ye(),Ae(),Fe("ready",b)}),bt(j,()=>{$.value=1,b(),Q()}),(t,e)=>{const l=k("el-alert"),o=k("el-tag"),u=k("el-table-column"),h=k("el-input"),g=k("el-button"),F=k("el-progress"),W=k("el-table"),De=k("el-pagination"),L=k("el-card"),Z=k("el-divider"),je=k("el-radio-button"),ht=k("el-radio-group"),ce=k("el-checkbox"),pe=k("el-checkbox-group"),_t=k("el-tree"),wt=k("el-link"),fe=Ct("loading");return d(),v("div",Ut,[R.value?(d(),C(l,{key:0,title:R.value,type:"error","show-icon":"",closable:!1,center:"",style:{"margin-bottom":"15px"}},null,8,["title"])):x("",!0),ye.value?ve((d(),C(W,{key:1,data:te.value,border:"",height:"100%",ref_key:"tableRef",ref:ge,"row-key":"unique_id","row-class-name":yt,onRowClick:mt,onExpandChange:gt,onSortChange:tt,"default-sort":O.value,"empty-text":"无数据或当前筛选条件下无结果",class:"glass-table"},{default:a(()=>[n(u,{type:"expand",width:"1"},{default:a(s=>[i("div",Vt,[(d(!0),v(U,null,B(oe.value,m=>(d(),v(U,{key:m},[s.row.sites[m]?(d(),v(U,{key:0},[s.row.sites[m].state==="未做种"?(d(),v("div",{key:0,style:{cursor:"pointer",display:"inline-block",width:"100%","text-align":"center"},onClick:M(xt=>$e(s.row.name,{name:m,data:s.row.sites[m]}),["stop"])},[n(o,{effect:"dark",type:de(s.row.sites[m]),style:{"text-align":"center",width:"100%"}},{default:a(()=>[r(f(m)+" ",1),i("div",null,"("+f(ie(s.row.sites[m].uploaded))+")",1)]),_:2},1032,["type"])],8,Dt)):s.row.sites[m]&&G(s.row.sites[m],m)?(d(),v("a",{key:1,href:re(s.row.sites[m],m),target:"_blank",style:{"text-decoration":"none"}},[n(o,{effect:"dark",type:de(s.row.sites[m]),style:{"text-align":"center"}},{default:a(()=>[r(f(m)+" ",1),i("div",null,"("+f(ie(s.row.sites[m].uploaded))+")",1)]),_:2},1032,["type"])],8,jt)):(d(),v("div",{key:2,style:{cursor:"pointer",display:"inline-block",width:"100%","text-align":"center"},onClick:M(xt=>$e(s.row.name,{name:m,data:s.row.sites[m]}),["stop"])},[n(o,{effect:"dark",type:de(s.row.sites[m]),style:{"text-align":"center",width:"100%"}},{default:a(()=>[r(f(m)+" ",1),i("div",null,"("+f(ie(s.row.sites[m].uploaded))+")",1)]),_:2},1032,["type"])],8,Ot))],64)):(d(),C(o,{key:1,type:"info",effect:"plain"},{default:a(()=>[r(f(m),1)]),_:2},1024))],64))),128))])]),_:1}),n(u,{prop:"name","min-width":"450",sortable:"custom"},{header:a(()=>[i("div",Pt,[e[21]||(e[21]=i("div",null,"种子名称",-1)),n(h,{modelValue:j.value,"onUpdate:modelValue":e[0]||(e[0]=s=>j.value=s),placeholder:"搜索名称...",clearable:"",class:"search-input",onClick:e[1]||(e[1]=M(()=>{},["stop"]))},null,8,["modelValue"]),i("span",{onClick:e[2]||(e[2]=M(()=>{},["stop"])),style:{display:"flex","align-items":"center"}},[Re.value?(d(),v("div",Ft,[n(o,{type:"info",size:"default",effect:"plain"},{default:a(()=>[r(f(Be.value),1)]),_:1}),n(g,{type:"danger",link:"",style:{padding:"0","margin-left":"8px"},onClick:ut},{default:a(()=>[...e[19]||(e[19]=[r("清除",-1)])]),_:1})])):x("",!0),n(g,{type:"primary",onClick:st,plain:""},{default:a(()=>[...e[20]||(e[20]=[r("筛选",-1)])]),_:1})])])]),default:a(s=>[i("span",Lt,f(s.row.name),1)]),_:1}),n(u,{prop:"site_count",label:"做种数",sortable:"custom",width:"95",align:"center","header-align":"center"},{default:a(s=>[i("span",Mt,f(s.row.site_count)+" / "+f(s.row.total_site_count),1)]),_:1}),n(u,{prop:"save_path",label:"保存路径",width:"220","header-align":"center"},{default:a(s=>[i("div",{title:s.row.save_path,style:{width:"100%",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},f(ft(s.row.save_path,30)),9,Bt)]),_:1}),n(u,{label:"下载器",width:"120",align:"center","header-align":"center"},{default:a(s=>[i("div",Rt,[s.row.downloaderIds&&s.row.downloaderIds.length>0?(d(),v("div",qt,[(d(!0),v(U,null,B(pt(s.row.downloaderIds),m=>(d(),C(o,{key:m,size:"small",type:ct(m),style:{margin:"2px"}},{default:a(()=>[r(f(ue(m)),1)]),_:2},1032,["type"]))),128))])):(d(),C(o,{key:1,type:"info",size:"small"},{default:a(()=>[...e[22]||(e[22]=[r(" 未知下载器 ",-1)])]),_:1}))])]),_:1}),n(u,{label:"大小",prop:"size_formatted",width:"100",align:"center",sortable:"custom"}),n(u,{label:"总上传量",prop:"total_uploaded_formatted",width:"110",align:"center",sortable:"custom"}),n(u,{label:"进度",prop:"progress",width:"120",align:"center",sortable:"custom"},{default:a(s=>[i("div",Kt,[n(F,{percentage:s.row.progress,"stroke-width":10,color:qe,"show-text":!1,style:{width:"100%"}},null,8,["percentage"]),i("div",Jt,f(s.row.progress)+"% ",1)])]),_:1}),n(u,{label:"状态",prop:"state",width:"120",align:"center","header-align":"center"},{default:a(s=>[i("div",Yt,[n(o,{type:vt(s.row.state),size:"large"},{default:a(()=>[r(f(s.row.state),1)]),_:2},1032,["type"])])]),_:1}),n(u,{label:"可转种",width:"100",align:"center","header-align":"center",prop:"target_sites_count",sortable:"custom"},{default:a(s=>[i("div",At,[s.row.target_sites_count!==void 0?(d(),v("span",Wt,f(s.row.target_sites_count),1)):(d(),v("span",Xt,"-"))])]),_:1}),n(u,{label:"操作",width:"100",align:"center","header-align":"center"},{default:a(s=>[i("div",Qt,[n(g,{type:"primary",size:"small",onClick:M(m=>We(s.row),["stop"])},{default:a(()=>[...e[23]||(e[23]=[r(" 转种 ",-1)])]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data","default-sort"])),[[fe,ee.value]]):x("",!0),se.value>0?(d(),C(De,{key:2,class:"glass-pagination",style:{"justify-content":"flex-end"},"current-page":$.value,"onUpdate:currentPage":e[3]||(e[3]=s=>$.value=s),"page-size":V.value,"onUpdate:pageSize":e[4]||(e[4]=s=>V.value=s),"page-sizes":[20,50,100],total:se.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Ze,onCurrentChange:et,background:""},null,8,["current-page","page-size","total"])):x("",!0),Me.value?(d(),v("div",Gt,[n(L,{class:"cross-seed-card",shadow:"always"},{header:a(()=>[i("div",Ht,[i("span",null,"转种 - "+f(N.value?.name),1),n(g,{type:"danger",circle:"",onClick:ze,plain:""},{default:a(()=>[...e[24]||(e[24]=[r("X",-1)])]),_:1})])]),default:a(()=>[N.value?(d(),v("div",Zt,[n(Tt,{onComplete:Ge,onCancel:ze,onCloseWithRefresh:He})])):x("",!0)]),_:1})])):x("",!0),q.value?(d(),v("div",{key:4,class:"filter-overlay",onClick:e[12]||(e[12]=M(s=>q.value=!1,["self"]))},[n(L,{class:"filter-card"},{header:a(()=>[i("div",es,[e[26]||(e[26]=i("span",null,"筛选选项",-1)),n(g,{type:"danger",circle:"",onClick:e[5]||(e[5]=s=>q.value=!1),plain:""},{default:a(()=>[...e[25]||(e[25]=[r("X",-1)])]),_:1})])]),default:a(()=>[i("div",ts,[n(Z,{"content-position":"left"},{default:a(()=>[...e[27]||(e[27]=[r("站点筛选",-1)])]),_:1}),i("div",ss,[i("div",ls,[n(ht,{modelValue:z.value,"onUpdate:modelValue":e[6]||(e[6]=s=>z.value=s),size:"default"},{default:a(()=>[n(je,{label:"exist",class:"compact-radio-button"},{default:a(()=>[...e[28]||(e[28]=[r("存在于",-1)])]),_:1}),n(je,{label:"not-exist",class:"compact-radio-button"},{default:a(()=>[...e[29]||(e[29]=[r("不存在于",-1)])]),_:1})]),_:1},8,["modelValue"]),n(h,{modelValue:Y.value,"onUpdate:modelValue":e[7]||(e[7]=s=>Y.value=s),placeholder:"搜索站点",clearable:"",style:{width:"280px","font-size":"14px"},size:"default"},null,8,["modelValue"]),i("div",as,[c.existSiteNames.length>0?(d(),v("div",ns,[n(o,{type:"info",size:"default",effect:"plain"},{default:a(()=>[r("存在于: "+f(c.existSiteNames.length),1)]),_:1}),n(g,{type:"danger",link:"",style:{padding:"0","margin-left":"5px"},onClick:nt},{default:a(()=>[...e[30]||(e[30]=[r("清除",-1)])]),_:1})])):x("",!0),c.notExistSiteNames.length>0?(d(),v("div",os,[n(o,{type:"info",size:"default",effect:"plain"},{default:a(()=>[r("不存在于: "+f(c.notExistSiteNames.length),1)]),_:1}),n(g,{type:"danger",link:"",style:{padding:"0","margin-left":"5px"},onClick:ot},{default:a(()=>[...e[31]||(e[31]=[r("清除",-1)])]),_:1})])):x("",!0)])]),i("div",is,[n(pe,{modelValue:he.value,"onUpdate:modelValue":e[8]||(e[8]=s=>he.value=s)},{default:a(()=>[(d(!0),v(U,null,B(Ce.value,s=>(d(),C(ce,{key:s,label:s,disabled:!Ie(s),class:me({"disabled-site":!Ie(s)})},{default:a(()=>[r(f(s),1)]),_:2},1032,["label","disabled","class"]))),128))]),_:1},8,["modelValue"])])]),n(Z,{"content-position":"left"},{default:a(()=>[...e[32]||(e[32]=[r("下载器",-1)])]),_:1}),i("div",rs,[c.downloaderIds.length>0?(d(),v("div",ds,[n(o,{type:"info",size:"default",effect:"plain"},{default:a(()=>[r("下载器: "+f(c.downloaderIds.length),1)]),_:1}),n(g,{type:"danger",link:"",style:{padding:"0","margin-left":"5px"},onClick:dt},{default:a(()=>[...e[33]||(e[33]=[r("清除",-1)])]),_:1})])):x("",!0)]),n(pe,{modelValue:c.downloaderIds,"onUpdate:modelValue":e[9]||(e[9]=s=>c.downloaderIds=s)},{default:a(()=>[(d(!0),v(U,null,B(ke.value,s=>(d(),C(ce,{key:s.id,label:s.id},{default:a(()=>[r(f(s.name),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"]),n(Z,{"content-position":"left"},{default:a(()=>[...e[34]||(e[34]=[r("保存路径",-1)])]),_:1}),i("div",us,[c.paths.length>0?(d(),v("div",cs,[n(o,{type:"info",size:"default",effect:"plain"},{default:a(()=>[r("路径: "+f(c.paths.length),1)]),_:1}),n(g,{type:"danger",link:"",style:{padding:"0","margin-left":"5px"},onClick:it},{default:a(()=>[...e[35]||(e[35]=[r("清除",-1)])]),_:1})])):x("",!0)]),i("div",ps,[n(_t,{ref_key:"pathTreeRef",ref:S,data:Se.value,"show-checkbox":"","node-key":"path","default-expand-all":"","expand-on-click-node":!1,"check-on-click-node":"","check-strictly":!0,props:{class:"path-tree-node"}},null,8,["data"])]),n(Z,{"content-position":"left"},{default:a(()=>[...e[36]||(e[36]=[r("状态",-1)])]),_:1}),i("div",fs,[c.states.length>0?(d(),v("div",vs,[n(o,{type:"info",size:"default",effect:"plain"},{default:a(()=>[r("状态: "+f(c.states.length),1)]),_:1}),n(g,{type:"danger",link:"",style:{padding:"0","margin-left":"5px"},onClick:rt},{default:a(()=>[...e[37]||(e[37]=[r("清除",-1)])]),_:1})])):x("",!0)]),n(pe,{modelValue:c.states,"onUpdate:modelValue":e[10]||(e[10]=s=>c.states=s)},{default:a(()=>[(d(!0),v(U,null,B(_e.value,s=>(d(),C(ce,{key:s,label:s},{default:a(()=>[r(f(s),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),i("div",ms,[n(g,{onClick:at},{default:a(()=>[...e[38]||(e[38]=[r("清除筛选",-1)])]),_:1}),n(g,{onClick:e[11]||(e[11]=s=>q.value=!1)},{default:a(()=>[...e[39]||(e[39]=[r("取消",-1)])]),_:1}),n(g,{type:"primary",onClick:lt},{default:a(()=>[...e[40]||(e[40]=[r("确认",-1)])]),_:1})])]),_:1})])):x("",!0),P.value?(d(),v("div",{key:5,class:"filter-overlay",onClick:e[16]||(e[16]=M(s=>P.value=!1,["self"]))},[n(L,{class:"filter-card",style:{"max-width":"500px"}},{header:a(()=>[i("div",gs,[e[42]||(e[42]=i("span",null,"站点操作",-1)),n(g,{type:"danger",circle:"",onClick:e[13]||(e[13]=s=>P.value=!1),plain:""},{default:a(()=>[...e[41]||(e[41]=[r("X",-1)])]),_:1})])]),default:a(()=>[i("div",ys,[i("div",hs,[e[43]||(e[43]=i("p",{class:"label"},"种子名称:",-1)),i("p",_s,f(J.value),1)]),i("p",null,"站点名称: "+f(w.value?.name),1),i("p",null,"当前状态: "+f(w.value?.data.state),1),w.value&&w.value.data&&G(w.value.data,w.value.name)?(d(),v("div",ws,[e[44]||(e[44]=i("p",{class:"label"},"详情页链接:",-1)),n(wt,{href:re(w.value.data,w.value.name),target:"_blank",type:"primary",underline:!1},{default:a(()=>[r(f(re(w.value.data,w.value.name)),1)]),_:1},8,["href"])])):(d(),v("div",xs,[e[45]||(e[45]=i("p",{class:"label"},"添加详情页链接或种子ID:",-1)),n(h,{modelValue:E.value,"onUpdate:modelValue":e[14]||(e[14]=s=>E.value=s),placeholder:"请输入完整的详情页链接或种子ID",clearable:"",onKeyup:It(Ee,["enter"])},null,8,["modelValue"]),e[46]||(e[46]=i("p",{class:"input-hint"}," 支持输入完整链接（如：https://example.com/details.php?id=123）或仅输入数字ID（如：123456） ",-1))])),i("div",ks,[n(g,{onClick:e[15]||(e[15]=s=>P.value=!1)},{default:a(()=>[...e[47]||(e[47]=[r("取消",-1)])]),_:1}),G(w.value?.data,w.value?.name)?x("",!0):(d(),C(g,{key:0,type:"success",onClick:Ee,disabled:!E.value||E.value.trim()===""},{default:a(()=>[...e[48]||(e[48]=[r(" 添加链接 ",-1)])]),_:1},8,["disabled"])),G(w.value?.data,w.value?.name)?(d(),C(g,{key:1,type:"primary",onClick:Qe},{default:a(()=>[...e[49]||(e[49]=[r(" 设为不存在 ",-1)])]),_:1})):x("",!0)])])]),_:1})])):x("",!0),X.value?(d(),v("div",Ss,[n(L,{class:"filter-card",style:{"max-width":"600px"}},{header:a(()=>[i("div",bs,[e[51]||(e[51]=i("span",null,"请选择转种的源站点",-1)),n(g,{type:"danger",circle:"",onClick:e[17]||(e[17]=s=>X.value=!1),plain:""},{default:a(()=>[...e[50]||(e[50]=[r("X",-1)])]),_:1})])]),default:a(()=>[i("div",Cs,[i("p",Is,[n(o,{type:"success",size:"large",style:{"margin-right":"5px"}},{default:a(()=>[...e[52]||(e[52]=[r("可获取数据",-1)])]),_:1}),n(o,{type:"primary",size:"large",style:{"margin-right":"5px"}},{default:a(()=>[...e[53]||(e[53]=[r("可尝试iyuu获取链接",-1)])]),_:1}),n(o,{type:"error",size:"large",style:{"margin-right":"5px",opacity:"0.5"}},{default:a(()=>[...e[54]||(e[54]=[r("未配置Cookie",-1)])]),_:1})]),D.value.length>0?(d(),v("div",Ns,[i("p",zs,"已缓存的站点 ("+f(D.value.length)+")",1),i("div",$s,[(d(!0),v(U,null,B(K.value.filter(s=>D.value.includes(s.name)),s=>ve((d(),C(o,{key:s.name,type:Ve(s,A(s.name)),class:me([{"is-selectable":A(s.name),"cached-site-tag":!0},"site-tag"]),onClick:m=>A(s.name)&&Ne(Te(s.name)),"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.5)"},{default:a(()=>[r(f(s.name)+" ✓ ",1)]),_:2},1032,["type","class","onClick"])),[[fe,H.value[s.name]]])),128))])])):x("",!0),K.value.some(s=>!D.value.includes(s.name))?(d(),v("div",Es,[e[55]||(e[55]=i("p",{class:"uncached-sites-label"},"未缓存的站点",-1)),i("div",Ts,[(d(!0),v(U,null,B(K.value.filter(s=>!D.value.includes(s.name)),s=>ve((d(),C(o,{key:s.name,type:Ve(s,A(s.name)),class:me([{"is-selectable":A(s.name)},"site-tag"]),style:zt(s.has_cookie?"":"opacity: 0.5"),size:"large",onClick:m=>A(s.name)&&Ne(Te(s.name)),"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.5)"},{default:a(()=>[r(f(s.name),1)]),_:2},1032,["type","class","style","onClick"])),[[fe,H.value[s.name]]])),128))])])):x("",!0)]),i("div",Us,[n(g,{type:"warning",onClick:Ue,loading:ne.value,plain:""},{default:a(()=>[...e[56]||(e[56]=[r("IYUU查询",-1)])]),_:1},8,["loading"]),n(g,{onClick:e[18]||(e[18]=s=>X.value=!1)},{default:a(()=>[...e[57]||(e[57]=[r("取消",-1)])]),_:1})])]),_:1})])):x("",!0)])}}}),Ps=$t(Vs,[["__scopeId","data-v-c21f79e2"]]);export{Ps as default};
