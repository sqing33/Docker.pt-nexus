import{K as Rs,d as Qe,r as S,c as x,D as Re,o as Xe,s as Ps,a as v,k as w,i as t,e as i,f as R,w as r,F as A,l as L,x as E,L as Ge,h as m,m as z,M as xs,N as Us,O as Bs,p as Ze,q as me,g as D,E as c,P as ie,j as V,n as T,t as h,y as Ce,Q as Os,R as De,B as js,S as qs,T as Je}from"./index-d7LsNQIT.js";const Fs=Rs("crossSeed",{state:()=>({taskId:null,sourceInfo:null}),actions:{setTaskId(ee){this.taskId=ee},clearTaskId(){this.taskId=null},setSourceInfo(ee){this.sourceInfo=ee},clearSourceInfo(){this.sourceInfo=null}}}),Hs={key:0,class:"log-progress-overlay"},Ks={class:"log-progress-container"},Ws={class:"steps-wrapper"},Ys={key:0,class:"spinner-icon"},Gs={key:1,class:"success-icon"},Js={key:2,class:"error-icon"},Qs={key:3,class:"warning-icon"},Xs={key:0,class:"completion-message"},Zs=Qe({__name:"LogProgress",props:{visible:{type:Boolean},taskId:{}},emits:["complete","close"],setup(ee,{emit:Ie}){const U=ee,re=Ie,G=S([{name:"数据库查询",message:"正在检查缓存...",status:"pending"},{name:"开始抓取",message:"准备从源站点获取...",status:"pending"},{name:"获取种子信息",message:"",status:"pending"},{name:"解析参数",message:"",status:"pending"},{name:"验证图片链接",message:"",status:"pending"},{name:"提取媒体信息",message:"",status:"pending"},{name:"验证简介格式",message:"",status:"pending"},{name:"检查声明感谢",message:"",status:"pending"},{name:"成功获取参数",message:"",status:"pending"}]),F=S(!1);let K=null;const y=x(()=>{const k=G.value.findIndex(M=>M.status==="processing");return k!==-1?k:G.value.filter(M=>M.status==="success").length}),P=k=>k.status==="success"?"success":k.status==="error"?"error":k.status==="warning"?"warning":k.status==="processing"?"process":"wait";Re(()=>U.taskId,k=>{k&&U.visible&&de()}),Re(()=>U.visible,k=>{k&&U.taskId?de():k||se()}),Xe(()=>{U.visible&&U.taskId&&de()}),Ps(()=>{se()});const de=()=>{K&&K.close(),F.value=!1,G.value.forEach(k=>{k.status="pending",k.message=k.name==="数据库查询"?"正在检查缓存...":k.name==="开始抓取"?"准备从源站点获取...":""}),K=new EventSource(`/api/migrate/logs/stream/${U.taskId}`),K.onmessage=k=>{try{const C=JSON.parse(k.data);C.type==="connected"?console.log("SSE 连接成功",C):C.type==="log"?$(C.step,C.message,C.status):C.type==="complete"?(F.value=!0,re("complete"),se(),re("close")):C.type}catch(C){console.error("解析 SSE 消息失败:",C)}},K.onerror=k=>{console.error("SSE 连接错误:",k),se()}},se=()=>{K&&(K.close(),K=null)},$=(k,C,M)=>{const j=G.value.findIndex(ae=>ae.name===k);if(j!==-1){const ae=G.value[j];if(ae.message=C,ae.status=M,M==="success"&&j<G.value.length-1){const q=G.value[j+1];q.status==="pending"&&(q.status="processing")}}};return(k,C)=>{const M=R("el-icon"),j=R("el-step"),ae=R("el-steps");return ee.visible?(m(),v("div",Hs,[t("div",Ks,[t("div",Ws,[i(ae,{direction:"vertical",active:y.value,"finish-status":"success"},{default:r(()=>[(m(!0),v(A,null,L(G.value,(q,pe)=>(m(),z(j,{key:pe,title:q.name,description:q.message,status:P(q)},{icon:r(()=>[q.status==="processing"?(m(),v("div",Ys,[i(M,{class:"is-loading"},{default:r(()=>[i(E(xs))]),_:1})])):q.status==="success"?(m(),v("div",Gs,[i(M,null,{default:r(()=>[i(E(Ge))]),_:1})])):q.status==="error"?(m(),v("div",Js,[i(M,null,{default:r(()=>[i(E(Us))]),_:1})])):q.status==="warning"?(m(),v("div",Qs,[i(M,null,{default:r(()=>[i(E(Bs))]),_:1})])):w("",!0)]),_:2},1032,["title","description","status"]))),128))]),_:1},8,["active"]),F.value?(m(),v("div",Xs,[i(M,{class:"icon-complete",color:"#67C23A"},{default:r(()=>[i(E(Ge))]),_:1}),C[0]||(C[0]=t("span",null,"所有步骤已完成",-1))])):w("",!0)])])])):w("",!0)}}}),ea=Ze(Zs,[["__scopeId","data-v-b874a855"]]),sa={class:"cross-seed-panel"},aa={class:"panel-header"},ta={class:"custom-steps"},la={class:"step-icon"},oa={key:1},na={class:"step-title"},ia={key:0,class:"step-connector"},ra={class:"panel-content"},da={key:0,class:"step-container details-container"},ua={class:"main-info-container"},ca={class:"full-width-form-column"},ma={class:"title-section"},pa={class:"title-components-grid"},va={class:"bottom-info-section"},_a={class:"subtitle-unrecognized-grid"},fa={class:"subtitle-section",style:{"grid-column":"span 4"}},ga={class:"standard-params-section"},ba={class:"standard-params-grid"},ha={class:"standard-params-grid second-row"},ya={class:"poster-statement-container"},wa={class:"poster-statement-split"},ka={class:"left-panel"},Sa={class:"form-label-with-button"},Ca={class:"right-panel"},Ia={class:"poster-preview-section"},$a={class:"image-preview-container"},za=["src","onError"],Va={key:1,class:"preview-placeholder"},Ta={class:"screenshot-container"},Na={class:"form-column screenshot-text-column"},Aa={class:"form-label-with-button"},Ea={class:"preview-column screenshot-preview-column"},Ma={class:"carousel-container"},La={class:"carousel-image-wrapper"},Da=["src","onError"],Ra={key:1,class:"preview-placeholder"},Pa={class:"form-label-with-button"},xa={class:"form-label-with-button"},Ua={class:"filtered-declarations-container"},Ba={class:"filtered-declarations-header"},Oa={class:"filtered-declarations-content"},ja={class:"declaration-header"},qa={class:"declaration-number"},Fa={class:"declaration-content code-font"},Ha={key:1,class:"no-filtered-declarations"},Ka={key:1,class:"step-container publish-preview-container"},Wa={class:"publish-preview-content"},Ya={class:"preview-row main-title-row"},Ga={class:"row-content main-title-content"},Ja={class:"preview-row subtitle-row"},Qa={class:"row-content subtitle-content"},Xa={class:"preview-row params-row"},Za={class:"row-content"},et={class:"param-row"},st={class:"param-item imdb-item half-width"},at={style:{display:"flex"}},tt={style:{display:"flex"}},lt={class:"param-item tags-item half-width"},ot={class:"param-value-container"},nt={key:0,class:"param-standard-key"},it={class:"params-content"},rt={class:"param-item inline-param"},dt={class:"param-value-container"},ut={key:0,class:"param-standard-key"},ct={class:"param-item inline-param"},mt={class:"param-value-container"},pt={key:0,class:"param-standard-key"},vt={class:"param-item inline-param"},_t={class:"param-value-container"},ft={key:0,class:"param-standard-key"},gt={class:"param-item inline-param"},bt={class:"param-value-container"},ht={key:0,class:"param-standard-key"},yt={class:"param-item inline-param"},wt={class:"param-value-container"},kt={key:0,class:"param-standard-key"},St={class:"param-item inline-param"},Ct={class:"param-value-container"},It={key:0,class:"param-standard-key"},$t={class:"param-item inline-param"},zt={class:"param-value-container"},Vt={key:0,class:"param-standard-key"},Tt={class:"preview-row mediainfo-row"},Nt={class:"row-content mediainfo-content scrollable-content"},At={class:"mediainfo-pre"},Et={class:"preview-row description-row"},Mt={class:"row-content description-content"},Lt={class:"description-section"},Dt=["innerHTML"],Rt={key:0,class:"description-section"},Pt={class:"image-gallery"},xt=["src","alt","onError"],Ut={class:"description-section"},Bt=["innerHTML"],Ot={key:1,class:"description-section"},jt={class:"image-gallery"},qt=["src","alt","onError"],Ft={key:2,class:"step-container site-selection-container"},Ht={class:"select-all-container",style:{"margin-top":"16px"}},Kt={class:"site-buttons-group"},Wt={key:3,class:"step-container results-container"},Yt={key:0,class:"progress-section"},Gt={key:0,class:"progress-item"},Jt={class:"progress-text"},Qt={key:1,class:"progress-item"},Xt={class:"progress-text"},Zt={class:"results-rows-container"},el={class:"row-sites"},sl={class:"card-icon"},al={class:"card-title"},tl={key:0,class:"existed-tag"},ll={key:1,class:"downloader-status"},ol={class:"status-icon"},nl={class:"card-extra"},il=["href"],rl={class:"row-action"},dl={class:"button-subtitle"},ul={class:"panel-footer"},cl={key:0,class:"button-group"},ml={key:1,class:"button-group"},pl={key:2,class:"button-group"},vl={key:3,class:"button-group"},_l={class:"card-header"},fl={class:"log-content-pre"},gl=Qe({__name:"CrossSeedPanel",props:{showCompleteButton:{type:Boolean,default:!1}},emits:["complete","cancel","close-with-refresh"],setup(ee,{emit:Ie}){const U=s=>{if(!s)return"";s=s.replace(/[ \t\f\v]+$/gm,""),s=s.replace(/^\s*\n+/,"").replace(/\n\s*$/,""),s=s.replace(/(\n\s*){2,}/g,`

`),s=s.replace(/([^\n]+。)\s*\n\s*\n(\s*\d+\.)/g,`$1
$2`),s=s.replace(/(\d+\.[\s\S]*?)\n\s*\n(\s*\d+\.)/g,`$1
$2`),s=s.replace(/(\[(?:b|color)[^\]]*\][\s\S]*?)\n\s*\n([\s\S]*?\[\/(?:b|color)\])/gi,`$1
$2`);for(let e=0;e<3;e++)s=s.replace(/(\[(?:quote|b|color|size)[^\]]*\][\s\S]*?)\n\s*\n([\s\S]*?\[\/(?:quote|b|color|size)\])/gi,`$1
$2`);return s=s.replace(/(\n\s*){2,}/g,`

`),s},re=s=>s?(s=U(s),s=s.replace(/\[quote\]([\s\S]*?)\[\/quote\]/gi,"<blockquote>$1</blockquote>"),s=s.replace(/\[b\]([\s\S]*?)\[\/b\]/gi,"<strong>$1</strong>"),s=s.replace(/\[color=(\w+|\#[0-9a-fA-F]{3,6})\]([\s\S]*?)\[\/color\]/gi,'<span style="color: $1;">$2</span>'),s=s.replace(/\[size=(\d+)\]([\s\S]*?)\[\/size\]/gi,(e,d,u)=>`<span style="font-size: ${{1:"12",2:"14",3:"16",4:"18",5:"24",6:"32",7:"48"}[d]||parseInt(d)*4}px;">${u}</span>`),s=s.replace(/\n/g,"<br>"),s):"",G=ee,F=Ie,K=Fs(),y=x(()=>K.workingParams),P=x(()=>K.sourceInfo?.name||""),de=()=>({title_components:[],original_main_title:"",subtitle:"",imdb_link:"",douban_link:"",intro:{statement:"",poster:"",body:"",screenshots:"",removed_ardtudeclarations:[]},mediainfo:"",source_params:{},standardized_params:{type:"",medium:"",video_codec:"",audio_codec:"",resolution:"",team:"",source:"",tags:[]},final_publish_parameters:{},complete_publish_params:{},raw_params_for_preview:{}}),se=s=>{if(!s||typeof s!="string")return[];const e=/\[img\](https?:\/\/[^\s[\]]+)\[\/img\]/gi;return[...s.matchAll(e)].map(u=>u[1])},$=S(0),k=S("main"),C=S(!1),M=S({current:0,total:0}),j=S({current:0,total:0}),q=((s,e)=>{let d;return function(...l){const n=()=>{clearTimeout(d),s(...l)};clearTimeout(d),d=setTimeout(n,e)}})(()=>{const s=document.querySelector(".panel-content");if(s){const{scrollTop:e,scrollHeight:d,clientHeight:u}=s;C.value=e+u>=d-5}},100),pe=()=>{const s=document.querySelector(".panel-content");s&&s.addEventListener("scroll",q)},es=()=>{const s=document.querySelector(".panel-content");s&&s.removeEventListener("scroll",q)};Xe(()=>{is(),rs(),me(()=>{$.value===1&&(pe(),q())})}),Re($,(s,e)=>{e===1&&es(),s===1&&me(()=>{pe(),q()})});const $e=[{title:"核对种子详情"},{title:"发布参数预览"},{title:"选择发布站点"},{title:"完成发布"}],te=S([]),W=S([]),O=S(!1),a=S(de()),Y=S(null),oe=S([]),ze=S(!1),ve=S(!1),Ve=S(!1),_e=S(!1),fe=S(!1),Te=S(!1),J=S(!0),le=S(""),ge=S(!1),Pe=S([]),ue=S(!1),be=S(!1),xe=S(""),N=S({type:{},medium:{},video_codec:{},audio_codec:{},resolution:{},source:{},team:{},tags:{}}),he=x(()=>se(a.value.intro.poster)),ce=x(()=>se(a.value.intro.screenshots)),Ue=x(()=>{const s=a.value.intro.removed_ardtudeclarations;return Array.isArray(s)?s:[]}),Be=x(()=>Ue.value.length),Ne=s=>{const e=te.value.find(d=>d.name===s);if(!e||!e.has_cookie||y.value?.sites?.[s])return!1;if(s.toLowerCase()==="ubits"){const d=a.value.standardized_params.team,u=a.value.title_components;if(d&&["cmct","cmctv"].includes(d.toLowerCase()))return!1;const l=u.find(n=>n.key==="制作组");if(l&&l.value){const n=l.value.toLowerCase(),p=["cmct","cmctv","telesto","shadow610"];for(const b of p)if(n.includes(b))return!1}}return!0},ss=s=>W.value.includes(s.name)?"success":s.has_cookie?"default":"danger",as=async()=>{if(!a.value.douban_link&&!a.value.imdb_link){c.warning("没有豆瓣或IMDb链接，无法重新获取简介。");return}Ve.value=!0,c.info({title:"正在重新获取",message:"正在从豆瓣/IMDb重新获取简介...",duration:0});const s={type:"intro",source_info:{main_title:a.value.original_main_title,source_site:P.value,imdb_link:a.value.imdb_link,douban_link:a.value.douban_link}};try{const e=await D.post("/api/media/validate",s);c.closeAll(),e.data.success&&e.data.intro?(a.value.intro.body=U(e.data.intro),e.data.extracted_imdb_link&&!a.value.imdb_link&&(a.value.imdb_link=e.data.extracted_imdb_link),c.success({title:"重新获取成功",message:"已成功从豆瓣/IMDb获取并更新了简介内容。"})):c.error({title:"重新获取失败",message:e.data.error||"无法从豆瓣/IMDb获取简介。"})}catch(e){c.closeAll();const d=e.response?.data?.error||"重新获取简介时发生网络错误";c.error({title:"操作失败",message:d})}finally{Ve.value=!1}},ts=async()=>{if(!a.value.original_main_title){c.warning("标题为空，无法重新获取截图。");return}if(ve.value){c.info({title:"正在处理中",message:"截图重新生成请求已在处理中，请稍候..."});return}ve.value=!0,c.info({title:"正在重新获取",message:"正在从视频重新生成截图...",duration:0});const s={type:"screenshot",source_info:{main_title:a.value.original_main_title,source_site:P.value,imdb_link:a.value.imdb_link,douban_link:a.value.douban_link},savePath:y.value.save_path,torrentName:y.value.name,downloaderId:y.value.downloaderId};try{const e=await D.post("/api/media/validate",s);c.closeAll(),e.data.success&&e.data.screenshots?(a.value.intro.screenshots=e.data.screenshots,J.value=!0,c.success({title:"重新获取成功",message:"已成功生成并加载了新的截图。"})):(J.value=!1,c.error({title:"重新获取失败",message:e.data.error||"无法从后端获取新的截图。"}))}catch(e){c.closeAll();const d=e.response?.data?.error||"重新获取截图时发生网络错误";c.error({title:"操作失败",message:d}),J.value=!1}finally{ve.value=!1}},ls=async()=>{if(_e.value){c.info({title:"正在处理中",message:"媒体信息重新获取请求已在处理中，请稍候..."});return}_e.value=!0,c.info({title:"正在重新获取",message:"正在从视频重新生成媒体信息...",duration:0});const s={type:"mediainfo",source_info:{main_title:a.value.original_main_title,source_site:P.value,imdb_link:a.value.imdb_link,douban_link:a.value.douban_link},current_mediainfo:a.value.mediainfo,savePath:y.value.save_path,torrentName:y.value.name,downloaderId:y.value.downloaderId};try{const e=await D.post("/api/media/validate",s);c.closeAll(),e.data.success&&e.data.mediainfo?(a.value.mediainfo=e.data.mediainfo,c.success({title:"重新获取成功",message:"已成功生成并加载了新的媒体信息。"})):c.error({title:"重新获取失败",message:e.data.error||"无法从后端获取新的媒体信息。"})}catch(e){c.closeAll();const d=e.response?.data?.error||"重新获取媒体信息时发生网络错误";c.error({title:"操作失败",message:d})}finally{_e.value=!1}},os=async()=>{if(!a.value.original_main_title){c.warning("标题为空，无法重新获取海报。");return}if(fe.value){c.info({title:"正在处理中",message:"海报重新获取请求已在处理中，请稍候..."});return}fe.value=!0,c.info({title:"正在重新获取",message:"正在重新生成海报...",duration:0});const s={type:"poster",source_info:{main_title:a.value.original_main_title,source_site:P.value,imdb_link:a.value.imdb_link,douban_link:a.value.douban_link},savePath:y.value.save_path,torrentName:y.value.name,downloaderId:y.value.downloaderId};try{const e=await D.post("/api/media/validate",s);c.closeAll(),e.data.success&&e.data.posters?(a.value.intro.poster=e.data.posters,c.success({title:"重新获取成功",message:"已成功生成并加载了新的海报。"})):c.error({title:"重新获取失败",message:e.data.error||"无法从后端获取新的海报。"})}catch(e){c.closeAll();const d=e.response?.data?.error||"重新获取海报时发生网络错误";c.error({title:"操作失败",message:d})}finally{fe.value=!1}},ns=async()=>{if(!a.value.original_main_title){c.warning("标题为空，无法解析。");return}ze.value=!0;try{const s=await D.post("/api/utils/parse_title",{title:a.value.original_main_title});s.data.success?(a.value.title_components=s.data.components,c.success("标题已重新解析！")):c.error(s.data.message||"解析失败")}catch(s){we(s,"重新解析标题时发生网络错误")}finally{ze.value=!1}},ye=async(s,e,d)=>{if(s&&s.includes("pixhost.to")){console.log(`检测到 pixhost.to 图片，跳过有效性检测: ${s}`);return}if(e==="screenshot"&&Te.value){console.log(`截图错误已正在处理中，跳过重复请求: ${s}`);return}console.error(`图片加载失败: 类型=${e}, URL=${s}, 索引=${d}`),e==="screenshot"?(Te.value=!0,J.value=!1,c.warning({title:"截图失效",message:"检测到截图链接失效，正在尝试从视频重新生成..."})):e==="poster"&&c.warning({title:"海报失效",message:"检测到海报链接失效，正在尝试重新获取..."});const u={type:e,source_info:{main_title:a.value.original_main_title,source_site:P.value,imdb_link:a.value.imdb_link,douban_link:a.value.douban_link},savePath:y.value.save_path,torrentName:y.value.name,downloaderId:y.value.downloaderId};try{const l=await D.post("/api/media/validate",u);l.data.success?e==="screenshot"&&l.data.screenshots?(a.value.intro.screenshots=l.data.screenshots,J.value=!0,c.success({title:"截图已更新",message:"已成功生成并加载了新的截图。"})):e==="poster"&&l.data.posters&&(a.value.intro.poster=l.data.posters,c.success({title:"海报已更新",message:"已成功生成并加载了新的海报。"})):(e==="screenshot"&&(J.value=!1),c.error({title:"更新失败",message:l.data.error||`无法从后端获取新的${e==="poster"?"海报":"截图"}。`}))}catch(l){const n=l.response?.data?.error||`发送失效${e==="poster"?"海报":"截图"}信息请求时发生网络错误`;console.error("发送失效图片信息请求时发生网络错误:",l),c.error({title:"操作失败",message:n})}finally{e==="screenshot"&&(Te.value=!1)}},Ae=async s=>{const e=te.value.find(u=>u.name===s);if(e?.site)return e.site;try{const u=await D.get("/api/sites/status");te.value=u.data;const l=te.value.find(n=>n.name===s);if(l?.site)return l.site}catch(u){console.warn("获取站点状态失败:",u)}return{人人:"audiences",不可说:"ssd",憨憨:"hhanclub",财神:"cspt"}[s]||s.toLowerCase()},is=async()=>{try{const s=await D.get("/api/sites/status");te.value=s.data;const e=await D.get("/api/downloaders_list");Pe.value=e.data}catch{c.error({title:"错误",message:"无法从服务器获取站点状态列表或下载器列表"})}},rs=async()=>{if(!P.value||!y.value)return;const s=y.value.sites[P.value];let e=s.torrentId||null;if(!e){const l=s.comment?.match(/id=(\d+)/);if(!l||!l[1]){c.error(`无法从源站点 ${P.value} 的链接中提取种子ID。`),F("cancel");return}e=l[1]}O.value=!0;const d=`fetch_${e}_${Date.now()}`;xe.value=d,be.value=!0;let u=null;try{const l=await Ae(P.value);console.log(`尝试从数据库读取种子信息: ${e} from ${P.value} (${l})`);const n=await D.get("/api/migrate/get_db_seed_info",{params:{torrent_id:e,site_name:l,task_id:d},timeout:12e4});if(n.status===202&&n.data.should_fetch){console.log("数据库中没有缓存，继续使用同一日志流从源站点抓取...");const p=n.data.task_id||d;try{const b=await D.post("/api/migrate/fetch_and_store",{sourceSite:P.value,searchTerm:e,savePath:y.value.save_path,torrentName:y.value.name,downloaderId:y.value.downloaderId,task_id:p},{timeout:12e4});if(!b.data.success){c.closeAll(),c.error({title:"抓取失败",message:b.data.message||"从源站点抓取失败",duration:0,showClose:!0}),F("cancel"),O.value=!1;return}const g=await D.get("/api/migrate/get_db_seed_info",{params:{torrent_id:e,site_name:l},timeout:12e4});if(!g.data.success){c.closeAll(),c.error({title:"读取失败",message:"数据抓取成功但从数据库读取失败",duration:0,showClose:!0}),F("cancel"),O.value=!1;return}c.closeAll(),c.success({title:"抓取成功",message:"种子信息已成功抓取并存储到数据库，请核对。"});const f=g.data.data;g.data.reverse_mappings&&(N.value=g.data.reverse_mappings),a.value={original_main_title:f.title||"",title_components:f.title_components||[],subtitle:f.subtitle,imdb_link:f.imdb_link,douban_link:f.douban_link,intro:{statement:U(f.statement)||"",poster:f.poster||"",body:U(f.body)||"",screenshots:f.screenshots||"",removed_ardtudeclarations:f.removed_ardtudeclarations||[]},mediainfo:f.mediainfo||"",source_params:f.source_params||{},standardized_params:{type:f.type||"",medium:f.medium||"",video_codec:f.video_codec||"",audio_codec:f.audio_codec||"",resolution:f.resolution||"",team:f.team||"",source:f.source||"",tags:f.tags||[]},final_publish_parameters:f.final_publish_parameters||{},complete_publish_params:f.complete_publish_params||{},raw_params_for_preview:f.raw_params_for_preview||{}},Y.value=b.data.task_id,ue.value=!0,$.value=0,me(()=>{Le()}),O.value=!1;return}catch(b){c.closeAll(),we(b,"从源站点抓取时发生网络错误"),F("cancel"),O.value=!1;return}}else if(n.data.success){c.closeAll(),c.success({title:"读取成功",message:"种子信息已从数据库成功加载，请核对。"});const p=n.data.data;if(!p||!p.title)throw new Error("数据库返回的种子信息不完整");if(n.data.reverse_mappings?(N.value=n.data.reverse_mappings,console.log("成功加载反向映射表:",N.value),console.log("type映射数量:",Object.keys(N.value.type||{}).length),console.log("当前standardized_params:",p.standardized_params)):console.warn("后端未返回反向映射表，将使用空的默认映射"),a.value={original_main_title:p.title||"",title_components:p.title_components||[],subtitle:p.subtitle,imdb_link:p.imdb_link,douban_link:p.douban_link,intro:{statement:U(p.statement)||"",poster:p.poster||"",body:U(p.body)||"",screenshots:p.screenshots||"",removed_ardtudeclarations:p.removed_ardtudeclarations||[]},mediainfo:p.mediainfo||"",source_params:p.source_params||{},standardized_params:{type:p.type||"",medium:p.medium||"",video_codec:p.video_codec||"",audio_codec:p.audio_codec||"",resolution:p.resolution||"",team:p.team||"",source:p.source||"",tags:p.tags||[]},final_publish_parameters:p.final_publish_parameters||{},complete_publish_params:p.complete_publish_params||{},raw_params_for_preview:p.raw_params_for_preview||{}},(!p.title_components||p.title_components.length===0)&&p.title)try{const b=await D.post("/api/utils/parse_title",{title:p.title});b.data.success&&(a.value.title_components=b.data.components,c.info({title:"标题解析",message:"已自动解析主标题为组件信息。"}))}catch(b){console.warn("自动解析标题失败:",b)}if(console.log("设置torrentData.standardized_params:",a.value.standardized_params),console.log("检查绑定 - type:",a.value.standardized_params.type),console.log("检查绑定 - medium:",a.value.standardized_params.medium),n.data.task_id?(Y.value=n.data.task_id,c.success({title:"缓存准备完成",message:"发布任务已准备就绪"})):(Y.value=`db_${e}_${l}`,console.warn("后端未返回taskId，使用标识符")),ue.value=!0,(!a.value.imdb_link||!a.value.douban_link)&&a.value.intro.body){let b=!1,g=!1;if(!a.value.imdb_link){const f=/(https?:\/\/www\.imdb\.com\/title\/tt\d+)/,B=a.value.intro.body.match(f);B&&B[1]&&(a.value.imdb_link=B[1],b=!0)}if(!a.value.douban_link){const f=/(https:\/\/movie\.douban\.com\/subject\/\d+)/,B=a.value.intro.body.match(f);B&&B[1]&&(a.value.douban_link=B[1],g=!0)}if(b||g){const f=[];b&&f.push("IMDb链接"),g&&f.push("豆瓣链接"),c.info({title:"自动填充",message:`已从简介正文中自动提取并填充 ${f.join(" 和 ")}。`})}}$.value=0,me(()=>{Le()}),ue.value=!0,O.value=!1;return}else console.log("数据库中没有找到种子信息，开始抓取数据...")}catch(l){u=l,console.log("从数据库读取失败，开始抓取数据...",l),l.code==="ECONNABORTED"||l.message.includes("timeout")?console.warn("数据库读取超时，将尝试直接抓取数据..."):l.response?.status>=500?console.warn("数据库服务器错误，将尝试直接抓取数据..."):console.warn("数据库读取发生未知错误，将尝试直接抓取数据...")}try{c.closeAll(),c({title:"正在抓取",message:"正在从源站点抓取种子信息并存储到数据库...",type:"info",duration:0}),u&&(console.warn(`由于数据库读取失败（${u.message}），正在直接抓取数据...`),c.warning({title:"数据库读取失败",message:"正在尝试直接抓取数据，请稍候...",duration:3e3}));const l=await D.post("/api/migrate/fetch_and_store",{sourceSite:P.value,searchTerm:e,savePath:y.value.save_path,torrentName:y.value.name,downloaderId:y.value.downloaderId||(y.value.downloaderIds?.length>0?y.value.downloaderIds[0]:null)},{timeout:12e4});if(l.data.success){console.log("数据抓取成功，立即从数据库读取...");let n=0;const p=3;let b=null;for(;n<p;){n++;try{const g=await Ae(P.value);if(console.log(`重试从数据库读取种子信息: ${e} from ${P.value} (${g})`),b=await D.get("/api/migrate/get_db_seed_info",{params:{torrent_id:e,site_name:g},timeout:12e4}),b.data.success)break;console.warn(`数据库读取第${n}次失败：${b.data.message}`),n<p&&await new Promise(f=>setTimeout(f,1e3))}catch(g){if(console.warn(`数据库读取第${n}次失败：`,g),n<p)await new Promise(f=>setTimeout(f,1e3));else throw g}}if(b&&b.data.success){c.closeAll();const g=b.data.data;if(!g||!g.title)throw new Error("数据库返回的种子信息不完整");if(b.data.reverse_mappings?(N.value=b.data.reverse_mappings,console.log("成功加载反向映射表:",N.value)):console.warn("后端未返回反向映射表，将使用空的默认映射"),c.success({title:"抓取成功",message:u?"种子信息已成功抓取，请核对。由于数据库读取失败，数据未持久化存储。":"种子信息已成功抓取并存储到数据库，请核对。"}),a.value={original_main_title:g.title||"",title_components:g.title_components||[],subtitle:g.subtitle,imdb_link:g.imdb_link,douban_link:g.douban_link,intro:{statement:U(g.statement)||"",poster:g.poster||"",body:U(g.body)||"",screenshots:g.screenshots||"",removed_ardtudeclarations:g.removed_ardtudeclarations||[]},mediainfo:g.mediainfo||"",source_params:g.source_params||{},standardized_params:{type:g.type||"",medium:g.medium||"",video_codec:g.video_codec||"",audio_codec:g.audio_codec||"",resolution:g.resolution||"",team:g.team||"",source:g.source||"",tags:g.tags||[]},final_publish_parameters:g.final_publish_parameters||{},complete_publish_params:g.complete_publish_params||{},raw_params_for_preview:g.raw_params_for_preview||{}},(!g.title_components||g.title_components.length===0)&&g.title)try{const f=await D.post("/api/utils/parse_title",{title:g.title});f.data.success&&(a.value.title_components=f.data.components,c.info({title:"标题解析",message:"已自动解析主标题为组件信息。"}))}catch(f){console.warn("自动解析标题失败:",f)}if(Y.value=l.data.task_id,ue.value=!0,(!a.value.imdb_link||!a.value.douban_link)&&a.value.intro.body){let f=!1,B=!1;if(!a.value.imdb_link){const X=/(https?:\/\/www\.imdb\.com\/title\/tt\d+)/,Z=a.value.intro.body.match(X);Z&&Z[1]&&(a.value.imdb_link=Z[1],f=!0)}if(!a.value.douban_link){const X=/(https:\/\/movie\.douban\.com\/subject\/\d+)/,Z=a.value.intro.body.match(X);Z&&Z[1]&&(a.value.douban_link=Z[1],B=!0)}if(f||B){const X=[];f&&X.push("IMDb链接"),B&&X.push("豆瓣链接"),c.info({title:"自动填充",message:`已从简介正文中自动提取并填充 ${X.join(" 和 ")}。`})}}$.value=0,me(()=>{Le()})}else c.closeAll(),c.error({title:"读取失败",message:`数据抓取成功但数据库读取失败，已重试${p}次。请检查数据库连接或稍后重试。`,duration:0,showClose:!0}),F("cancel")}else{c.closeAll();const n=l.data.message||"抓取种子信息失败";n.includes("数据库")||u?c.error({title:"抓取失败",message:`${n}。可能由于数据库连接问题导致，请检查数据库状态。`,duration:0,showClose:!0}):c.error({title:"抓取失败",message:n,duration:0,showClose:!0}),F("cancel")}}catch(l){c.closeAll(),l.code==="ECONNABORTED"||l.message.includes("timeout")?c.error({title:"请求超时",message:"抓取种子信息超时，请检查网络连接或稍后重试。",duration:0,showClose:!0}):l.response?.status===404?c.error({title:"资源未找到",message:"在源站点未找到指定的种子，请检查种子ID是否正确。",duration:0,showClose:!0}):l.response?.status>=500?c.error({title:"服务器错误",message:"后端服务器发生错误，请稍后重试或联系管理员。",duration:0,showClose:!0}):we(l,"获取种子信息时发生网络错误"),F("cancel")}finally{O.value=!1}},Q=x(()=>{const s=a.value.standardized_params,e=["type","medium","video_codec","audio_codec","resolution","team","source"],d=[],u=new RegExp(/^[\p{L}\p{N}_-]+\.[\p{L}\p{N}_-]+$/u);for(const l of e){const n=s[l];n&&typeof n=="string"&&n.trim()!==""&&!u.test(n)&&d.push(l)}return ke.value.length>0&&d.push("tags"),d}),ds=async()=>{if(console.log("=== 从store获取的已存在站点信息 ==="),console.log("torrent.value:",y.value),console.log("torrent.value.sites:",y.value?.sites),y.value?.sites){const e=Object.keys(y.value.sites);console.log("已存在的站点列表:",e),console.log("已存在站点详细信息:",y.value.sites)}else console.log("未找到已存在站点信息");console.log("=====================================");const s=Q.value;if(s.length>0){const e={type:"类型",medium:"媒介",video_codec:"视频编码",audio_codec:"音频编码",resolution:"分辨率",team:"制作组",source:"产地",tags:"标签"},d=s.map(u=>e[u]||u);c({title:"参数格式不正确",message:`以下参数格式不正确，请修改为 *.* 的标准格式: ${d.join(", ")}`,type:"warning",duration:0,showClose:!0});return}O.value=!0;try{c({title:"正在处理",message:"正在更新参数并生成预览...",type:"info",duration:0});let e,d;if(ue.value&&Y.value&&Y.value.startsWith("db_")){const n=Y.value.split("_");n.length>=3&&(e=n[1],d=n.slice(2).join("_"))}else if(Y.value&&Y.value.startsWith("db_")){const n=Y.value.split("_");n.length>=3&&(e=n[1],d=n.slice(2).join("_"))}else{const n=y.value.sites[P.value];if(e=n.torrentId||null,d=await Ae(P.value),!e){const p=n.comment?.match(/id=(\d+)/);p&&p[1]&&(e=p[1])}}if(!e||!d){c.error({title:"参数错误",message:"无法获取种子ID或站点名称",duration:0,showClose:!0});return}console.log(`更新种子参数: ${e} from ${d}`);const u={title:a.value.original_main_title,subtitle:a.value.subtitle,imdb_link:a.value.imdb_link,douban_link:a.value.douban_link,poster:a.value.intro.poster,screenshots:a.value.intro.screenshots,statement:U(a.value.intro.statement),body:U(a.value.intro.body),mediainfo:a.value.mediainfo,source_params:a.value.source_params,title_components:a.value.title_components,standardized_params:a.value.standardized_params};console.log("发送到后端的标准参数:",a.value.standardized_params);const l=await D.post("/api/migrate/update_db_seed_info",{torrent_id:e,site_name:d,updated_parameters:u});if(console.log("已调用更新接口，is_reviewed 将被设置为 true"),c.closeAll(),l.data.success){c.closeAll();const{standardized_params:n,final_publish_parameters:p,complete_publish_params:b,raw_params_for_preview:g,reverse_mappings:f}=l.data;f&&(N.value=f,console.log("成功更新反向映射表:",N.value)),a.value={...a.value,standardized_params:n||{},final_publish_parameters:p||{},complete_publish_params:b||{},raw_params_for_preview:g||{}},c.success({title:"更新成功",message:"参数已更新并重新标准化，请核对预览内容。"}),$.value=1}else c.error({title:"更新失败",message:l.data.message||"更新参数失败",duration:0,showClose:!0})}catch(e){c.closeAll(),we(e,"更新预览数据时发生网络错误")}finally{O.value=!1}},us=x(()=>{const s=Object.keys(N.value.tags||{}),e=a.value.standardized_params.tags||[];return[...new Set([...s,...e])].filter(l=>!Se(l)).map(l=>({value:l,label:N.value.tags[l]||l}))}),cs=s=>s==="禁转"||s==="tag.禁转"?"danger":(console.log(`[getTagType] 检查标签: "${s}", 是否无效: ${ke.value.includes(s)}`),ke.value.includes(s)?"danger":"info"),ms=async()=>{const s=y.value?.sites?Object.keys(y.value.sites).length:0;if(s<2){console.log(`已存在站点数量不足(${s}个)，正在重新获取种子数据...`);try{c.info({title:"正在更新数据",message:"正在重新获取种子站点信息...",duration:0});const e=new URLSearchParams({page:"1",pageSize:"1",nameSearch:y.value.name}),u=(await D.get(`/api/data?${e.toString()}`)).data;if(u.error)throw new Error(u.error);if(u.data&&u.data.length>0){const l=u.data[0];console.log("重新获取到的种子数据:",l),console.log("重新获取到的站点信息:",l.sites),console.log(`站点数量从 ${s} 更新到 ${Object.keys(l.sites).length}`),K.setParams(l),c.success({title:"数据更新成功",message:`已重新获取种子站点信息，发现 ${Object.keys(l.sites).length} 个站点`})}else c.warning({title:"未找到种子",message:"未能找到匹配的种子数据"})}catch(e){console.error("重新获取种子数据时出错:",e),c.error({title:"数据更新失败",message:e.message||"重新获取种子数据时发生错误"})}}else console.log(`已存在站点数量充足(${s}个)，跳过重新获取`);$.value=2},ps=s=>{const e=W.value.indexOf(s);e>-1?W.value.splice(e,1):W.value.push(s)},vs=()=>{const s=te.value.filter(e=>e.is_target&&Ne(e.name)).map(e=>e.name);W.value=s},_s=()=>{W.value=[]},fs=async()=>{$.value=3,O.value=!0,oe.value=[],M.value={current:0,total:W.value.length},j.value={current:0,total:0},c({title:"正在发布",message:`准备向 ${W.value.length} 个站点发布种子...`,type:"info",duration:0});const s=[];for(const l of W.value){try{const n=await D.post("/api/migrate/publish",{task_id:Y.value,upload_data:{...a.value,save_path:y.value.save_path},targetSite:l,sourceSite:P.value,downloaderId:y.value.downloaderId,auto_add_to_downloader:!0}),p={siteName:l,message:bs(n.data.logs||"发布成功"),...n.data};if(n.data.logs&&n.data.logs.includes("种子已存在")&&(p.isExisted=!0),p.auto_add_result){let b="自动检测";if(p.auto_add_result.downloader_id){const g=Pe.value.find(f=>f.id===p.auto_add_result.downloader_id);g&&(b=g.name)}p.downloaderStatus={success:p.auto_add_result.success,message:p.auto_add_result.message,downloaderName:b},p.auto_add_result.success&&j.value.current++}s.push(p),oe.value=[...s],p.success&&c.success({title:`发布成功 - ${l}`,message:"种子已成功发布到该站点"})}catch(n){const p={siteName:l,success:!1,logs:n.response?.data?.logs||n.message,url:null,message:`发布到 ${l} 时发生网络错误。`,downloaderStatus:{success:!1,message:"发布失败，无法添加到下载器",downloaderName:"错误"}};s.push(p),oe.value=[...s],c.error({title:`发布失败 - ${l}`,message:p.message})}M.value.current++,await new Promise(n=>setTimeout(n,1e3))}c.closeAll();const e=s.filter(l=>l.success).length;c.success({title:"发布完成",message:`成功发布到 ${e} / ${W.value.length} 个站点。`}),le.value+=`

--- [自动添加任务结果] ---`;const d={};s.forEach(l=>{if(l.auto_add_result){const n=l.downloaderStatus?.downloaderName||"自动检测";d[l.siteName]={success:l.auto_add_result.success,message:l.auto_add_result.message,downloaderName:n};const p=l.auto_add_result.success?"✅":"❌",b=l.auto_add_result.success?"成功":"失败";le.value+=`
[${l.siteName}] ${p} ${b}: ${l.auto_add_result.message}`}else l.success&&l.url&&(le.value+=`
[${l.siteName}] ⚠️  未执行自动添加`)}),le.value+=`
--- [自动添加任务结束] ---`;const u=s.map(l=>{let n=`--- Log for ${l.siteName} ---
${l.logs||"No logs available."}`;if(d[l.siteName]){const p=d[l.siteName];n+=`

--- Downloader Status for ${l.siteName} ---`,p.success?n+=`
✅ 成功: ${p.message}`:n+=`
❌ 失败: ${p.message}`}return n});le.value=u.join(`

`),oe.value=s.map(l=>({...l,downloaderStatus:d[l.siteName]}));try{await D.post("/api/refresh_data"),c.success({title:"数据刷新",message:"种子数据已刷新"})}catch(l){console.warn("刷新种子数据失败:",l)}O.value=!1},gs=()=>{$.value>0&&$.value--},Oe=()=>{$.value===3?F("close-with-refresh"):F("cancel")},je=()=>{F("complete")},bs=s=>s==="发布成功"?"发布成功":s.includes("种子已存在")?"种子已存在，发布成功":s.split(`
`).filter(u=>u&&!u.includes("--- [步骤")&&!u.includes("INFO - ---")).map(u=>u.replace(/^\d{2}:\d{2}:\d{2} - \w+ - /,"")).filter(Boolean).pop()||"发布成功",we=(s,e)=>{const d=s.response?.data?.logs||s.message||e;c.error({title:"操作失败",message:d,duration:0,showClose:!0})},H=s=>{const e=a.value.standardized_params;if(!e||!N.value)return"N/A";const d=e[s];if(!d)return"N/A";const u=N.value[s];return u&&u[d]||d},Ee=()=>!ne.value||!N.value.tags?[]:ne.value.map(s=>N.value.tags[s]||s),qe=x(()=>a.value.title_components.filter(s=>s.key!=="无法识别")),ne=x(()=>a.value.standardized_params.tags?.filter(e=>e&&typeof e=="string"&&e.trim()!=="")||[]),ke=x(()=>{const s=new RegExp(/^[\p{L}\p{N}_-]+\.[\p{L}\p{N}_-]+$/u);return ne.value.filter(e=>!s.test(e))}),hs=x(()=>["主标题","季集","年份","剧集状态","发布版本","分辨率","片源平台","媒介","视频编码","视频格式","HDR格式","色深","帧率","音频编码","制作组"].map(e=>({key:e,value:""}))),Se=s=>s==="禁转"||s==="tag.禁转",Fe=x(()=>(a.value.standardized_params.tags||[]).some(e=>Se(e))),ys=s=>{if(Se(s)){c.warning({title:"无法删除",message:"禁转标签不允许删除",duration:2e3});return}const e=a.value.standardized_params.tags.indexOf(s);e>-1&&a.value.standardized_params.tags.splice(e,1)},Me=x({get(){const s=a.value.title_components.find(e=>e.key==="无法识别");return s?s.value:""},set(s){const e=a.value.title_components.findIndex(d=>d.key==="无法识别");s===""||s===null?e!==-1&&a.value.title_components.splice(e,1):e!==-1?a.value.title_components[e].value=s:a.value.title_components.push({key:"无法识别",value:s})}}),ws=x(()=>{const s=a.value.standardized_params.team,e=a.value.title_components;if(s&&["cmct","cmctv"].includes(s.toLowerCase()))return!0;const d=e.find(u=>u.key==="制作组");if(d&&d.value){const u=d.value.toLowerCase(),l=["cmct","cmctv","telesto","shadow610"];for(const n of l)if(u.includes(n))return!0}return!1}),He=x(()=>{const s=a.value.title_components.find(p=>p.key==="无法识别"),e=s&&s.value!=="",d=!J.value;if(Fe.value)return!0;const u=a.value.mediainfo||"",l=!u||u.trim()==="";if(!l){const p=Ss(u),b=Cs(u);if(!p&&!b)return!0}const n=Q.value.length>0;return!!(e||d||n||l)}),ks=x(()=>Fe.value?"检测到禁转标签，不允许继续发布":"存在待修改的参数"),Ss=s=>["General","Video","Audio","Complete name","File size","Duration","Width","Height"].filter(u=>s.includes(u)).length>=3,Cs=s=>{const e=["DISC INFO","PLAYLIST REPORT"],d=["VIDEO:","AUDIO:","SUBTITLES:","FILES:","Disc Label","Disc Size","BDInfo:","Protection:","Codec","Bitrate","Language","Description"],u=e.filter(n=>s.includes(n)).length,l=d.filter(n=>s.includes(n)).length;return u===e.length||u>=1&&l>=2},Le=async()=>{const s=ce.value;if(s.length===0){J.value=!0;return}let e=!0;for(const d of s)try{await new Promise((u,l)=>{const n=new Image;n.onload=()=>{u(!0)},n.onerror=()=>{l(new Error("Image load failed"))},n.src=d})}catch{e=!1;break}J.value=e},Ke=()=>{ge.value=!1},Is=(s,e)=>{let d=`--- Log for ${s} ---
${e||"No logs available."}`;const u=oe.value.find(l=>l.siteName===s);if(u&&u.downloaderStatus){const l=u.downloaderStatus;d+=`

--- Downloader Status for ${s} ---`,l.success?d+=`
✅ 成功: ${l.message}`:d+=`
❌ 失败: ${l.message}`}le.value=d,ge.value=!0},$s=x(()=>{const s=oe.value,e=[];for(let d=0;d<s.length;d+=5)e.push(s.slice(d,d+5));return e}),zs=s=>s.some(e=>e.success&&e.url),Vs=s=>s.filter(e=>e.success&&e.url).length,Ts=s=>{const e=s.filter(d=>d.success&&d.url);if(e.length===0){c.warning({title:"无法打开",message:"该行没有可用的种子链接"});return}e.forEach(d=>{const u=We(d.url);window.open(u,"_blank","noopener,noreferrer")}),c.success({title:"批量打开成功",message:`已打开 ${e.length} 个种子页面`})},Ns=()=>{console.log("日志进度处理完成"),setTimeout(()=>{be.value=!1},1e3)},We=s=>{if(!s)return s;try{const e=new URL(s);return e.searchParams.delete("uploaded"),e.toString()}catch(e){return console.warn("Invalid URL format:",s,e),s}};return(s,e)=>{const d=R("el-icon"),u=R("el-button"),l=R("el-input"),n=R("el-form-item"),p=R("el-option"),b=R("el-select"),g=R("el-tag"),f=R("el-form"),B=R("el-tab-pane"),X=R("el-carousel-item"),Z=R("el-carousel"),As=R("el-empty"),Es=R("el-tabs"),Ms=R("el-alert"),Ls=R("el-button-group"),Ye=R("el-progress"),Ds=R("el-card");return m(),v(A,null,[t("div",sa,[t("header",aa,[t("div",ta,[(m(),v(A,null,L($e,(o,_)=>t("div",{key:_,class:T(["custom-step",{active:_===$.value,completed:_<$.value,last:_===$e.length-1}])},[t("div",la,[_<$.value?(m(),z(d,{key:0},{default:r(()=>[i(E(De))]),_:1})):(m(),v("span",oa,h(_+1),1))]),t("div",na,h(o.title),1),_<$e.length-1?(m(),v("div",ia)):w("",!0)],2)),64))])]),t("main",ra,[$.value===0?(m(),v("div",da,[i(Es,{modelValue:k.value,"onUpdate:modelValue":e[18]||(e[18]=o=>k.value=o),type:"border-card",class:"details-tabs"},{default:r(()=>[i(B,{label:"主要信息",name:"main"},{default:r(()=>[t("div",ua,[t("div",ca,[i(f,{"label-position":"top",class:"fill-height-form"},{default:r(()=>[t("div",ma,[i(n,{label:"原始/待解析标题"},{default:r(()=>[i(l,{modelValue:a.value.original_main_title,"onUpdate:modelValue":e[0]||(e[0]=o=>a.value.original_main_title=o)},{append:r(()=>[i(u,{icon:E(ie),onClick:ns,loading:ze.value},{default:r(()=>[...e[20]||(e[20]=[V(" 重新解析 ",-1)])]),_:1},8,["icon","loading"])]),_:1},8,["modelValue"])]),_:1}),t("div",pa,[qe.value.length>0?(m(!0),v(A,{key:0},L(qe.value,o=>(m(),z(n,{key:o.key,label:o.key},{default:r(()=>[i(l,{modelValue:o.value,"onUpdate:modelValue":_=>o.value=_},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"]))),128)):(m(!0),v(A,{key:1},L(hs.value,(o,_)=>(m(),z(n,{key:"init-"+_,label:o.key},{default:r(()=>[i(l,{modelValue:o.value,"onUpdate:modelValue":I=>o.value=I},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"]))),128))])]),t("div",va,[t("div",_a,[t("div",fa,[i(n,{label:"副标题"},{default:r(()=>[i(l,{modelValue:a.value.subtitle,"onUpdate:modelValue":e[1]||(e[1]=o=>a.value.subtitle=o)},null,8,["modelValue"])]),_:1})]),t("div",{class:T({"unrecognized-section":Me.value}),style:{"grid-column":"span 1"}},[i(n,{label:"无法识别"},{default:r(()=>[i(l,{modelValue:Me.value,"onUpdate:modelValue":e[2]||(e[2]=o=>Me.value=o)},null,8,["modelValue"])]),_:1})],2)]),t("div",ga,[t("div",ba,[i(n,{label:"类型 (type)"},{default:r(()=>[i(b,{modelValue:a.value.standardized_params.type,"onUpdate:modelValue":e[3]||(e[3]=o=>a.value.standardized_params.type=o),placeholder:"请选择类型",clearable:"",class:T({"is-invalid":Q.value.includes("type")}),"data-tag-style":""},{default:r(()=>[(m(!0),v(A,null,L(N.value.type,(o,_)=>(m(),z(p,{key:_,label:o,value:_},null,8,["label","value"]))),128))]),_:1},8,["modelValue","class"])]),_:1}),i(n,{label:"媒介 (medium)"},{default:r(()=>[i(b,{modelValue:a.value.standardized_params.medium,"onUpdate:modelValue":e[4]||(e[4]=o=>a.value.standardized_params.medium=o),placeholder:"请选择媒介",clearable:"",class:T({"is-invalid":Q.value.includes("medium")}),"data-tag-style":""},{default:r(()=>[(m(!0),v(A,null,L(N.value.medium,(o,_)=>(m(),z(p,{key:_,label:o,value:_},null,8,["label","value"]))),128))]),_:1},8,["modelValue","class"])]),_:1}),i(n,{label:"视频编码 (video_codec)"},{default:r(()=>[i(b,{modelValue:a.value.standardized_params.video_codec,"onUpdate:modelValue":e[5]||(e[5]=o=>a.value.standardized_params.video_codec=o),placeholder:"请选择视频编码",clearable:"",class:T({"is-invalid":Q.value.includes("video_codec")}),"data-tag-style":""},{default:r(()=>[(m(!0),v(A,null,L(N.value.video_codec,(o,_)=>(m(),z(p,{key:_,label:o,value:_},null,8,["label","value"]))),128))]),_:1},8,["modelValue","class"])]),_:1}),i(n,{label:"音频编码 (audio_codec)"},{default:r(()=>[i(b,{modelValue:a.value.standardized_params.audio_codec,"onUpdate:modelValue":e[6]||(e[6]=o=>a.value.standardized_params.audio_codec=o),placeholder:"请选择音频编码",clearable:"",class:T({"is-invalid":Q.value.includes("audio_codec")}),"data-tag-style":""},{default:r(()=>[(m(!0),v(A,null,L(N.value.audio_codec,(o,_)=>(m(),z(p,{key:_,label:o,value:_},null,8,["label","value"]))),128))]),_:1},8,["modelValue","class"])]),_:1}),i(n,{label:"分辨率 (resolution)"},{default:r(()=>[i(b,{modelValue:a.value.standardized_params.resolution,"onUpdate:modelValue":e[7]||(e[7]=o=>a.value.standardized_params.resolution=o),placeholder:"请选择分辨率",clearable:"",class:T({"is-invalid":Q.value.includes("resolution")}),"data-tag-style":""},{default:r(()=>[(m(!0),v(A,null,L(N.value.resolution,(o,_)=>(m(),z(p,{key:_,label:o,value:_},null,8,["label","value"]))),128))]),_:1},8,["modelValue","class"])]),_:1})]),t("div",ha,[i(n,{label:"制作组 (team)"},{default:r(()=>[i(b,{modelValue:a.value.standardized_params.team,"onUpdate:modelValue":e[8]||(e[8]=o=>a.value.standardized_params.team=o),placeholder:"请选择制作组",clearable:"",filterable:"","allow-create":"","default-first-option":"",class:T(["team-select",{"is-invalid":Q.value.includes("team")}])},{default:r(()=>[(m(!0),v(A,null,L(N.value.team,(o,_)=>(m(),z(p,{key:_,label:o,value:_},null,8,["label","value"]))),128))]),_:1},8,["modelValue","class"])]),_:1}),i(n,{label:"产地 (source)"},{default:r(()=>[i(b,{modelValue:a.value.standardized_params.source,"onUpdate:modelValue":e[9]||(e[9]=o=>a.value.standardized_params.source=o),placeholder:"请选择产地",clearable:"",class:T({"is-invalid":Q.value.includes("source")}),"data-tag-style":""},{default:r(()=>[(m(!0),v(A,null,L(N.value.source,(o,_)=>(m(),z(p,{key:_,label:o,value:_},null,8,["label","value"]))),128))]),_:1},8,["modelValue","class"])]),_:1}),i(n,{label:"标签 (tags)",class:"tags-wide-item"},{default:r(()=>[i(b,{modelValue:a.value.standardized_params.tags,"onUpdate:modelValue":e[10]||(e[10]=o=>a.value.standardized_params.tags=o),multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择或输入标签",style:{width:"100%"},onRemoveTag:s.handleTagRemove},{tag:r(({data:o})=>[(m(!0),v(A,null,L(o,_=>(m(),z(g,{key:_.value,type:cs(_.value),closable:!Se(_.value),"disable-transitions":"",onClose:I=>ys(_.value),style:{margin:"2px"}},{default:r(()=>[t("span",null,h(N.value.tags[_.value]||_.currentLabel),1)]),_:2},1032,["type","closable","onClose"]))),128))]),default:r(()=>[(m(!0),v(A,null,L(us.value,o=>(m(),z(p,{key:o.value,label:o.label,value:o.value},{default:r(()=>[t("span",{style:js({color:ke.value.includes(o.value)?"#F56C6C":""})},h(o.label),5)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","onRemoveTag"])]),_:1}),e[21]||(e[21]=t("div",{class:"placeholder-item"},null,-1)),e[22]||(e[22]=t("div",{class:"placeholder-item"},null,-1))])])])]),_:1})])])]),_:1}),i(B,{label:"海报与声明",name:"poster-statement"},{default:r(()=>[t("div",ya,[i(f,{"label-position":"top",class:"fill-height-form"},{default:r(()=>[t("div",wa,[t("div",ka,[i(n,{label:"声明",class:"statement-item"},{default:r(()=>[i(l,{type:"textarea",modelValue:a.value.intro.statement,"onUpdate:modelValue":e[11]||(e[11]=o=>a.value.intro.statement=o),rows:18},null,8,["modelValue"])]),_:1}),i(n,null,{label:r(()=>[t("div",Sa,[e[24]||(e[24]=t("span",null,"海报链接",-1)),i(u,{icon:E(ie),onClick:os,loading:fe.value,size:"small",type:"text"},{default:r(()=>[...e[23]||(e[23]=[V(" 重新获取 ",-1)])]),_:1},8,["icon","loading"])])]),default:r(()=>[i(l,{type:"textarea",modelValue:a.value.intro.poster,"onUpdate:modelValue":e[12]||(e[12]=o=>a.value.intro.poster=o),rows:2},null,8,["modelValue"])]),_:1})]),t("div",Ca,[t("div",Ia,[e[25]||(e[25]=t("div",{class:"preview-header"},"海报预览",-1)),t("div",$a,[he.value.length?(m(!0),v(A,{key:0},L(he.value,(o,_)=>(m(),v("img",{key:"poster-"+_,src:o,alt:"海报预览",class:"preview-image",onError:I=>ye(o,"poster",_)},null,40,za))),128)):(m(),v("div",Va,"暂无海报预览"))])])])])]),_:1})])]),_:1}),i(B,{label:"视频截图",name:"images"},{default:r(()=>[t("div",Ta,[t("div",Na,[i(f,{"label-position":"top",class:"fill-height-form"},{default:r(()=>[i(n,{class:"is-flexible"},{label:r(()=>[t("div",Aa,[e[27]||(e[27]=t("span",null,"截图",-1)),i(u,{icon:E(ie),onClick:ts,loading:ve.value,size:"small",type:"text"},{default:r(()=>[...e[26]||(e[26]=[V(" 重新获取 ",-1)])]),_:1},8,["icon","loading"])])]),default:r(()=>[i(l,{type:"textarea",modelValue:a.value.intro.screenshots,"onUpdate:modelValue":e[13]||(e[13]=o=>a.value.intro.screenshots=o),rows:20},null,8,["modelValue"])]),_:1})]),_:1})]),t("div",Ea,[t("div",Ma,[ce.value.length?(m(),z(Z,{key:0,interval:5e3,height:"500px","indicator-position":"outside"},{default:r(()=>[(m(!0),v(A,null,L(ce.value,(o,_)=>(m(),z(X,{key:"ss-"+_},{default:r(()=>[t("div",La,[t("img",{src:o,alt:"截图预览",class:"carousel-image",onError:I=>ye(o,"screenshot",_)},null,40,Da)])]),_:2},1024))),128))]),_:1})):(m(),v("div",Ra,"截图预览"))])])])]),_:1}),i(B,{label:"简介详情",name:"intro"},{default:r(()=>[i(f,{"label-position":"top",class:"fill-height-form"},{default:r(()=>[i(n,{class:"is-flexible"},{label:r(()=>[t("div",Pa,[e[29]||(e[29]=t("span",null,"正文",-1)),i(u,{icon:E(ie),onClick:as,loading:Ve.value,size:"small",type:"text"},{default:r(()=>[...e[28]||(e[28]=[V(" 重新获取 ",-1)])]),_:1},8,["icon","loading"])])]),default:r(()=>[i(l,{type:"textarea",modelValue:a.value.intro.body,"onUpdate:modelValue":e[14]||(e[14]=o=>a.value.intro.body=o),rows:18},null,8,["modelValue"])]),_:1}),i(n,{label:"豆瓣链接"},{default:r(()=>[i(l,{modelValue:a.value.douban_link,"onUpdate:modelValue":e[15]||(e[15]=o=>a.value.douban_link=o),placeholder:"请输入豆瓣电影链接"},null,8,["modelValue"])]),_:1}),i(n,{label:"IMDb链接"},{default:r(()=>[i(l,{modelValue:a.value.imdb_link,"onUpdate:modelValue":e[16]||(e[16]=o=>a.value.imdb_link=o),placeholder:"请输入IMDb电影链接"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),i(B,{label:"媒体信息",name:"mediainfo"},{default:r(()=>[i(f,{"label-position":"top",class:"fill-height-form"},{default:r(()=>[i(n,{class:"is-flexible"},{label:r(()=>[t("div",xa,[e[31]||(e[31]=t("span",null,"Mediainfo",-1)),i(u,{icon:E(ie),onClick:ls,loading:_e.value,size:"small",type:"text"},{default:r(()=>[...e[30]||(e[30]=[V(" 重新获取 ",-1)])]),_:1},8,["icon","loading"])])]),default:r(()=>[i(l,{type:"textarea",class:"code-font",modelValue:a.value.mediainfo,"onUpdate:modelValue":e[17]||(e[17]=o=>a.value.mediainfo=o),rows:26},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),i(B,{label:"已过滤声明",name:"filtered-declarations",class:"filtered-declarations-pane"},{default:r(()=>[t("div",Ua,[t("div",Ba,[e[32]||(e[32]=t("h3",null,"已自动过滤的声明内容",-1)),i(g,{type:"warning",size:"small"},{default:r(()=>[V("共 "+h(Be.value)+" 条",1)]),_:1})]),t("div",Oa,[Be.value>0?(m(!0),v(A,{key:0},L(Ue.value,(o,_)=>(m(),v("div",{key:_,class:"declaration-item"},[t("div",ja,[t("span",qa,"#"+h(_+1),1),i(g,{type:"danger",size:"small"},{default:r(()=>[...e[33]||(e[33]=[V("已过滤",-1)])]),_:1})]),t("pre",Fa,h(o),1)]))),128)):(m(),v("div",Ha,[i(As,{description:"未检测到需要过滤的 ARDTU 声明内容"})]))])])]),_:1})]),_:1},8,["modelValue"])])):w("",!0),$.value===1?(m(),v("div",Ka,[t("div",Wa,[t("div",Ya,[e[34]||(e[34]=t("div",{class:"row-label"},"主标题：",-1)),t("div",Ga,h(a.value.final_publish_parameters?.["主标题 (预览)"]||a.value.original_main_title||"暂无数据"),1)]),t("div",Ja,[e[35]||(e[35]=t("div",{class:"row-label"},"副标题：",-1)),t("div",Qa,h(a.value.subtitle||"暂无数据"),1)]),t("div",Xa,[e[47]||(e[47]=t("div",{class:"row-label"},"参数信息：",-1)),t("div",Za,[t("div",et,[t("div",st,[t("div",at,[e[36]||(e[36]=t("span",{class:"param-label"},"IMDb链接：",-1)),t("span",{class:T(["param-value",{empty:!a.value.imdb_link||a.value.imdb_link==="N/A"}])},h(a.value.imdb_link||"N/A"),3)]),t("div",tt,[e[37]||(e[37]=t("span",{style:{"letter-spacing":"2.6px"},class:"param-label"},"豆瓣链接",-1)),e[38]||(e[38]=t("span",{style:{"font-size":"13px"}},"：",-1)),t("span",{class:T(["param-value",{empty:!a.value.douban_link||a.value.douban_link==="N/A"}])},h(a.value.douban_link||"N/A"),3)])]),t("div",lt,[e[39]||(e[39]=t("span",{class:"param-label"},"标签：",-1)),t("div",ot,[t("span",{class:T(["param-value",{empty:!Ee()||Ee().length===0}])},h(Ee().join(", ")||"N/A"),3),ne.value&&ne.value.length>0?(m(),v("span",nt,h(ne.value.join(", ")),1)):w("",!0)])])]),t("div",it,[t("div",rt,[e[40]||(e[40]=t("span",{class:"param-label"},"类型：",-1)),t("div",dt,[t("span",{class:T(["param-value",{empty:!H("type")}])},h(H("type")||"N/A"),3),a.value.standardized_params.type?(m(),v("span",ut,h(a.value.standardized_params.type),1)):w("",!0)])]),t("div",ct,[e[41]||(e[41]=t("span",{class:"param-label"},"媒介：",-1)),t("div",mt,[t("span",{class:T(["param-value",{empty:!H("medium")}])},h(H("medium")||"N/A"),3),a.value.standardized_params.medium?(m(),v("span",pt,h(a.value.standardized_params.medium),1)):w("",!0)])]),t("div",vt,[e[42]||(e[42]=t("span",{class:"param-label"},"视频编码：",-1)),t("div",_t,[t("span",{class:T(["param-value",{empty:!H("video_codec")}])},h(H("video_codec")||"N/A"),3),a.value.standardized_params.video_codec?(m(),v("span",ft,h(a.value.standardized_params.video_codec),1)):w("",!0)])]),t("div",gt,[e[43]||(e[43]=t("span",{class:"param-label"},"音频编码：",-1)),t("div",bt,[t("span",{class:T(["param-value",{empty:!H("audio_codec")}])},h(H("audio_codec")||"N/A"),3),a.value.standardized_params.audio_codec?(m(),v("span",ht,h(a.value.standardized_params.audio_codec),1)):w("",!0)])]),t("div",yt,[e[44]||(e[44]=t("span",{class:"param-label"},"分辨率：",-1)),t("div",wt,[t("span",{class:T(["param-value",{empty:!H("resolution")}])},h(H("resolution")||"N/A"),3),a.value.standardized_params.resolution?(m(),v("span",kt,h(a.value.standardized_params.resolution),1)):w("",!0)])]),t("div",St,[e[45]||(e[45]=t("span",{class:"param-label"},"制作组：",-1)),t("div",Ct,[t("span",{class:T(["param-value",{empty:!H("team")}])},h(H("team")||"N/A"),3),a.value.standardized_params.team?(m(),v("span",It,h(a.value.standardized_params.team),1)):w("",!0)])]),t("div",$t,[e[46]||(e[46]=t("span",{class:"param-label"},"产地/来源：",-1)),t("div",zt,[t("span",{class:T(["param-value",{empty:!H("source")}])},h(H("source")||"N/A"),3),a.value.standardized_params.source?(m(),v("span",Vt,h(a.value.standardized_params.source),1)):w("",!0)])])])])]),t("div",Tt,[e[48]||(e[48]=t("div",{class:"row-label"},"Mediainfo：",-1)),t("div",Nt,[t("pre",At,h(a.value.mediainfo||"暂无数据"),1)])]),t("div",Et,[e[50]||(e[50]=t("div",{class:"row-label"},"简介内容：",-1)),t("div",Mt,[t("div",Lt,[t("div",{class:"section-content",innerHTML:re(a.value.intro?.statement)||"暂无声明"},null,8,Dt)]),he.value.length>0?(m(),v("div",Rt,[t("div",Pt,[(m(!0),v(A,null,L(he.value,(o,_)=>(m(),v("img",{key:"poster-preview-"+_,src:o,alt:"海报 "+(_+1),class:"preview-image-inline",style:{width:"300px"},onError:I=>ye(o,"poster",_)},null,40,xt))),128))])])):w("",!0),t("div",Ut,[e[49]||(e[49]=t("br",null,null,-1)),t("div",{class:"section-content",innerHTML:re(a.value.intro?.body)||"暂无正文"},null,8,Bt)]),ce.value.length>0?(m(),v("div",Ot,[t("div",jt,[(m(!0),v(A,null,L(ce.value,(o,_)=>(m(),v("img",{key:"screenshot-preview-"+_,src:o,alt:"截图 "+(_+1),class:"preview-image-inline",onError:I=>ye(o,"screenshot",_)},null,40,qt))),128))])])):w("",!0)])])])])):w("",!0),$.value===2?(m(),v("div",Ft,[e[55]||(e[55]=t("h3",{class:"selection-title"},"请选择要发布的目标站点",-1)),e[56]||(e[56]=t("p",{class:"selection-subtitle"},"已存在的站点已被自动禁用。红色站点表示未配置Cookie。",-1)),ws.value?(m(),z(Ms,{key:0,type:"error",closable:!1,style:{width:"410px",margin:"0 auto"}},{title:r(()=>[...e[51]||(e[51]=[t("span",{style:{"font-weight":"600"}},"禁止转载",-1)])]),default:r(()=>[e[52]||(e[52]=t("div",null,[V(" 检测到制作组包含禁止转载的内容，已自动禁用 UBits 站点。"),t("br"),V(" 禁止转载的制作组：CMCT、CMCTV ")],-1))]),_:1})):w("",!0),t("div",Ht,[i(Ls,null,{default:r(()=>[i(u,{type:"primary",onClick:vs},{default:r(()=>[...e[53]||(e[53]=[V("全选",-1)])]),_:1}),i(u,{type:"info",onClick:_s},{default:r(()=>[...e[54]||(e[54]=[V("清空",-1)])]),_:1})]),_:1})]),t("div",Kt,[(m(!0),v(A,null,L(te.value.filter(o=>o.is_target),o=>(m(),z(u,{key:o.name,class:"site-button",type:ss(o),plain:!o.has_cookie,disabled:!Ne(o.name),onClick:_=>ps(o.name)},{default:r(()=>[V(h(o.name)+" ",1),o.name==="ubits"&&!Ne(o.name)?(m(),z(E(Ce),{key:0,content:"该制作组禁止转载到 uBits 站点",placement:"top"},{default:r(()=>[i(d,{style:{"margin-left":"4px",color:"#f56c6c"}},{default:r(()=>[i(E(qs))]),_:1})]),_:1})):w("",!0)]),_:2},1032,["type","plain","disabled","onClick"]))),128))])])):w("",!0),$.value===3?(m(),v("div",Wt,[M.value.total>0||j.value.total>0?(m(),v("div",Yt,[M.value.total>0?(m(),v("div",Gt,[e[57]||(e[57]=t("div",{class:"progress-label"},"发布进度:",-1)),i(Ye,{percentage:Math.round(M.value.current/M.value.total*100),"show-text":!0},null,8,["percentage"]),t("div",Jt,h(M.value.current)+" / "+h(M.value.total),1)])):w("",!0),j.value.total>0?(m(),v("div",Qt,[e[58]||(e[58]=t("div",{class:"progress-label"},"下载器添加进度:",-1)),i(Ye,{percentage:Math.round(j.value.current/j.value.total*100),"show-text":!0},null,8,["percentage"]),t("div",Xt,h(j.value.current)+" / "+h(j.value.total),1)])):w("",!0)])):w("",!0),t("div",Zt,[(m(!0),v(A,null,L($s.value,(o,_)=>(m(),v("div",{key:_,class:"results-row"},[t("div",el,[(m(!0),v(A,null,L(o,I=>(m(),v("div",{key:I.siteName,class:T(["result-card",{"is-success":I.success,"is-error":!I.success}])},[t("div",sl,[I.success?(m(),z(d,{key:0,color:"#67C23A",size:32},{default:r(()=>[i(E(De))]),_:1})):(m(),z(d,{key:1,color:"#F56C6C",size:32},{default:r(()=>[i(E(Je))]),_:1}))]),t("h4",al,h(I.siteName),1),I.isExisted?(m(),v("div",tl,[i(g,{type:"warning",size:"small"},{default:r(()=>[...e[59]||(e[59]=[V("已存在",-1)])]),_:1})])):w("",!0),I.downloaderStatus?(m(),v("div",ll,[t("div",ol,[I.downloaderStatus.success?(m(),z(d,{key:0,color:"#67C23A",size:16},{default:r(()=>[i(E(De))]),_:1})):(m(),z(d,{key:1,color:"#F56C6C",size:16},{default:r(()=>[i(E(Je))]),_:1}))]),t("span",{class:T(["status-text",{success:I.downloaderStatus.success,error:!I.downloaderStatus.success}])},h(I.downloaderStatus.success?`种子已添加到'${I.downloaderStatus.downloaderName}'`:"添加失败"),3)])):w("",!0),t("div",nl,[i(u,{type:"primary",size:"small",onClick:bl=>Is(I.siteName,I.logs)},{default:r(()=>[...e[60]||(e[60]=[V(" 查看日志 ",-1)])]),_:1},8,["onClick"]),I.success&&I.url?(m(),v("a",{key:0,href:We(I.url),target:"_blank",rel:"noopener noreferrer",style:{transform:"translateY(-3px)"}},[i(u,{type:"success",size:"small"},{default:r(()=>[...e[61]||(e[61]=[V(" 查看种子 ",-1)])]),_:1})],8,il)):w("",!0)])],2))),128))]),t("div",rl,[i(u,{type:"warning",icon:E(ie),size:"large",onClick:I=>Ts(o),disabled:!zs(o),class:"open-all-button"},{default:r(()=>[t("div",dl,"打开"+h(Vs(o))+"个站点",1)]),_:2},1032,["icon","onClick","disabled"])])]))),128))])])):w("",!0)]),t("footer",ul,[$.value===0?(m(),v("div",cl,[i(u,{onClick:Oe},{default:r(()=>[...e[62]||(e[62]=[V("取消",-1)])]),_:1}),i(E(Ce),{content:ks.value,placement:"top",disabled:!He.value},{default:r(()=>[i(u,{type:"primary",onClick:ds,disabled:He.value},{default:r(()=>[...e[63]||(e[63]=[V(" 下一步：发布参数预览 ",-1)])]),_:1},8,["disabled"])]),_:1},8,["content","disabled"])])):w("",!0),$.value===1?(m(),v("div",ml,[i(u,{onClick:gs,disabled:O.value},{default:r(()=>[...e[64]||(e[64]=[V("上一步",-1)])]),_:1},8,["disabled"]),i(E(Ce),{content:C.value?"":"请先滚动到页面底部检查完种子信息再修改！",disabled:C.value,placement:"top"},{default:r(()=>[G.showCompleteButton?(m(),z(u,{key:0,type:"primary",onClick:je,disabled:O.value||!C.value,class:T({"scrolled-to-bottom":C.value})},{default:r(()=>[...e[65]||(e[65]=[V(" 修改完成 ",-1)])]),_:1},8,["disabled","class"])):w("",!0)]),_:1},8,["content","disabled"]),i(E(Ce),{content:C.value?"":"请先滚动到页面底部检查完种子信息再发布！",disabled:C.value,placement:"top"},{default:r(()=>[i(u,{type:"primary",onClick:ms,disabled:O.value||!C.value,class:T({"scrolled-to-bottom":C.value})},{default:r(()=>[...e[66]||(e[66]=[V(" 下一步：选择发布站点 ",-1)])]),_:1},8,["disabled","class"])]),_:1},8,["content","disabled"])])):w("",!0),$.value===2?(m(),v("div",pl,[i(u,{onClick:Oe,disabled:O.value},{default:r(()=>[...e[67]||(e[67]=[V("取消",-1)])]),_:1},8,["disabled"]),i(u,{type:"primary",onClick:fs,loading:O.value,disabled:W.value.length===0},{default:r(()=>[...e[68]||(e[68]=[V(" 立即发布 ",-1)])]),_:1},8,["loading","disabled"])])):w("",!0),$.value===3?(m(),v("div",vl,[i(u,{type:"primary",onClick:je},{default:r(()=>[...e[69]||(e[69]=[V("完成",-1)])]),_:1})])):w("",!0)])]),ge.value?(m(),v("div",{key:0,class:"log-card-overlay",onClick:Ke})):w("",!0),ge.value?(m(),z(Ds,{key:1,class:"log-card",shadow:"xl"},{header:r(()=>[t("div",_l,[e[70]||(e[70]=t("span",null,"操作日志",-1)),i(u,{type:"danger",icon:E(Os),circle:"",onClick:Ke},null,8,["icon"])])]),default:r(()=>[t("pre",fl,h(le.value),1)]),_:1})):w("",!0),i(ea,{visible:be.value,taskId:xe.value,onComplete:Ns,onClose:e[19]||(e[19]=o=>be.value=!1)},null,8,["visible","taskId"])],64)}}}),yl=Ze(gl,[["__scopeId","data-v-a5d3698a"]]);export{yl as C,Fs as u};
