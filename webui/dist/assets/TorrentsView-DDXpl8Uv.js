import{C as Vt,d as Ye,c as V,r as _,a as f,k as b,e as n,f as $,w as l,i as s,x as Q,D as Et,t as p,G as Ut,H as Mt,I as Rt,J as Bt,K as Ot,F as j,l as W,j as c,n as X,h as u,m as B,L as H,M as Pt,p as Je,N as qe,o as Ft,g as Y,O as Lt,u as Ve,v as jt,P as Kt,z as D,q as qt,B as At}from"./index-Z9sUXM0r.js";import{u as Yt,C as Jt}from"./CrossSeedPanel-BFL0AX7i.js";const We=Vt("siteData",{state:()=>({dialogVisible:!1,currentTorrent:null,downloadersMap:new Map,allDownloaders:[]}),actions:{openDialog(Z,ee){this.currentTorrent=Z,this.dialogVisible=!0,this.allDownloaders=ee||[],this.downloadersMap.clear(),ee&&ee.forEach(te=>{this.downloadersMap.set(te.id,te.name)})},closeDialog(){this.dialogVisible=!1,this.currentTorrent=null,this.downloadersMap.clear(),this.allDownloaders=[]},setCurrentTorrent(Z){this.currentTorrent=Z},getDownloaderName(Z){return this.downloadersMap.get(Z)||"未知下载器"},getAllDownloaders(){return this.allDownloaders}}}),Wt={key:0,class:"modal-overlay"},Xt={class:"modal-header"},Gt={key:0,class:"site-data-content"},Qt={class:"torrent-info"},Ht={class:"torrent-name"},Zt={class:"name-text"},es={class:"torrent-stats"},ts={class:"stat-item stat-item--fixed"},ss={class:"stat-value"},as={class:"stat-item stat-item--fixed"},ls={class:"stat-value"},ns={class:"stat-item stat-item--path"},os=["title"],is={class:"stat-item stat-item--fixed"},rs={class:"stat-value"},ds={class:"stat-item stat-item--fixed"},us={class:"stat-value"},cs={class:"content-area"},ps={class:"sites-container"},vs={key:0,class:"sites-grid"},fs=["onClick"],gs={class:"site-tile"},ms={class:"site-content"},_s={class:"site-name-wrapper"},hs={class:"site-name-with-link"},ys={class:"site-name-text"},ws={class:"seeders-info"},xs={class:"right-panel"},ks={class:"downloaders-section"},Ss={class:"downloaders-list"},bs=["onClick"],$s={class:"flow-section"},Cs={class:"flow-cards"},Is={class:"flow-card"},Ds={class:"card-content"},Ns={key:0,class:"empty-state"},zs={key:1,class:"site-info"},Ts={class:"site-name"},Vs={class:"flow-card"},Es={class:"card-content"},Us={class:"downloader-info current"},Ms={class:"flow-card"},Rs={class:"card-content"},Bs={class:"progress-section"},Os={class:"progress-bar-container"},Ps={class:"progress-percentage"},Fs={class:"progress-steps-info"},Ls={key:0,class:"current-status"},js={class:"modal-footer"},Ks=Ye({__name:"SiteDataViewer",props:{torrent:{}},emits:["refresh"],setup(Z,{emit:ee}){const te=ee,O=We(),ce=V(()=>O.dialogVisible),v=V(()=>O.currentTorrent),T=_(null),R=_(null),K=V(()=>!v.value||!v.value.sites?[]:Object.entries(v.value.sites).map(([r,d])=>({siteName:r,...d})).sort((r,d)=>(d.seeders||0)-(r.seeders||0))),q=()=>{S(),O.closeDialog()},k=r=>{if(r==null||r<=0)return"0 B";const d=["B","KB","MB","GB","TB","PB"],y=Math.floor(Math.log(r)/Math.log(1024));return`${(r/Math.pow(1024,y)).toFixed(2)} ${d[y]}`},g=r=>!!(r&&(r.startsWith("http")||/^\d+$/.test(r))),F=r=>(r.startsWith("http"),r),_e=r=>r.downloaderIds&&r.downloaderIds.length>0?r.downloaderIds.length===1?O.getDownloaderName(r.downloaderIds[0]):`${O.getDownloaderName(r.downloaderIds[0])} +${r.downloaderIds.length-1}`:r.downloaderId?O.getDownloaderName(r.downloaderId):"未知",G=r=>{T.value=r},L=r=>T.value===r,P=V(()=>{if(!T.value||!v.value||!v.value.sites)return null;const r=v.value.sites[T.value];return{siteName:T.value,seeders:r?.seeders||0,state:r?.state||"未知"}}),pe=r=>{R.value=r},Se=V(()=>O.getAllDownloaders()),he=V(()=>{if(!v.value)return null;const r=v.value.downloaderIds||[],d=v.value.downloaderId;return r.length>0?{id:r[0],name:O.getDownloaderName(r[0])}:d?{id:d,name:O.getDownloaderName(d)}:null}),N=_(0),ve=V(()=>{switch(N.value){case 0:return 0;case 1:return 33;case 2:return 66;case 3:return 100;default:return 0}}),ye=V(()=>{if(N.value!==0&&N.value===3)return"success"}),ne=r=>({"step-info--pending":N.value<r,"step-info--active":N.value===r,"step-info--completed":N.value>r}),oe=()=>{switch(N.value){case 1:return"正在暂停种子...";case 2:return"正在导出种子文件并添加...";case 3:return"转种完成！";default:return""}},S=()=>{N.value=0},we=async()=>{if(!T.value||!R.value||!v.value)return;const r=v.value.downloaderId||(v.value.downloaderIds&&v.value.downloaderIds.length>0?v.value.downloaderIds[0]:null);if(!r){alert("无法获取当前下载器信息");return}S();try{N.value=1;const y=await(await fetch("/api/torrent/transfer/prepare",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({source_downloader_id:r,target_downloader_id:R.value,site_name:T.value,torrent_name:v.value.name,torrent_size:v.value.size,save_path:v.value.save_path})})).json();if(!y.success){if(y.suggestions&&y.suggestions.length>0){const fe=y.suggestions.map((h,A)=>`${A+1}. ${h.name}
   站点: ${h.sites}
   大小: ${(h.size/1073741824).toFixed(2)} GB
   路径: ${h.save_path}`).join(`

`);if(confirm(`准备转移失败: ${y.message}

找到 ${y.suggestion_count} 个相似的种子:

${fe}

是否要使用第一个相似种子继续转移？`)&&y.suggestions.length>0){const h=y.suggestions[0];v.value&&(v.value.sites={[h.sites]:v.value.sites[T.value]||{}}),await se(h)}else S()}else alert(`准备转移失败: ${y.message}`),S();return}console.log(`找到 ${y.found_count} 个匹配的种子`),N.value=2;const I=await(await fetch("/api/torrent/transfer/execute",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({source_downloader_id:r,target_downloader_id:R.value,site_name:T.value,torrent_name:v.value.name,torrent_size:v.value.size,save_path:v.value.save_path})})).json();if(!I.success){alert(`转移失败: ${I.message}`),S();return}N.value=3,console.log("转移完成:",I);const ie=I.method==="torrent_file"?"种子文件":"未知方式";console.log(`转移方式: ${ie}`),te("refresh")}catch(d){console.error("转移过程中发生错误:",d),alert(`转移过程中发生错误: ${d?.message||"未知错误"}`),S()}},se=async r=>{if(!R.value||!v.value)return;const d=v.value.downloaderId||(v.value.downloaderIds&&v.value.downloaderIds.length>0?v.value.downloaderIds[0]:null);if(!d){alert("无法获取当前下载器信息"),S();return}try{console.log("使用相似种子重试转移:",r),N.value=2;const E=await(await fetch("/api/torrent/transfer/execute",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({source_downloader_id:d,target_downloader_id:R.value,site_name:r.sites,torrent_name:r.name,torrent_size:r.size,save_path:r.save_path})})).json();if(!E.success){alert(`转移失败: ${E.message}`),S();return}N.value=3,console.log("转移完成:",E);const I=E.method==="torrent_file"?"种子文件":"未知方式";console.log(`转移方式: ${I}`),te("refresh")}catch(y){console.error("重试转移过程中发生错误:",y),alert(`重试转移过程中发生错误: ${y?.message||"未知错误"}`),S()}};return(r,d)=>{const y=$("el-button"),E=$("el-icon"),I=$("el-link"),ie=$("el-tag"),fe=$("el-progress"),U=$("el-card");return ce.value?(u(),f("div",Wt,[n(U,{class:"site-data-card",shadow:"always"},{header:l(()=>[s("div",Xt,[s("span",null,"站点数据查看 - "+p(v.value?.name),1),n(y,{type:"danger",circle:"",onClick:q,plain:""},{default:l(()=>[...d[1]||(d[1]=[c("X",-1)])]),_:1})])]),default:l(()=>[v.value?(u(),f("div",Gt,[s("div",Qt,[s("div",Ht,[n(E,{class:"torrent-icon"},{default:l(()=>[n(Q(Et))]),_:1}),s("span",Zt,p(v.value.name),1)]),s("div",es,[s("div",ts,[n(E,{class:"stat-icon"},{default:l(()=>[n(Q(Ut))]),_:1}),d[2]||(d[2]=s("span",{class:"stat-label"},"大小",-1)),s("span",ss,p(k(v.value.size)),1)]),s("div",as,[n(E,{class:"stat-icon"},{default:l(()=>[n(Q(Mt))]),_:1}),d[3]||(d[3]=s("span",{class:"stat-label"},"上传",-1)),s("span",ls,p(v.value.total_uploaded_formatted||k(v.value.total_uploaded)),1)]),s("div",ns,[n(E,{class:"stat-icon"},{default:l(()=>[n(Q(Rt))]),_:1}),d[4]||(d[4]=s("span",{class:"stat-label"},"路径",-1)),s("span",{class:"stat-value",title:v.value.save_path},p(v.value.save_path),9,os)]),s("div",is,[n(E,{class:"stat-icon"},{default:l(()=>[n(Q(Bt))]),_:1}),d[5]||(d[5]=s("span",{class:"stat-label"},"下载器",-1)),s("span",rs,p(_e(v.value)),1)]),s("div",ds,[n(E,{class:"stat-icon"},{default:l(()=>[n(Q(Ot))]),_:1}),d[6]||(d[6]=s("span",{class:"stat-label"},"可转种",-1)),s("span",us,p(v.value.target_sites_count||0)+"个",1)])])]),s("div",cs,[s("div",ps,[K.value.length>0?(u(),f("div",vs,[(u(!0),f(j,null,W(K.value,h=>(u(),f("div",{key:h.siteName,class:X(["site-card",{"site-card--selected":L(h.siteName)}]),onClick:A=>G(h.siteName)},[s("div",gs,[s("div",ms,[s("div",_s,[s("div",hs,[s("span",ys,p(h.siteName),1),g(h.comment)?(u(),B(I,{key:0,href:F(h.comment),target:"_blank",underline:!1,class:"site-link-icon",onClick:d[0]||(d[0]=H(()=>{},["stop"]))},{default:l(()=>[n(E,{size:"10"},{default:l(()=>[n(Q(Pt))]),_:1})]),_:1},8,["href"])):b("",!0)])]),s("div",ws,[n(ie,{type:h.seeders>0?"warning":"info",size:"small"},{default:l(()=>[c(p(h.seeders||0)+"人做种 ",1)]),_:2},1032,["type"])])])])],10,fs))),128))])):b("",!0)]),s("div",xs,[s("div",ks,[d[7]||(d[7]=s("div",{class:"section-title"},"下载器",-1)),s("div",Ss,[(u(!0),f(j,null,W(Se.value,h=>(u(),f("div",{key:h.id,class:X(["downloader-item",{"downloader-item--selected":R.value===h.id}]),onClick:A=>pe(h.id)},p(h.name),11,bs))),128))])]),s("div",$s,[s("div",Cs,[s("div",Is,[d[8]||(d[8]=s("div",{class:"card-title"},"选中站点",-1)),s("div",Ds,[P.value?(u(),f("div",zs,[s("div",Ts,p(P.value.siteName),1),n(ie,{type:P.value.seeders>0?"warning":"info",size:"small"},{default:l(()=>[c(p(P.value.seeders)+"人做种 ",1)]),_:1},8,["type"])])):(u(),f("div",Ns,"未选择"))])]),d[11]||(d[11]=s("div",{class:"flow-divider"},[s("span",null,"→")],-1)),s("div",Vs,[d[9]||(d[9]=s("div",{class:"card-title"},"当前下载器",-1)),s("div",Es,[s("div",Us,p(he.value?.name||"未知"),1)])]),d[12]||(d[12]=s("div",{class:"flow-divider"},[s("span",null,"→")],-1)),s("div",Ms,[d[10]||(d[10]=s("div",{class:"card-title"},"目标下载器",-1)),s("div",Rs,[s("div",{class:X(["downloader-info target",{selected:R.value}])},p(R.value?Q(O).getDownloaderName(R.value):"未选择"),3)])])])]),s("div",Bs,[d[16]||(d[16]=s("div",{class:"progress-title"},"转种流程",-1)),s("div",Os,[n(fe,{percentage:ve.value,status:ye.value,"stroke-width":8,"show-text":!0},{default:l(({percentage:h})=>[s("span",Ps,p(h)+"%",1)]),_:1},8,["percentage","status"]),s("div",Fs,[s("div",{class:X(["step-info",ne(1)])},[...d[13]||(d[13]=[s("div",{class:"step-indicator"},null,-1),s("div",{class:"step-details"},[s("div",{class:"step-name"},"暂停种子"),s("div",{class:"step-desc"},"暂停下载器中选择的站点种子")],-1)])],2),s("div",{class:X(["step-info",ne(2)])},[...d[14]||(d[14]=[s("div",{class:"step-indicator"},null,-1),s("div",{class:"step-details"},[s("div",{class:"step-name"},"导出种子"),s("div",{class:"step-desc"},"导出种子文件并添加到目标下载器")],-1)])],2),s("div",{class:X(["step-info",ne(3)])},[...d[15]||(d[15]=[s("div",{class:"step-indicator"},null,-1),s("div",{class:"step-details"},[s("div",{class:"step-name"},"转移完成"),s("div",{class:"step-desc"},"种子已成功转移到目标下载器")],-1)])],2)]),N.value>0&&N.value<=3?(u(),f("div",Ls,p(oe()),1)):b("",!0)])])])])])):b("",!0),s("div",js,[n(y,{type:"success",onClick:we,disabled:!T.value||!R.value||N.value>0},{default:l(()=>[...d[17]||(d[17]=[c(" 执行转种 ",-1)])]),_:1},8,["disabled"]),n(y,{type:"primary",onClick:q},{default:l(()=>[...d[18]||(d[18]=[c("关闭",-1)])]),_:1})])]),_:1})])):b("",!0)}}}),qs=Je(Ks,[["__scopeId","data-v-6ee24ce4"]]),As={class:"torrents-view"},Ys={class:"expand-content"},Js=["onClick"],Ws=["href"],Xs=["onClick"],Gs={class:"name-header-container"},Qs={key:0,class:"current-filters",style:{"margin-right":"15px",display:"flex","align-items":"center"}},Hs={style:{"white-space":"normal"}},Zs={style:{display:"inline-block",width:"100%","text-align":"center"}},ea=["title"],ta={style:{display:"flex","justify-content":"center","align-items":"center",width:"100%",height:"100%"}},sa={key:0},aa={style:{padding:"1px 0",width:"100%"}},la={style:{"text-align":"center","font-size":"12px","margin-top":"5px","line-height":"1"}},na={style:{display:"flex","justify-content":"center","align-items":"center",width:"100%",height:"100%"}},oa={style:{display:"flex","justify-content":"center","align-items":"center",width:"100%",height:"100%"}},ia={key:0},ra={key:1},da={style:{display:"flex","justify-content":"center","align-items":"center",width:"100%",height:"100%"}},ua={key:3,class:"modal-overlay"},ca={class:"modal-header"},pa={key:0,class:"cross-seed-content"},va={class:"filter-card-header"},fa={class:"filter-card-body"},ga={class:"site-filter-container"},ma={style:{display:"flex","align-items":"center",gap:"15px","margin-bottom":"5px"}},_a={style:{display:"flex","align-items":"center",gap:"10px"}},ha={key:0,style:{display:"flex","align-items":"center"}},ya={key:1,style:{display:"flex","align-items":"center"}},wa={class:"site-checkbox-container"},xa={style:{"margin-bottom":"10px"}},ka={key:0,style:{display:"flex","align-items":"center"}},Sa={style:{"margin-bottom":"10px"}},ba={key:0,style:{display:"flex","align-items":"center"}},$a={class:"path-tree-container"},Ca={style:{"margin-bottom":"10px"}},Ia={key:0,style:{display:"flex","align-items":"center"}},Da={class:"filter-card-footer"},Na={class:"filter-card-header"},za={class:"site-operation-body"},Ta={class:"torrent-name-container"},Va={class:"torrent-name"},Ea={key:0,class:"site-operation-link"},Ua={key:1,class:"site-operation-input"},Ma={class:"site-operation-buttons"},Ra={key:6,class:"filter-overlay"},Ba={class:"filter-card-header"},Oa={class:"source-site-selection-body"},Pa={class:"source-site-tip"},Fa={key:0,class:"cached-sites-section"},La={class:"cached-sites-label"},ja={class:"site-list-box glass-site-box cached-sites-box"},Ka={key:1,class:"uncached-sites-section"},qa={class:"site-list-box glass-site-box"},Aa={class:"filter-card-footer"},Ae="torrents_view_first_load",Ya=Ye({__name:"TorrentsView",emits:["ready"],setup(Z,{emit:ee}){const te=ee,O=_(null),ce=_(!0),v=_([]),T=_(null),R=_(!1),K=_(""),q=_({prop:"name",order:"ascending"}),k=qe({paths:[],states:[],existSiteNames:[],notExistSiteNames:[],downloaderIds:[]}),g=qe({...k}),F=_("exist"),_e=V({get:()=>F.value==="exist"?g.existSiteNames:g.notExistSiteNames,set:t=>{F.value==="exist"?g.existSiteNames=t:g.notExistSiteNames=t}}),G=_(!1),L=_(1),P=_(50),pe=_(0),Se=_([]),he=_([]),N=_([]),ve=_({}),ye=_([]),ne=_([]),oe=_([]),S=_(null),we=_([]),se=_(!1),r=_([]),d=_(!1),y=_([]),E=_(!1),I=Yt(),ie=We(),fe=V(()=>!!I.taskId),U=V(()=>I.workingParams);V(()=>I.sourceInfo?.name||"");const h=_(!1),A=_(""),z=_(null),J=_(""),xe=_({}),be=V(()=>{const t=new Intl.Collator("zh-CN",{numeric:!0});return[...N.value].sort(t.compare)}),re=_(""),Ee=V(()=>{if(!re.value)return be.value;const t=re.value.toLowerCase();return be.value.filter(e=>e.toLowerCase().includes(t))}),Xe=V(()=>{const t=k,e=[];return t.paths&&t.paths.length>0&&e.push(`路径: ${t.paths.length}`),t.states&&t.states.length>0&&e.push(`状态: ${t.states.length}`),t.existSiteNames&&t.existSiteNames.length>0&&e.push(`存在于: ${t.existSiteNames.length}`),t.notExistSiteNames&&t.notExistSiteNames.length>0&&e.push(`不存在于: ${t.notExistSiteNames.length}`),t.downloaderIds&&t.downloaderIds.length>0&&e.push(`下载器: ${t.downloaderIds.length}`),e.join(", ")}),Ge=V(()=>{const t=k;return t.paths&&t.paths.length>0||t.states&&t.states.length>0||t.existSiteNames&&t.existSiteNames.length>0||t.notExistSiteNames&&t.notExistSiteNames.length>0||t.downloaderIds&&t.downloaderIds.length>0});V(()=>{const t=Ee.value;return F.value==="exist"?t.filter(e=>!g.notExistSiteNames.includes(e)):t.filter(e=>!g.existSiteNames.includes(e))});const Ue=t=>F.value==="exist"?!g.notExistSiteNames.includes(t):!g.existSiteNames.includes(t),Qe=[{color:"#f56c6c",percentage:80},{color:"#e6a23c",percentage:99},{color:"#67c23a",percentage:100}],ge=async()=>{try{const t={page_size:P.value,sort_prop:q.value.prop,sort_order:q.value.order,name_search:K.value,active_filters:k};await Y.post("/api/ui_settings",t)}catch(t){console.error("无法保存UI设置:",t.message)}},He=async()=>{try{const e=(await Y.get("/api/ui_settings")).data;if(P.value=e.page_size??50,q.value={prop:e.sort_prop||"name",order:"sort_order"in e?e.sort_order:"ascending"},K.value=e.name_search??"",e.active_filters){Object.assign(k,e.active_filters),k.existSiteNames||(k.existSiteNames=[]),k.notExistSiteNames||(k.notExistSiteNames=[]);const o=k;o.siteExistence&&delete o.siteExistence,o.siteNames&&delete o.siteNames}}catch(t){console.error("加载UI设置时出错:",t)}finally{R.value=!0}},Ze=t=>{const e=[],o=new Map;return t.sort().forEach(i=>{const m=i.replace(/^\/|\/$/g,"").split("/");let C="",w=e;m.forEach((ae,ue)=>{if(C=ue===0?`/${ae}`:`${C}/${ae}`,!o.has(C)){const le={path:ue===m.length-1?i:C,label:ae,children:[]};o.set(C,le),w.push(le)}w=o.get(C).children})}),o.forEach(i=>{i.children&&i.children.length===0&&delete i.children}),e},et=async()=>{try{const e=(await Y.get("/api/all_downloaders")).data;ne.value=e.filter(o=>o.enabled),oe.value=e}catch(t){T.value=t.message}},tt=async()=>{try{const e=(await Y.get("/api/sites/status")).data;r.value=e.filter(o=>o.is_source)}catch(t){T.value=t.message}},M=async()=>{ce.value=!0,T.value=null;try{const t=new URLSearchParams({page:L.value.toString(),pageSize:P.value.toString(),nameSearch:K.value,sortProp:q.value.prop||"name",sortOrder:q.value.order||"ascending",existSiteNames:JSON.stringify(k.existSiteNames),notExistSiteNames:JSON.stringify(k.notExistSiteNames),path_filters:JSON.stringify(k.paths||[]),state_filters:JSON.stringify(k.states),downloader_filters:JSON.stringify(k.downloaderIds)}),o=(await Y.get(`/api/data?${t.toString()}`)).data;if(o.error)throw new Error(o.error);v.value=o.data,pe.value=o.total,P.value!==o.pageSize&&(P.value=o.pageSize),Se.value=o.unique_paths,he.value=o.unique_states,N.value=o.all_discovered_sites,ve.value=o.site_link_rules,k.paths=o.active_path_filters,we.value=Ze(o.unique_paths)}catch(t){T.value=t.message}finally{ce.value=!1}},st=async t=>{I.reset();const e=Object.entries(t.sites).map(([o,i])=>({siteName:o,...i})).filter(o=>{if(!(o.migration===1||o.migration===3))return!1;const m=o.comment&&o.comment.includes("details.php?id="),C=o.comment&&/^\d+$/.test(o.comment.trim());return m||C});I.setParams(t),await nt(t),e.length===0&&D.warning("该种子暂无可用的源站点，您可以使用 IYUU 查询来发现更多站点。"),se.value=!0},at=t=>{ie.openDialog(t,oe.value)},lt=()=>{console.log("触发种子数据刷新"),M()},nt=async t=>{E.value=!0,y.value=[];try{const o=(await Y.get(`/api/cached_sites?name=${encodeURIComponent(t.name)}&size=${t.size}`)).data;o.success?(y.value=o.cached_sites||[],console.log("缓存站点查询结果:",y.value)):console.warn("查询缓存站点失败:",o.error)}catch(e){console.error("查询缓存站点时出错:",e)}finally{E.value=!1}},Me=async t=>{const e=U.value;if(!e||!t){D.error("发生内部错误：未找到选中的种子或站点信息。");return}const o=e.sites[t.siteName],i=t.siteName;if(!o){D.error(`未找到站点 [${i}] 的数据。`);return}if(!me(o,i)){D.info(`站点 [${i}] 缺少详情链接，正在触发 IYUU 查询...`),xe.value[i]=!0,await Fe(),xe.value[i]=!1;return}let m=null;const C=o?.comment?.match(/id=(\d+)/);if(C&&C[1])m=C[1];else if(o?.comment&&/^\d+$/.test(o.comment.trim()))m=o.comment.trim();else{D.error(`无法从源站点 ${i} 的详情页链接中提取种子ID。请尝试使用IYUU查询更新链接。`);return}o&&(o.torrentId=m);const w=r.value.find(ue=>ue.name===i)?.site||i.toLowerCase();D.success(`准备从站点 [${i}] 开始迁移种子...`);const ae={name:i,site:w,torrentId:m};I.setSourceInfo(ae),I.setTaskId(e.name+"_"+Date.now()),se.value=!1},de=t=>{if(!!!(U.value&&U.value.sites[t]))return!1;const o=r.value.find(i=>i.name===t);return!o||!o.has_cookie?!1:t==="杜比"||t==="HDtime"?!!o.has_passkey:!0},Re=()=>{I.reset()},Be=(t,e)=>{A.value=t,z.value=e,J.value="",h.value=!0},Oe=async()=>{if(!A.value||!z.value){D.error("缺少必要的参数");return}if(!J.value||J.value.trim()===""){D.error("请输入详情页链接或ID");return}try{const e=(await Y.post("/api/sites/update_comment",{torrent_name:A.value,site_name:z.value.name,comment:J.value.trim()})).data;e.success?(D.success("详情页链接已成功添加"),h.value=!1,J.value="",await M()):D.error(e.error||"添加详情页链接失败")}catch(t){console.error("添加详情页链接时出错:",t),D.error("添加详情页链接时发生网络错误")}},ot=async()=>{if(!A.value||!z.value){D.error("缺少必要的参数");return}try{const t=await Y.post("/api/sites/set_not_exist",{torrent_name:A.value,site_name:z.value.name});D.success("站点状态已成功设置为不存在"),h.value=!1,M()}catch(t){console.error("设置站点状态时出错:",t),D.error(t.response?.data?.error||"设置站点状态时发生错误")}},it=()=>{D.success("转种操作已完成！"),I.reset(),M()},rt=()=>{D.success("转种操作已完成！"),I.reset(),M()},Pe=t=>{if(!U.value)return null;const e=U.value.sites[t];return e?{siteName:t,...e}:null},Fe=async()=>{const t=U.value;if(!t){D.error("未找到选中的种子信息");return}d.value=!0;try{const o=(await Y.post("/api/iyuu_query",{name:t.name,size:t.size})).data;if(o.success){D.success(o.message||"IYUU查询已完成"),await M();const i=v.value.find(m=>m.name===t.name&&m.size===t.size);i&&I.setParams(i)}else D.error(o.error||"IYUU查询失败")}catch(e){console.error("触发IYUU查询时出错:",e),D.error(e.response?.data?.error||"触发IYUU查询时发生网络错误")}finally{d.value=!1}},dt=t=>{P.value=t,L.value=1,M(),ge()},ut=t=>{L.value=t,M()},ct=t=>{q.value=t,L.value=1,M(),ge()},pt=()=>{Object.assign(g,k),G.value=!0,qt(()=>{S.value&&S.value.setCheckedKeys(k.paths,!1)})},vt=async()=>{if(S.value){const t=S.value.getCheckedKeys(!1);g.paths=t}Object.assign(k,g),G.value=!1,L.value=1,await M(),ge()},ft=()=>{g.paths=[],g.states=[],g.existSiteNames=[],g.notExistSiteNames=[],g.downloaderIds=[],F.value="exist",re.value="",S.value&&S.value.setCheckedKeys([],!1)},gt=()=>{if(g.existSiteNames=[],F.value==="exist"&&S.value){const t=S.value.getCheckedKeys(!0);g.paths=t}},mt=()=>{if(g.notExistSiteNames=[],F.value==="not-exist"&&S.value){const t=S.value.getCheckedKeys(!0);g.paths=t}},_t=()=>{g.paths=[],S.value&&S.value.setCheckedKeys([],!1)},ht=()=>{g.states=[]},yt=()=>{g.downloaderIds=[]},wt=async()=>{k.paths=[],k.states=[],k.existSiteNames=[],k.notExistSiteNames=[],k.downloaderIds=[],K.value="",F.value="exist",re.value="",S.value&&S.value.setCheckedKeys([],!1),L.value=1,await M(),ge()},$e=t=>{if(t==null||t<=0)return"0 B";const e=["B","KB","MB","GB","TB","PB"],o=Math.floor(Math.log(t)/Math.log(1024));return`${(t/Math.pow(1024,o)).toFixed(2)} ${e[o]}`},me=(t,e)=>{const{comment:o}=t;return!!(o&&(o.startsWith("http")||/^\d+$/.test(o)&&ve.value[e]))},Ce=(t,e)=>{const{comment:o}=t;if(o.startsWith("http"))return o;const i=ve.value[e];return i&&/^\d+$/.test(o)?`${(i.base_url.startsWith("http")?i.base_url:`https://${i.base_url}`).replace(/\/$/,"")}/details.php?id=${o}`:null},Ie=t=>t.state==="未做种"?"danger":t.state==="不存在"?"info":t.comment?"success":t.state==="做种中"?"primary":"info",De=t=>{if(!t)return"未知下载器";const e=oe.value.find(o=>o.id===t);return e?e.name:"未知下载器"},xt=t=>{if(!t||!oe.value.find(m=>m.id===t))return"info";let o=0;for(let m=0;m<t.length;m++)o=t.charCodeAt(m)+((o<<5)-o);const i=["primary","success","warning","danger","info"];return i[Math.abs(o)%i.length]},kt=t=>[...t].sort((o,i)=>{const m=De(o),C=De(i);return m.localeCompare(C,"zh-CN")}),St=(t,e=50)=>{if(!t||t.length<=e)return t;const o=Math.floor((e-3)/2);let i=t.substring(0,o),m=t.substring(t.length-o);const C=i.lastIndexOf("/"),w=m.indexOf("/");return C>0&&w>=0&&(i=i.substring(0,C),m=m.substring(w+1)),`${i}...${m}`},Le=(t,e)=>{if(!!!(U.value&&U.value.sites[t.name]))return"info";const i=U.value.sites[t.name];return!t.has_cookie||t.name==="杜比"&&!t.has_passkey?"error":t.has_cookie&&i.comment?"success":"primary"},bt=t=>t.includes("下载")?"primary":t.includes("做种")?"success":t.includes("暂停")?"warning":t.includes("错误")||t.includes("丢失")?"danger":"info",$t=t=>O.value?.toggleRowExpansion(t),Ct=(t,e)=>{ye.value=e.map(o=>o.unique_id)},It=({row:t})=>ye.value.includes(t.unique_id)?"expanded-row":"";return Ft(async()=>{const t=!sessionStorage.getItem(Ae);if(await He(),M(),t){try{console.log("首次加载页面，触发种子数据刷新..."),await Y.post("/api/refresh_data"),console.log("种子数据刷新完成，重新获取数据..."),await M()}catch(e){console.warn("页面加载时种子数据刷新失败:",e)}sessionStorage.setItem(Ae,"loaded")}else console.log("页面已加载过，跳过种子数据刷新");et(),tt(),te("ready",M)}),Lt(K,()=>{L.value=1,M(),ge()}),(t,e)=>{const o=$("el-alert"),i=$("el-tag"),m=$("el-table-column"),C=$("el-input"),w=$("el-button"),ae=$("el-progress"),ue=$("el-table"),je=$("el-pagination"),le=$("el-card"),ke=$("el-divider"),Ke=$("el-radio-button"),Dt=$("el-radio-group"),Ne=$("el-checkbox"),ze=$("el-checkbox-group"),Nt=$("el-tree"),zt=$("el-link"),Te=jt("loading");return u(),f("div",As,[T.value?(u(),B(o,{key:0,title:T.value,type:"error","show-icon":"",closable:!1,center:"",style:{"margin-bottom":"15px"}},null,8,["title"])):b("",!0),R.value?Ve((u(),B(ue,{key:1,data:v.value,border:"",height:"100%",ref_key:"tableRef",ref:O,"row-key":"unique_id","row-class-name":It,onRowClick:$t,onExpandChange:Ct,onSortChange:ct,"default-sort":q.value,"empty-text":"无数据或当前筛选条件下无结果",class:"glass-table"},{default:l(()=>[n(m,{type:"expand",width:"1"},{default:l(a=>[s("div",Ys,[(u(!0),f(j,null,W(be.value,x=>(u(),f(j,{key:x},[a.row.sites[x]?(u(),f(j,{key:0},[a.row.sites[x].state==="未做种"?(u(),f("div",{key:0,style:{cursor:"pointer",display:"inline-block",width:"100%","text-align":"center"},onClick:H(Tt=>Be(a.row.name,{name:x,data:a.row.sites[x]}),["stop"])},[n(i,{effect:"dark",type:Ie(a.row.sites[x]),style:{"text-align":"center",width:"100%"}},{default:l(()=>[c(p(x)+" ",1),s("div",null,"("+p($e(a.row.sites[x].uploaded))+")",1)]),_:2},1032,["type"])],8,Js)):a.row.sites[x]&&me(a.row.sites[x],x)?(u(),f("a",{key:1,href:Ce(a.row.sites[x],x),target:"_blank",style:{"text-decoration":"none"}},[n(i,{effect:"dark",type:Ie(a.row.sites[x]),style:{"text-align":"center"}},{default:l(()=>[c(p(x)+" ",1),s("div",null,"("+p($e(a.row.sites[x].uploaded))+")",1)]),_:2},1032,["type"])],8,Ws)):(u(),f("div",{key:2,style:{cursor:"pointer",display:"inline-block",width:"100%","text-align":"center"},onClick:H(Tt=>Be(a.row.name,{name:x,data:a.row.sites[x]}),["stop"])},[n(i,{effect:"dark",type:Ie(a.row.sites[x]),style:{"text-align":"center",width:"100%"}},{default:l(()=>[c(p(x)+" ",1),s("div",null,"("+p($e(a.row.sites[x].uploaded))+")",1)]),_:2},1032,["type"])],8,Xs))],64)):(u(),B(i,{key:1,type:"info",effect:"plain"},{default:l(()=>[c(p(x),1)]),_:2},1024))],64))),128))])]),_:1}),n(m,{prop:"name","min-width":"450",sortable:"custom"},{header:l(()=>[s("div",Gs,[e[22]||(e[22]=s("div",null,"种子名称",-1)),n(C,{modelValue:K.value,"onUpdate:modelValue":e[0]||(e[0]=a=>K.value=a),placeholder:"搜索名称...",clearable:"",class:"search-input",onClick:e[1]||(e[1]=H(()=>{},["stop"]))},null,8,["modelValue"]),s("span",{onClick:e[2]||(e[2]=H(()=>{},["stop"])),style:{display:"flex","align-items":"center"}},[Ge.value?(u(),f("div",Qs,[n(i,{type:"info",size:"default",effect:"plain"},{default:l(()=>[c(p(Xe.value),1)]),_:1}),n(w,{type:"danger",link:"",style:{padding:"0","margin-left":"8px"},onClick:wt},{default:l(()=>[...e[20]||(e[20]=[c("清除",-1)])]),_:1})])):b("",!0),n(w,{type:"primary",onClick:pt,plain:""},{default:l(()=>[...e[21]||(e[21]=[c("筛选",-1)])]),_:1})])])]),default:l(a=>[s("span",Hs,p(a.row.name),1)]),_:1}),n(m,{prop:"site_count",label:"做种数",sortable:"custom",width:"95",align:"center","header-align":"center"},{default:l(a=>[s("span",Zs,p(a.row.site_count)+" / "+p(a.row.total_site_count),1)]),_:1}),n(m,{prop:"save_path",label:"保存路径",width:"220","header-align":"center"},{default:l(a=>[s("div",{title:a.row.save_path,style:{width:"100%",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},p(St(a.row.save_path,30)),9,ea)]),_:1}),n(m,{label:"下载器",width:"130",align:"center","header-align":"center"},{default:l(a=>[s("div",ta,[a.row.downloaderIds&&a.row.downloaderIds.length>0?(u(),f("div",sa,[(u(!0),f(j,null,W(kt(a.row.downloaderIds),x=>(u(),B(i,{key:x,size:"small",type:xt(x),style:{margin:"2px"}},{default:l(()=>[c(p(De(x)),1)]),_:2},1032,["type"]))),128))])):(u(),B(i,{key:1,type:"info",size:"small"},{default:l(()=>[...e[23]||(e[23]=[c(" 未知下载器 ",-1)])]),_:1}))])]),_:1}),n(m,{label:"大小",prop:"size_formatted",width:"100",align:"center",sortable:"custom"}),n(m,{label:"总上传量",prop:"total_uploaded_formatted",width:"110",align:"center",sortable:"custom"}),n(m,{label:"进度",prop:"progress",width:"120",align:"center",sortable:"custom"},{default:l(a=>[s("div",aa,[n(ae,{percentage:a.row.progress,"stroke-width":10,color:Qe,"show-text":!1,style:{width:"100%"}},null,8,["percentage"]),s("div",la,p(a.row.progress)+"% ",1)])]),_:1}),n(m,{label:"状态",prop:"state",width:"120",align:"center","header-align":"center"},{default:l(a=>[s("div",na,[n(i,{type:bt(a.row.state),size:"large"},{default:l(()=>[c(p(a.row.state),1)]),_:2},1032,["type"])])]),_:1}),n(m,{label:"可转种",width:"100",align:"center","header-align":"center",prop:"target_sites_count",sortable:"custom"},{default:l(a=>[s("div",oa,[a.row.target_sites_count!==void 0?(u(),f("span",ia,p(a.row.target_sites_count),1)):(u(),f("span",ra,"-"))])]),_:1}),n(m,{label:"操作",width:"100",align:"center","header-align":"center"},{default:l(a=>[s("div",da,[n(w,{type:"primary",size:"small",onClick:H(x=>st(a.row),["stop"])},{default:l(()=>[...e[24]||(e[24]=[c(" 转种 ",-1)])]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data","default-sort"])),[[Te,ce.value]]):b("",!0),pe.value>0?(u(),B(je,{key:2,class:"glass-pagination",style:{"justify-content":"flex-end"},"current-page":L.value,"onUpdate:currentPage":e[3]||(e[3]=a=>L.value=a),"page-size":P.value,"onUpdate:pageSize":e[4]||(e[4]=a=>P.value=a),"page-sizes":[20,50,100],total:pe.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:dt,onCurrentChange:ut,background:""},null,8,["current-page","page-size","total"])):b("",!0),fe.value?(u(),f("div",ua,[n(le,{class:"cross-seed-card",shadow:"always"},{header:l(()=>[s("div",ca,[s("span",null,"转种 - "+p(U.value?.name),1),n(w,{type:"danger",circle:"",onClick:Re,plain:""},{default:l(()=>[...e[25]||(e[25]=[c("X",-1)])]),_:1})])]),default:l(()=>[U.value?(u(),f("div",pa,[n(Jt,{onComplete:it,onCancel:Re,onCloseWithRefresh:rt})])):b("",!0)]),_:1})])):b("",!0),G.value?(u(),f("div",{key:4,class:"filter-overlay",onClick:e[12]||(e[12]=H(a=>G.value=!1,["self"]))},[n(le,{class:"filter-card"},{header:l(()=>[s("div",va,[e[27]||(e[27]=s("span",null,"筛选选项",-1)),n(w,{type:"danger",circle:"",onClick:e[5]||(e[5]=a=>G.value=!1),plain:""},{default:l(()=>[...e[26]||(e[26]=[c("X",-1)])]),_:1})])]),default:l(()=>[s("div",fa,[n(ke,{"content-position":"left"},{default:l(()=>[...e[28]||(e[28]=[c("站点筛选",-1)])]),_:1}),s("div",ga,[s("div",ma,[n(Dt,{modelValue:F.value,"onUpdate:modelValue":e[6]||(e[6]=a=>F.value=a),size:"default"},{default:l(()=>[n(Ke,{label:"exist",class:"compact-radio-button"},{default:l(()=>[...e[29]||(e[29]=[c("存在于",-1)])]),_:1}),n(Ke,{label:"not-exist",class:"compact-radio-button"},{default:l(()=>[...e[30]||(e[30]=[c("不存在于",-1)])]),_:1})]),_:1},8,["modelValue"]),n(C,{modelValue:re.value,"onUpdate:modelValue":e[7]||(e[7]=a=>re.value=a),placeholder:"搜索站点",clearable:"",style:{width:"280px","font-size":"14px"},size:"default"},null,8,["modelValue"]),s("div",_a,[g.existSiteNames.length>0?(u(),f("div",ha,[n(i,{type:"info",size:"default",effect:"plain"},{default:l(()=>[c("存在于: "+p(g.existSiteNames.length),1)]),_:1}),n(w,{type:"danger",link:"",style:{padding:"0","margin-left":"5px"},onClick:gt},{default:l(()=>[...e[31]||(e[31]=[c("清除",-1)])]),_:1})])):b("",!0),g.notExistSiteNames.length>0?(u(),f("div",ya,[n(i,{type:"info",size:"default",effect:"plain"},{default:l(()=>[c("不存在于: "+p(g.notExistSiteNames.length),1)]),_:1}),n(w,{type:"danger",link:"",style:{padding:"0","margin-left":"5px"},onClick:mt},{default:l(()=>[...e[32]||(e[32]=[c("清除",-1)])]),_:1})])):b("",!0)])]),s("div",wa,[n(ze,{modelValue:_e.value,"onUpdate:modelValue":e[8]||(e[8]=a=>_e.value=a)},{default:l(()=>[(u(!0),f(j,null,W(Ee.value,a=>(u(),B(Ne,{key:a,label:a,disabled:!Ue(a),class:X({"disabled-site":!Ue(a)})},{default:l(()=>[c(p(a),1)]),_:2},1032,["label","disabled","class"]))),128))]),_:1},8,["modelValue"])])]),n(ke,{"content-position":"left"},{default:l(()=>[...e[33]||(e[33]=[c("下载器",-1)])]),_:1}),s("div",xa,[g.downloaderIds.length>0?(u(),f("div",ka,[n(i,{type:"info",size:"default",effect:"plain"},{default:l(()=>[c("下载器: "+p(g.downloaderIds.length),1)]),_:1}),n(w,{type:"danger",link:"",style:{padding:"0","margin-left":"5px"},onClick:yt},{default:l(()=>[...e[34]||(e[34]=[c("清除",-1)])]),_:1})])):b("",!0)]),n(ze,{modelValue:g.downloaderIds,"onUpdate:modelValue":e[9]||(e[9]=a=>g.downloaderIds=a)},{default:l(()=>[(u(!0),f(j,null,W(ne.value,a=>(u(),B(Ne,{key:a.id,label:a.id},{default:l(()=>[c(p(a.name),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"]),n(ke,{"content-position":"left"},{default:l(()=>[...e[35]||(e[35]=[c("保存路径",-1)])]),_:1}),s("div",Sa,[g.paths.length>0?(u(),f("div",ba,[n(i,{type:"info",size:"default",effect:"plain"},{default:l(()=>[c("路径: "+p(g.paths.length),1)]),_:1}),n(w,{type:"danger",link:"",style:{padding:"0","margin-left":"5px"},onClick:_t},{default:l(()=>[...e[36]||(e[36]=[c("清除",-1)])]),_:1})])):b("",!0)]),s("div",$a,[n(Nt,{ref_key:"pathTreeRef",ref:S,data:we.value,"show-checkbox":"","node-key":"path","default-expand-all":"","expand-on-click-node":!1,"check-on-click-node":"","check-strictly":!0,props:{class:"path-tree-node"}},null,8,["data"])]),n(ke,{"content-position":"left"},{default:l(()=>[...e[37]||(e[37]=[c("状态",-1)])]),_:1}),s("div",Ca,[g.states.length>0?(u(),f("div",Ia,[n(i,{type:"info",size:"default",effect:"plain"},{default:l(()=>[c("状态: "+p(g.states.length),1)]),_:1}),n(w,{type:"danger",link:"",style:{padding:"0","margin-left":"5px"},onClick:ht},{default:l(()=>[...e[38]||(e[38]=[c("清除",-1)])]),_:1})])):b("",!0)]),n(ze,{modelValue:g.states,"onUpdate:modelValue":e[10]||(e[10]=a=>g.states=a)},{default:l(()=>[(u(!0),f(j,null,W(he.value,a=>(u(),B(Ne,{key:a,label:a},{default:l(()=>[c(p(a),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),s("div",Da,[n(w,{onClick:ft},{default:l(()=>[...e[39]||(e[39]=[c("清除筛选",-1)])]),_:1}),n(w,{onClick:e[11]||(e[11]=a=>G.value=!1)},{default:l(()=>[...e[40]||(e[40]=[c("取消",-1)])]),_:1}),n(w,{type:"primary",onClick:vt},{default:l(()=>[...e[41]||(e[41]=[c("确认",-1)])]),_:1})])]),_:1})])):b("",!0),h.value?(u(),f("div",{key:5,class:"filter-overlay",onClick:e[16]||(e[16]=H(a=>h.value=!1,["self"]))},[n(le,{class:"filter-card",style:{"max-width":"500px"}},{header:l(()=>[s("div",Na,[e[43]||(e[43]=s("span",null,"站点操作",-1)),n(w,{type:"danger",circle:"",onClick:e[13]||(e[13]=a=>h.value=!1),plain:""},{default:l(()=>[...e[42]||(e[42]=[c("X",-1)])]),_:1})])]),default:l(()=>[s("div",za,[s("div",Ta,[e[44]||(e[44]=s("p",{class:"label"},"种子名称:",-1)),s("p",Va,p(A.value),1)]),s("p",null,"站点名称: "+p(z.value?.name),1),s("p",null,"当前状态: "+p(z.value?.data.state),1),z.value&&z.value.data&&me(z.value.data,z.value.name)?(u(),f("div",Ea,[e[45]||(e[45]=s("p",{class:"label"},"详情页链接:",-1)),n(zt,{href:Ce(z.value.data,z.value.name),target:"_blank",type:"primary",underline:!1},{default:l(()=>[c(p(Ce(z.value.data,z.value.name)),1)]),_:1},8,["href"])])):(u(),f("div",Ua,[e[46]||(e[46]=s("p",{class:"label"},"添加详情页链接或种子ID:",-1)),n(C,{modelValue:J.value,"onUpdate:modelValue":e[14]||(e[14]=a=>J.value=a),placeholder:"请输入完整的详情页链接或种子ID",clearable:"",onKeyup:Kt(Oe,["enter"])},null,8,["modelValue"]),e[47]||(e[47]=s("p",{class:"input-hint"}," 支持输入完整链接（如：https://example.com/details.php?id=123）或仅输入数字ID（如：9999999996） ",-1))])),s("div",Ma,[n(w,{onClick:e[15]||(e[15]=a=>h.value=!1)},{default:l(()=>[...e[48]||(e[48]=[c("取消",-1)])]),_:1}),me(z.value?.data,z.value?.name)?b("",!0):(u(),B(w,{key:0,type:"success",onClick:Oe,disabled:!J.value||J.value.trim()===""},{default:l(()=>[...e[49]||(e[49]=[c(" 添加链接 ",-1)])]),_:1},8,["disabled"])),me(z.value?.data,z.value?.name)?(u(),B(w,{key:1,type:"primary",onClick:ot},{default:l(()=>[...e[50]||(e[50]=[c(" 设为不存在 ",-1)])]),_:1})):b("",!0)])])]),_:1})])):b("",!0),se.value?(u(),f("div",Ra,[n(le,{class:"filter-card",style:{"max-width":"600px"}},{header:l(()=>[s("div",Ba,[e[52]||(e[52]=s("span",null,"请选择转种的源站点",-1)),n(w,{type:"danger",circle:"",onClick:e[17]||(e[17]=a=>se.value=!1),plain:""},{default:l(()=>[...e[51]||(e[51]=[c("X",-1)])]),_:1})])]),default:l(()=>[s("div",Oa,[s("p",Pa,[n(i,{type:"success",size:"large",style:{"margin-right":"5px"}},{default:l(()=>[...e[53]||(e[53]=[c("可获取数据",-1)])]),_:1}),n(i,{type:"primary",size:"large",style:{"margin-right":"5px"}},{default:l(()=>[...e[54]||(e[54]=[c("点击尝试使用iyuu获取链接",-1)])]),_:1}),n(i,{type:"error",size:"large",style:{"margin-right":"5px",opacity:"0.5"}},{default:l(()=>[...e[55]||(e[55]=[c("缺少配置参数",-1)])]),_:1})]),y.value.length>0?(u(),f("div",Fa,[s("p",La,"已缓存的站点 ("+p(y.value.length)+")",1),s("div",ja,[(u(!0),f(j,null,W(r.value.filter(a=>y.value.includes(a.name)),a=>Ve((u(),B(i,{key:a.name,type:Le(a,de(a.name)),class:X([{"is-selectable":de(a.name),"cached-site-tag":!0},"site-tag"]),onClick:x=>de(a.name)&&Me(Pe(a.name)),"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.5)"},{default:l(()=>[c(p(a.name)+" ✓ ",1)]),_:2},1032,["type","class","onClick"])),[[Te,xe.value[a.name]]])),128))])])):b("",!0),r.value.some(a=>!y.value.includes(a.name))?(u(),f("div",Ka,[e[56]||(e[56]=s("p",{class:"uncached-sites-label"},"未缓存的站点",-1)),s("div",qa,[(u(!0),f(j,null,W(r.value.filter(a=>!y.value.includes(a.name)),a=>Ve((u(),B(i,{key:a.name,type:Le(a,de(a.name)),class:X([{"is-selectable":de(a.name)},"site-tag"]),style:At(!a.has_cookie||a.name==="杜比"&&!a.has_passkey?"opacity: 0.5":""),size:"large",onClick:x=>de(a.name)&&Me(Pe(a.name)),"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.5)"},{default:l(()=>[c(p(a.name),1)]),_:2},1032,["type","class","style","onClick"])),[[Te,xe.value[a.name]]])),128))])])):b("",!0)]),s("div",Aa,[n(w,{type:"warning",onClick:Fe,loading:d.value,plain:""},{default:l(()=>[...e[57]||(e[57]=[c("IYUU查询",-1)])]),_:1},8,["loading"]),n(w,{type:"success",onClick:e[18]||(e[18]=a=>at(U.value)),plain:""},{default:l(()=>[...e[58]||(e[58]=[c("上盒",-1)])]),_:1}),n(w,{onClick:e[19]||(e[19]=a=>se.value=!1)},{default:l(()=>[...e[59]||(e[59]=[c("取消",-1)])]),_:1})])]),_:1})])):b("",!0),n(qs,{onRefresh:lt})])}}}),Xa=Je(Ya,[["__scopeId","data-v-82cef57e"]]);export{Xa as default};
