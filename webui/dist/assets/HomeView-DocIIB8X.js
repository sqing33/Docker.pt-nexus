import{d as T,r as b,c as g,o as q,a as l,b as I,e as d,w as c,f as _,g as y,E as k,h as o,_ as z,i as e,j as r,k as v,F as w,l as x,n as S,t as i,m as P,p as A}from"./index-g-1vxImM.js";const D={class:"home-container"},F={class:"site-grid"},H={class:"site-content"},M={class:"site-name-container"},j={class:"site-name"},Q={class:"site-roles"},R={key:0,class:"role-tag role-both"},G={key:1,class:"role-tag role-source"},J={key:2,class:"role-tag role-target"},K={key:0,class:"empty-placeholder"},O={class:"downloader-grid"},U={class:"downloader-header"},W={class:"downloader-name"},X={key:0,class:"downloader-details"},Y={class:"detail-row"},Z={class:"detail-value"},$={class:"detail-row"},ss={class:"detail-value"},es={class:"detail-row"},ts={class:"detail-value"},as={class:"detail-row"},os={class:"detail-value"},ls={class:"detail-row"},ns={class:"detail-value"},is={key:1,class:"downloader-disabled"},rs={key:0,class:"empty-downloader-placeholder"},cs=T({__name:"HomeView",setup(ds){const u=b([]),p=b([]),N=g(()=>u.value.filter(t=>t.is_source)),B=g(()=>u.value.filter(t=>t.is_target)),m=g(()=>{const t=new Map;return N.value.forEach(s=>{t.set(s.name,{...s,is_source:!0,is_target:!1})}),B.value.forEach(s=>{if(t.has(s.name)){const n=t.get(s.name);t.set(s.name,{...n,...s,is_source:!0,is_target:!0,has_cookie:n.has_cookie||s.has_cookie})}else t.set(s.name,{...s,is_source:!1,is_target:!0})}),Array.from(t.values()).sort((s,n)=>s.is_source&&s.is_target?-1:n.is_source&&n.is_target?1:s.is_source&&!n.is_source?-1:!s.is_source&&n.is_source?1:0)}),C=t=>{let s=!1;return(t.is_source&&!t.is_target||!t.is_source&&t.is_target||t.is_source&&t.is_target)&&(s=t.has_cookie),{"site-configured":s,"site-unconfigured":!s}},V=async()=>{try{const t=await y.get("/api/sites/status");u.value=t.data}catch{k.error({title:"错误",message:"无法从服务器获取站点状态列表"})}},f=async()=>{try{const t=await y.get("/api/downloader_info");p.value=t.data}catch(t){console.error("获取下载器信息失败:",t),k.error({title:"错误",message:"无法从服务器获取下载器信息"})}};return q(()=>{V(),f(),setInterval(()=>{f()},3e4)}),(t,s)=>{const n=_("el-card"),h=_("el-tag"),E=_("el-col"),L=_("el-row");return o(),l("div",D,[s[7]||(s[7]=I('<div class="warning-banner" data-v-cbde5deb><div class="warning-content" data-v-cbde5deb><img src="'+z+'" alt="PT Nexus Logo" class="warning-icon" data-v-cbde5deb><div class="text-container" data-v-cbde5deb><div class="marquee-container" data-v-cbde5deb><div class="marquee-content" data-v-cbde5deb><span class="warning-text" data-v-cbde5deb>重要提示：PT Nexus 仅作为转种辅助工具，无法保证 100% 准确性。转种前请务必仔细检查预览信息，确认参数正确无误。转种后请及时核实种子信息，如有错误请立即修改并反馈 bug。因使用本工具产生的种子错误问题，需由使用者自行修改，如不修改则本工具不承担任何责任。</span><span class="warning-text" data-v-cbde5deb>重要提示：PT Nexus 仅作为转种辅助工具，无法保证 100% 准确性。转种前请务必仔细检查预览信息，确认参数正确无误。转种后请及时核实种子信息，如有错误请立即修改并反馈 bug。因使用本工具产生的种子错误问题，需由使用者自行修改，如不修改则本工具不承担任何责任。</span></div></div></div></div></div>',1)),d(n,{class:"site-card"},{header:c(()=>[...s[0]||(s[0]=[e("div",{class:"site-card-header"},[e("span",{class:"site-card-title"},"站点支持列表"),e("div",{class:"site-legend"},[e("span",{class:"legend-item"},[e("span",{class:"legend-dot legend-dot-success"}),r(" 配置完整 ")]),e("span",{class:"legend-item"},[e("span",{class:"legend-dot legend-dot-primary"}),r(" 配置不完整 ")])])],-1)])]),default:c(()=>[s[1]||(s[1]=e("div",{class:"combined-legend"},[e("span",{class:"role-legend-item"},[e("span",{class:"role-tag role-source"},"源"),r(" 源站点 ")]),e("span",{class:"role-legend-item"},[e("span",{class:"role-tag role-target"},"目标"),r(" 目标站点 ")]),e("span",{class:"role-legend-item"},[e("span",{class:"role-tag role-both"},"源/目标"),r(" 同时支持源和目标 ")])],-1)),e("div",F,[(o(!0),l(w,null,x(m.value,a=>(o(),l("div",{key:a.name,class:S(["site-item",C(a)])},[e("div",H,[e("div",M,[e("span",j,i(a.name),1)])]),e("div",Q,[a.is_source&&a.is_target?(o(),l("span",R,"源/目标")):a.is_source?(o(),l("span",G,"源")):a.is_target?(o(),l("span",J,"目标")):v("",!0)])],2))),128)),m.value.length?v("",!0):(o(),l("div",K,"加载中..."))])]),_:1}),d(L,{gutter:24,style:{"margin-top":"24px"}},{default:c(()=>[d(E,{span:24},{default:c(()=>[e("div",O,[(o(!0),l(w,null,x(p.value,a=>(o(),P(n,{key:a.name,class:S(["downloader-card glass-card glass-rounded",{disabled:!a.enabled}])},{default:c(()=>[e("div",U,[e("div",W,[d(h,{type:a.enabled?"success":"info",effect:"dark",size:"small"},{default:c(()=>[r(i(a.type==="qbittorrent"?"QB":"TR"),1)]),_:2},1032,["type"]),r(" "+i(a.name),1)]),d(h,{type:a.status==="已连接"?"success":"danger",size:"small"},{default:c(()=>[r(i(a.status),1)]),_:2},1032,["type"])]),a.enabled?(o(),l("div",X,[e("div",Y,[s[2]||(s[2]=e("span",{class:"detail-label"},"版本:",-1)),e("span",Z,i(a.details?.版本||"N/A"),1)]),e("div",$,[s[3]||(s[3]=e("span",{class:"detail-label"},"今日上传:",-1)),e("span",ss,i(a.details?.今日上传量||"0 B"),1)]),e("div",es,[s[4]||(s[4]=e("span",{class:"detail-label"},"今日下载:",-1)),e("span",ts,i(a.details?.今日下载量||"0 B"),1)]),e("div",as,[s[5]||(s[5]=e("span",{class:"detail-label"},"累计上传:",-1)),e("span",os,i(a.details?.累计上传量||"0 B"),1)]),e("div",ls,[s[6]||(s[6]=e("span",{class:"detail-label"},"累计下载:",-1)),e("span",ns,i(a.details?.累计下载量||"0 B"),1)])])):(o(),l("div",is,"下载器已禁用"))]),_:2},1032,["class"]))),128)),p.value.length?v("",!0):(o(),l("div",rs," 暂无下载器配置 "))])]),_:1})]),_:1})])}}}),us=A(cs,[["__scopeId","data-v-cbde5deb"]]);export{us as default};
