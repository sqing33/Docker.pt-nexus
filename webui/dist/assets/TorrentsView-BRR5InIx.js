import{d as St,r as p,C as Le,c as E,o as bt,D as Ct,a as v,m as C,k as w,u as me,v as It,w as a,e as n,f as k,G as R,g as V,i,F as D,l as j,t as f,j as r,H as zt,z as _,q as $t,h as d,n as ge,B as Nt,p as Ut}from"./index-BpGjWZu3.js";import{u as Et,C as Vt}from"./CrossSeedPanel-CzvFq3Iz.js";const Dt={class:"torrents-view"},Tt={class:"expand-content"},Ft=["onClick"],Pt=["href"],Lt=["onClick"],Mt={class:"name-header-container"},Bt={key:0,class:"current-filters",style:{"margin-right":"15px",display:"flex","align-items":"center"}},Ot={style:{"white-space":"normal"}},Rt={style:{display:"inline-block",width:"100%","text-align":"center"}},jt=["title"],qt={style:{display:"flex","justify-content":"center","align-items":"center",width:"100%",height:"100%"}},Kt={key:0},Yt={style:{padding:"1px 0",width:"100%"}},At={style:{"text-align":"center","font-size":"12px","margin-top":"5px","line-height":"1"}},Jt={style:{display:"flex","justify-content":"center","align-items":"center",width:"100%",height:"100%"}},Wt={style:{display:"flex","justify-content":"center","align-items":"center",width:"100%",height:"100%"}},Xt={key:0},Qt={key:1},Gt={style:{display:"flex","justify-content":"center","align-items":"center",width:"100%",height:"100%"}},Ht={key:3,class:"modal-overlay"},Zt={class:"modal-header"},es={key:0,class:"cross-seed-content"},ts={class:"filter-card-header"},ss={class:"filter-card-body"},ls={class:"site-filter-container"},as={style:{display:"flex","align-items":"center",gap:"15px","margin-bottom":"5px"}},ns={style:{display:"flex","align-items":"center",gap:"10px"}},os={key:0,style:{display:"flex","align-items":"center"}},is={key:1,style:{display:"flex","align-items":"center"}},rs={class:"site-checkbox-container"},ds={style:{"margin-bottom":"10px"}},us={key:0,style:{display:"flex","align-items":"center"}},cs={style:{"margin-bottom":"10px"}},ps={key:0,style:{display:"flex","align-items":"center"}},fs={class:"path-tree-container"},vs={style:{"margin-bottom":"10px"}},ms={key:0,style:{display:"flex","align-items":"center"}},gs={class:"filter-card-footer"},ys={class:"filter-card-header"},hs={class:"site-operation-body"},_s={class:"torrent-name-container"},xs={class:"torrent-name"},ws={key:0,class:"site-operation-link"},ks={key:1,class:"site-operation-input"},Ss={class:"site-operation-buttons"},bs={key:6,class:"filter-overlay"},Cs={class:"filter-card-header"},Is={class:"source-site-selection-body"},zs={class:"source-site-tip"},$s={key:0,class:"cached-sites-section"},Ns={class:"cached-sites-label"},Us={class:"site-list-box glass-site-box cached-sites-box"},Es={key:1,class:"uncached-sites-section"},Vs={class:"site-list-box glass-site-box"},Ds={class:"filter-card-footer"},Ts=St({__name:"TorrentsView",emits:["ready"],setup(Fs,{emit:Me}){const Be=Me,ye=p(null),te=p(!0),se=p([]),q=p(null),he=p(!1),P=p(""),L=p({prop:"name",order:"ascending"}),y=Le({paths:[],states:[],existSiteNames:[],notExistSiteNames:[],downloaderIds:[]}),c=Le({...y}),$=p("exist"),_e=E({get:()=>$.value==="exist"?c.existSiteNames:c.notExistSiteNames,set:t=>{$.value==="exist"?c.existSiteNames=t:c.notExistSiteNames=t}}),K=p(!1),N=p(1),T=p(50),le=p(0),Oe=p([]),xe=p([]),we=p([]),ae=p({}),ke=p([]),Se=p([]),ne=p([]),S=p(null),be=p([]),Q=p(!1),Y=p([]),oe=p(!1),F=p([]),Ce=p(!1),I=Et(),Re=E(()=>!!I.taskId),z=E(()=>I.workingParams);E(()=>I.sourceInfo?.name||"");const M=p(!1),A=p(""),x=p(null),U=p(""),Z=p({}),ie=E(()=>{const t=new Intl.Collator("zh-CN",{numeric:!0});return[...we.value].sort(t.compare)}),J=p(""),Ie=E(()=>{if(!J.value)return ie.value;const t=J.value.toLowerCase();return ie.value.filter(e=>e.toLowerCase().includes(t))}),je=E(()=>{const t=y,e=[];return t.paths&&t.paths.length>0&&e.push(`路径: ${t.paths.length}`),t.states&&t.states.length>0&&e.push(`状态: ${t.states.length}`),t.existSiteNames&&t.existSiteNames.length>0&&e.push(`存在于: ${t.existSiteNames.length}`),t.notExistSiteNames&&t.notExistSiteNames.length>0&&e.push(`不存在于: ${t.notExistSiteNames.length}`),t.downloaderIds&&t.downloaderIds.length>0&&e.push(`下载器: ${t.downloaderIds.length}`),e.join(", ")}),qe=E(()=>{const t=y;return t.paths&&t.paths.length>0||t.states&&t.states.length>0||t.existSiteNames&&t.existSiteNames.length>0||t.notExistSiteNames&&t.notExistSiteNames.length>0||t.downloaderIds&&t.downloaderIds.length>0});E(()=>{const t=Ie.value;return $.value==="exist"?t.filter(e=>!c.notExistSiteNames.includes(e)):t.filter(e=>!c.existSiteNames.includes(e))});const ze=t=>$.value==="exist"?!c.notExistSiteNames.includes(t):!c.existSiteNames.includes(t),Ke=[{color:"#f56c6c",percentage:80},{color:"#e6a23c",percentage:99},{color:"#67c23a",percentage:100}],G=async()=>{try{const t={page_size:T.value,sort_prop:L.value.prop,sort_order:L.value.order,name_search:P.value,active_filters:y};await V.post("/api/ui_settings",t)}catch(t){console.error("无法保存UI设置:",t.message)}},Ye=async()=>{try{const e=(await V.get("/api/ui_settings")).data;if(T.value=e.page_size??50,L.value={prop:e.sort_prop||"name",order:"sort_order"in e?e.sort_order:"ascending"},P.value=e.name_search??"",e.active_filters){Object.assign(y,e.active_filters),y.existSiteNames||(y.existSiteNames=[]),y.notExistSiteNames||(y.notExistSiteNames=[]);const l=y;l.siteExistence&&delete l.siteExistence,l.siteNames&&delete l.siteNames}}catch(t){console.error("加载UI设置时出错:",t)}finally{he.value=!0}},Ae=t=>{const e=[],l=new Map;return t.sort().forEach(o=>{const u=o.replace(/^\/|\/$/g,"").split("/");let h="",g=e;u.forEach((B,X)=>{if(h=X===0?`/${B}`:`${h}/${B}`,!l.has(h)){const O={path:X===u.length-1?o:h,label:B,children:[]};l.set(h,O),g.push(O)}g=l.get(h).children})}),l.forEach(o=>{o.children&&o.children.length===0&&delete o.children}),e},Je=async()=>{try{const e=(await V.get("/api/all_downloaders")).data;Se.value=e.filter(l=>l.enabled),ne.value=e}catch(t){q.value=t.message}},We=async()=>{try{const e=(await V.get("/api/sites/status")).data;Y.value=e.filter(l=>l.is_source)}catch(t){q.value=t.message}},b=async()=>{te.value=!0,q.value=null;try{const t=new URLSearchParams({page:N.value.toString(),pageSize:T.value.toString(),nameSearch:P.value,sortProp:L.value.prop||"name",sortOrder:L.value.order||"ascending",existSiteNames:JSON.stringify(y.existSiteNames),notExistSiteNames:JSON.stringify(y.notExistSiteNames),path_filters:JSON.stringify(y.paths||[]),state_filters:JSON.stringify(y.states),downloader_filters:JSON.stringify(y.downloaderIds)}),l=(await V.get(`/api/data?${t.toString()}`)).data;if(l.error)throw new Error(l.error);se.value=l.data,le.value=l.total,T.value!==l.pageSize&&(T.value=l.pageSize),Oe.value=l.unique_paths,xe.value=l.unique_states,we.value=l.all_discovered_sites,ae.value=l.site_link_rules,y.paths=l.active_path_filters,be.value=Ae(l.unique_paths)}catch(t){q.value=t.message}finally{te.value=!1}},Xe=async t=>{I.reset();const e=Object.entries(t.sites).map(([l,o])=>({siteName:l,...o})).filter(l=>{if(!(l.migration===1||l.migration===3))return!1;const u=l.comment&&l.comment.includes("details.php?id="),h=l.comment&&/^\d+$/.test(l.comment.trim());return u||h});I.setParams(t),await Qe(t),e.length===0&&_.warning("该种子暂无可用的源站点，您可以使用 IYUU 查询来发现更多站点。"),Q.value=!0},Qe=async t=>{Ce.value=!0,F.value=[];try{const l=(await V.get(`/api/cached_sites?name=${encodeURIComponent(t.name)}&size=${t.size}`)).data;l.success?(F.value=l.cached_sites||[],console.log("缓存站点查询结果:",F.value)):console.warn("查询缓存站点失败:",l.error)}catch(e){console.error("查询缓存站点时出错:",e)}finally{Ce.value=!1}},$e=async t=>{const e=z.value;if(!e||!t){_.error("发生内部错误：未找到选中的种子或站点信息。");return}const l=e.sites[t.siteName],o=t.siteName;if(!l){_.error(`未找到站点 [${o}] 的数据。`);return}if(!H(l,o)){_.info(`站点 [${o}] 缺少详情链接，正在触发 IYUU 查询...`),Z.value[o]=!0,await De(),Z.value[o]=!1;return}let u=null;const h=l?.comment?.match(/id=(\d+)/);if(h&&h[1])u=h[1];else if(l?.comment&&/^\d+$/.test(l.comment.trim()))u=l.comment.trim();else{_.error(`无法从源站点 ${o} 的详情页链接中提取种子ID。请尝试使用IYUU查询更新链接。`);return}l&&(l.torrentId=u);const g=Y.value.find(X=>X.name===o)?.site||o.toLowerCase();_.success(`准备从站点 [${o}] 开始迁移种子...`);const B={name:o,site:g,torrentId:u};I.setSourceInfo(B),I.setTaskId(e.name+"_"+Date.now()),Q.value=!1},W=t=>{if(!!!(z.value&&z.value.sites[t]))return!1;const l=Y.value.find(o=>o.name===t);return!l||!l.has_cookie?!1:t==="杜比"||t==="HDtime"?!!l.has_passkey:!0},Ne=()=>{I.reset()},Ue=(t,e)=>{A.value=t,x.value=e,U.value="",M.value=!0},Ee=async()=>{if(!A.value||!x.value){_.error("缺少必要的参数");return}if(!U.value||U.value.trim()===""){_.error("请输入详情页链接或ID");return}try{const e=(await V.post("/api/sites/update_comment",{torrent_name:A.value,site_name:x.value.name,comment:U.value.trim()})).data;e.success?(_.success("详情页链接已成功添加"),M.value=!1,U.value="",await b()):_.error(e.error||"添加详情页链接失败")}catch(t){console.error("添加详情页链接时出错:",t),_.error("添加详情页链接时发生网络错误")}},Ge=async()=>{if(!A.value||!x.value){_.error("缺少必要的参数");return}try{const t=await V.post("/api/sites/set_not_exist",{torrent_name:A.value,site_name:x.value.name});_.success("站点状态已成功设置为不存在"),M.value=!1,b()}catch(t){console.error("设置站点状态时出错:",t),_.error(t.response?.data?.error||"设置站点状态时发生错误")}},He=()=>{_.success("转种操作已完成！"),I.reset(),b()},Ze=()=>{_.success("转种操作已完成！"),I.reset(),b()},Ve=t=>{if(!z.value)return null;const e=z.value.sites[t];return e?{siteName:t,...e}:null},De=async()=>{const t=z.value;if(!t){_.error("未找到选中的种子信息");return}oe.value=!0;try{const l=(await V.post("/api/iyuu_query",{name:t.name,size:t.size})).data;if(l.success){_.success(l.message||"IYUU查询已完成"),await b();const o=se.value.find(u=>u.name===t.name&&u.size===t.size);o&&I.setParams(o)}else _.error(l.error||"IYUU查询失败")}catch(e){console.error("触发IYUU查询时出错:",e),_.error(e.response?.data?.error||"触发IYUU查询时发生网络错误")}finally{oe.value=!1}},et=t=>{T.value=t,N.value=1,b(),G()},tt=t=>{N.value=t,b()},st=t=>{L.value=t,N.value=1,b(),G()},lt=()=>{Object.assign(c,y),K.value=!0,$t(()=>{S.value&&S.value.setCheckedKeys(y.paths,!1)})},at=async()=>{if(S.value){const t=S.value.getCheckedKeys(!1);c.paths=t}Object.assign(y,c),K.value=!1,N.value=1,await b(),G()},nt=()=>{c.paths=[],c.states=[],c.existSiteNames=[],c.notExistSiteNames=[],c.downloaderIds=[],$.value="exist",J.value="",S.value&&S.value.setCheckedKeys([],!1)},ot=()=>{if(c.existSiteNames=[],$.value==="exist"&&S.value){const t=S.value.getCheckedKeys(!0);c.paths=t}},it=()=>{if(c.notExistSiteNames=[],$.value==="not-exist"&&S.value){const t=S.value.getCheckedKeys(!0);c.paths=t}},rt=()=>{c.paths=[],S.value&&S.value.setCheckedKeys([],!1)},dt=()=>{c.states=[]},ut=()=>{c.downloaderIds=[]},ct=async()=>{y.paths=[],y.states=[],y.existSiteNames=[],y.notExistSiteNames=[],y.downloaderIds=[],P.value="",$.value="exist",J.value="",S.value&&S.value.setCheckedKeys([],!1),N.value=1,await b(),G()},re=t=>{if(t==null||t<=0)return"0 B";const e=["B","KB","MB","GB","TB","PB"],l=Math.floor(Math.log(t)/Math.log(1024));return`${(t/Math.pow(1024,l)).toFixed(2)} ${e[l]}`},H=(t,e)=>{const{comment:l}=t;return!!(l&&(l.startsWith("http")||/^\d+$/.test(l)&&ae.value[e]))},de=(t,e)=>{const{comment:l}=t;if(l.startsWith("http"))return l;const o=ae.value[e];return o&&/^\d+$/.test(l)?`${(o.base_url.startsWith("http")?o.base_url:`https://${o.base_url}`).replace(/\/$/,"")}/details.php?id=${l}`:null},ue=t=>t.state==="未做种"?"danger":t.state==="不存在"?"info":t.comment?"success":t.state==="做种中"?"primary":"info",ce=t=>{if(!t)return"未知下载器";const e=ne.value.find(l=>l.id===t);return e?e.name:"未知下载器"},pt=t=>{if(!t||!ne.value.find(u=>u.id===t))return"info";let l=0;for(let u=0;u<t.length;u++)l=t.charCodeAt(u)+((l<<5)-l);const o=["primary","success","warning","danger","info"];return o[Math.abs(l)%o.length]},ft=t=>[...t].sort((l,o)=>{const u=ce(l),h=ce(o);return u.localeCompare(h,"zh-CN")}),vt=(t,e=50)=>{if(!t||t.length<=e)return t;const l=Math.floor((e-3)/2);let o=t.substring(0,l),u=t.substring(t.length-l);const h=o.lastIndexOf("/"),g=u.indexOf("/");return h>0&&g>=0&&(o=o.substring(0,h),u=u.substring(g+1)),`${o}...${u}`},Te=(t,e)=>{if(!!!(z.value&&z.value.sites[t.name]))return"info";const o=z.value.sites[t.name];return!t.has_cookie||t.name==="杜比"&&!t.has_passkey?"error":t.has_cookie&&o.comment?"success":"primary"},mt=t=>t.includes("下载")?"primary":t.includes("做种")?"success":t.includes("暂停")?"warning":t.includes("错误")||t.includes("丢失")?"danger":"info",gt=t=>ye.value?.toggleRowExpansion(t),yt=(t,e)=>{ke.value=e.map(l=>l.unique_id)},ht=({row:t})=>ke.value.includes(t.unique_id)?"expanded-row":"";return bt(async()=>{await Ye(),b(),Je(),We(),Be("ready",b)}),Ct(P,()=>{N.value=1,b(),G()}),(t,e)=>{const l=k("el-alert"),o=k("el-tag"),u=k("el-table-column"),h=k("el-input"),g=k("el-button"),B=k("el-progress"),X=k("el-table"),Fe=k("el-pagination"),O=k("el-card"),ee=k("el-divider"),Pe=k("el-radio-button"),_t=k("el-radio-group"),pe=k("el-checkbox"),fe=k("el-checkbox-group"),xt=k("el-tree"),wt=k("el-link"),ve=It("loading");return d(),v("div",Dt,[q.value?(d(),C(l,{key:0,title:q.value,type:"error","show-icon":"",closable:!1,center:"",style:{"margin-bottom":"15px"}},null,8,["title"])):w("",!0),he.value?me((d(),C(X,{key:1,data:se.value,border:"",height:"100%",ref_key:"tableRef",ref:ye,"row-key":"unique_id","row-class-name":ht,onRowClick:gt,onExpandChange:yt,onSortChange:st,"default-sort":L.value,"empty-text":"无数据或当前筛选条件下无结果",class:"glass-table"},{default:a(()=>[n(u,{type:"expand",width:"1"},{default:a(s=>[i("div",Tt,[(d(!0),v(D,null,j(ie.value,m=>(d(),v(D,{key:m},[s.row.sites[m]?(d(),v(D,{key:0},[s.row.sites[m].state==="未做种"?(d(),v("div",{key:0,style:{cursor:"pointer",display:"inline-block",width:"100%","text-align":"center"},onClick:R(kt=>Ue(s.row.name,{name:m,data:s.row.sites[m]}),["stop"])},[n(o,{effect:"dark",type:ue(s.row.sites[m]),style:{"text-align":"center",width:"100%"}},{default:a(()=>[r(f(m)+" ",1),i("div",null,"("+f(re(s.row.sites[m].uploaded))+")",1)]),_:2},1032,["type"])],8,Ft)):s.row.sites[m]&&H(s.row.sites[m],m)?(d(),v("a",{key:1,href:de(s.row.sites[m],m),target:"_blank",style:{"text-decoration":"none"}},[n(o,{effect:"dark",type:ue(s.row.sites[m]),style:{"text-align":"center"}},{default:a(()=>[r(f(m)+" ",1),i("div",null,"("+f(re(s.row.sites[m].uploaded))+")",1)]),_:2},1032,["type"])],8,Pt)):(d(),v("div",{key:2,style:{cursor:"pointer",display:"inline-block",width:"100%","text-align":"center"},onClick:R(kt=>Ue(s.row.name,{name:m,data:s.row.sites[m]}),["stop"])},[n(o,{effect:"dark",type:ue(s.row.sites[m]),style:{"text-align":"center",width:"100%"}},{default:a(()=>[r(f(m)+" ",1),i("div",null,"("+f(re(s.row.sites[m].uploaded))+")",1)]),_:2},1032,["type"])],8,Lt))],64)):(d(),C(o,{key:1,type:"info",effect:"plain"},{default:a(()=>[r(f(m),1)]),_:2},1024))],64))),128))])]),_:1}),n(u,{prop:"name","min-width":"450",sortable:"custom"},{header:a(()=>[i("div",Mt,[e[21]||(e[21]=i("div",null,"种子名称",-1)),n(h,{modelValue:P.value,"onUpdate:modelValue":e[0]||(e[0]=s=>P.value=s),placeholder:"搜索名称...",clearable:"",class:"search-input",onClick:e[1]||(e[1]=R(()=>{},["stop"]))},null,8,["modelValue"]),i("span",{onClick:e[2]||(e[2]=R(()=>{},["stop"])),style:{display:"flex","align-items":"center"}},[qe.value?(d(),v("div",Bt,[n(o,{type:"info",size:"default",effect:"plain"},{default:a(()=>[r(f(je.value),1)]),_:1}),n(g,{type:"danger",link:"",style:{padding:"0","margin-left":"8px"},onClick:ct},{default:a(()=>[...e[19]||(e[19]=[r("清除",-1)])]),_:1})])):w("",!0),n(g,{type:"primary",onClick:lt,plain:""},{default:a(()=>[...e[20]||(e[20]=[r("筛选",-1)])]),_:1})])])]),default:a(s=>[i("span",Ot,f(s.row.name),1)]),_:1}),n(u,{prop:"site_count",label:"做种数",sortable:"custom",width:"95",align:"center","header-align":"center"},{default:a(s=>[i("span",Rt,f(s.row.site_count)+" / "+f(s.row.total_site_count),1)]),_:1}),n(u,{prop:"save_path",label:"保存路径",width:"220","header-align":"center"},{default:a(s=>[i("div",{title:s.row.save_path,style:{width:"100%",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},f(vt(s.row.save_path,30)),9,jt)]),_:1}),n(u,{label:"下载器",width:"120",align:"center","header-align":"center"},{default:a(s=>[i("div",qt,[s.row.downloaderIds&&s.row.downloaderIds.length>0?(d(),v("div",Kt,[(d(!0),v(D,null,j(ft(s.row.downloaderIds),m=>(d(),C(o,{key:m,size:"small",type:pt(m),style:{margin:"2px"}},{default:a(()=>[r(f(ce(m)),1)]),_:2},1032,["type"]))),128))])):(d(),C(o,{key:1,type:"info",size:"small"},{default:a(()=>[...e[22]||(e[22]=[r(" 未知下载器 ",-1)])]),_:1}))])]),_:1}),n(u,{label:"大小",prop:"size_formatted",width:"100",align:"center",sortable:"custom"}),n(u,{label:"总上传量",prop:"total_uploaded_formatted",width:"110",align:"center",sortable:"custom"}),n(u,{label:"进度",prop:"progress",width:"120",align:"center",sortable:"custom"},{default:a(s=>[i("div",Yt,[n(B,{percentage:s.row.progress,"stroke-width":10,color:Ke,"show-text":!1,style:{width:"100%"}},null,8,["percentage"]),i("div",At,f(s.row.progress)+"% ",1)])]),_:1}),n(u,{label:"状态",prop:"state",width:"120",align:"center","header-align":"center"},{default:a(s=>[i("div",Jt,[n(o,{type:mt(s.row.state),size:"large"},{default:a(()=>[r(f(s.row.state),1)]),_:2},1032,["type"])])]),_:1}),n(u,{label:"可转种",width:"100",align:"center","header-align":"center",prop:"target_sites_count",sortable:"custom"},{default:a(s=>[i("div",Wt,[s.row.target_sites_count!==void 0?(d(),v("span",Xt,f(s.row.target_sites_count),1)):(d(),v("span",Qt,"-"))])]),_:1}),n(u,{label:"操作",width:"100",align:"center","header-align":"center"},{default:a(s=>[i("div",Gt,[n(g,{type:"primary",size:"small",onClick:R(m=>Xe(s.row),["stop"])},{default:a(()=>[...e[23]||(e[23]=[r(" 转种 ",-1)])]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data","default-sort"])),[[ve,te.value]]):w("",!0),le.value>0?(d(),C(Fe,{key:2,class:"glass-pagination",style:{"justify-content":"flex-end"},"current-page":N.value,"onUpdate:currentPage":e[3]||(e[3]=s=>N.value=s),"page-size":T.value,"onUpdate:pageSize":e[4]||(e[4]=s=>T.value=s),"page-sizes":[20,50,100],total:le.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:et,onCurrentChange:tt,background:""},null,8,["current-page","page-size","total"])):w("",!0),Re.value?(d(),v("div",Ht,[n(O,{class:"cross-seed-card",shadow:"always"},{header:a(()=>[i("div",Zt,[i("span",null,"转种 - "+f(z.value?.name),1),n(g,{type:"danger",circle:"",onClick:Ne,plain:""},{default:a(()=>[...e[24]||(e[24]=[r("X",-1)])]),_:1})])]),default:a(()=>[z.value?(d(),v("div",es,[n(Vt,{onComplete:He,onCancel:Ne,onCloseWithRefresh:Ze})])):w("",!0)]),_:1})])):w("",!0),K.value?(d(),v("div",{key:4,class:"filter-overlay",onClick:e[12]||(e[12]=R(s=>K.value=!1,["self"]))},[n(O,{class:"filter-card"},{header:a(()=>[i("div",ts,[e[26]||(e[26]=i("span",null,"筛选选项",-1)),n(g,{type:"danger",circle:"",onClick:e[5]||(e[5]=s=>K.value=!1),plain:""},{default:a(()=>[...e[25]||(e[25]=[r("X",-1)])]),_:1})])]),default:a(()=>[i("div",ss,[n(ee,{"content-position":"left"},{default:a(()=>[...e[27]||(e[27]=[r("站点筛选",-1)])]),_:1}),i("div",ls,[i("div",as,[n(_t,{modelValue:$.value,"onUpdate:modelValue":e[6]||(e[6]=s=>$.value=s),size:"default"},{default:a(()=>[n(Pe,{label:"exist",class:"compact-radio-button"},{default:a(()=>[...e[28]||(e[28]=[r("存在于",-1)])]),_:1}),n(Pe,{label:"not-exist",class:"compact-radio-button"},{default:a(()=>[...e[29]||(e[29]=[r("不存在于",-1)])]),_:1})]),_:1},8,["modelValue"]),n(h,{modelValue:J.value,"onUpdate:modelValue":e[7]||(e[7]=s=>J.value=s),placeholder:"搜索站点",clearable:"",style:{width:"280px","font-size":"14px"},size:"default"},null,8,["modelValue"]),i("div",ns,[c.existSiteNames.length>0?(d(),v("div",os,[n(o,{type:"info",size:"default",effect:"plain"},{default:a(()=>[r("存在于: "+f(c.existSiteNames.length),1)]),_:1}),n(g,{type:"danger",link:"",style:{padding:"0","margin-left":"5px"},onClick:ot},{default:a(()=>[...e[30]||(e[30]=[r("清除",-1)])]),_:1})])):w("",!0),c.notExistSiteNames.length>0?(d(),v("div",is,[n(o,{type:"info",size:"default",effect:"plain"},{default:a(()=>[r("不存在于: "+f(c.notExistSiteNames.length),1)]),_:1}),n(g,{type:"danger",link:"",style:{padding:"0","margin-left":"5px"},onClick:it},{default:a(()=>[...e[31]||(e[31]=[r("清除",-1)])]),_:1})])):w("",!0)])]),i("div",rs,[n(fe,{modelValue:_e.value,"onUpdate:modelValue":e[8]||(e[8]=s=>_e.value=s)},{default:a(()=>[(d(!0),v(D,null,j(Ie.value,s=>(d(),C(pe,{key:s,label:s,disabled:!ze(s),class:ge({"disabled-site":!ze(s)})},{default:a(()=>[r(f(s),1)]),_:2},1032,["label","disabled","class"]))),128))]),_:1},8,["modelValue"])])]),n(ee,{"content-position":"left"},{default:a(()=>[...e[32]||(e[32]=[r("下载器",-1)])]),_:1}),i("div",ds,[c.downloaderIds.length>0?(d(),v("div",us,[n(o,{type:"info",size:"default",effect:"plain"},{default:a(()=>[r("下载器: "+f(c.downloaderIds.length),1)]),_:1}),n(g,{type:"danger",link:"",style:{padding:"0","margin-left":"5px"},onClick:ut},{default:a(()=>[...e[33]||(e[33]=[r("清除",-1)])]),_:1})])):w("",!0)]),n(fe,{modelValue:c.downloaderIds,"onUpdate:modelValue":e[9]||(e[9]=s=>c.downloaderIds=s)},{default:a(()=>[(d(!0),v(D,null,j(Se.value,s=>(d(),C(pe,{key:s.id,label:s.id},{default:a(()=>[r(f(s.name),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"]),n(ee,{"content-position":"left"},{default:a(()=>[...e[34]||(e[34]=[r("保存路径",-1)])]),_:1}),i("div",cs,[c.paths.length>0?(d(),v("div",ps,[n(o,{type:"info",size:"default",effect:"plain"},{default:a(()=>[r("路径: "+f(c.paths.length),1)]),_:1}),n(g,{type:"danger",link:"",style:{padding:"0","margin-left":"5px"},onClick:rt},{default:a(()=>[...e[35]||(e[35]=[r("清除",-1)])]),_:1})])):w("",!0)]),i("div",fs,[n(xt,{ref_key:"pathTreeRef",ref:S,data:be.value,"show-checkbox":"","node-key":"path","default-expand-all":"","expand-on-click-node":!1,"check-on-click-node":"","check-strictly":!0,props:{class:"path-tree-node"}},null,8,["data"])]),n(ee,{"content-position":"left"},{default:a(()=>[...e[36]||(e[36]=[r("状态",-1)])]),_:1}),i("div",vs,[c.states.length>0?(d(),v("div",ms,[n(o,{type:"info",size:"default",effect:"plain"},{default:a(()=>[r("状态: "+f(c.states.length),1)]),_:1}),n(g,{type:"danger",link:"",style:{padding:"0","margin-left":"5px"},onClick:dt},{default:a(()=>[...e[37]||(e[37]=[r("清除",-1)])]),_:1})])):w("",!0)]),n(fe,{modelValue:c.states,"onUpdate:modelValue":e[10]||(e[10]=s=>c.states=s)},{default:a(()=>[(d(!0),v(D,null,j(xe.value,s=>(d(),C(pe,{key:s,label:s},{default:a(()=>[r(f(s),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),i("div",gs,[n(g,{onClick:nt},{default:a(()=>[...e[38]||(e[38]=[r("清除筛选",-1)])]),_:1}),n(g,{onClick:e[11]||(e[11]=s=>K.value=!1)},{default:a(()=>[...e[39]||(e[39]=[r("取消",-1)])]),_:1}),n(g,{type:"primary",onClick:at},{default:a(()=>[...e[40]||(e[40]=[r("确认",-1)])]),_:1})])]),_:1})])):w("",!0),M.value?(d(),v("div",{key:5,class:"filter-overlay",onClick:e[16]||(e[16]=R(s=>M.value=!1,["self"]))},[n(O,{class:"filter-card",style:{"max-width":"500px"}},{header:a(()=>[i("div",ys,[e[42]||(e[42]=i("span",null,"站点操作",-1)),n(g,{type:"danger",circle:"",onClick:e[13]||(e[13]=s=>M.value=!1),plain:""},{default:a(()=>[...e[41]||(e[41]=[r("X",-1)])]),_:1})])]),default:a(()=>[i("div",hs,[i("div",_s,[e[43]||(e[43]=i("p",{class:"label"},"种子名称:",-1)),i("p",xs,f(A.value),1)]),i("p",null,"站点名称: "+f(x.value?.name),1),i("p",null,"当前状态: "+f(x.value?.data.state),1),x.value&&x.value.data&&H(x.value.data,x.value.name)?(d(),v("div",ws,[e[44]||(e[44]=i("p",{class:"label"},"详情页链接:",-1)),n(wt,{href:de(x.value.data,x.value.name),target:"_blank",type:"primary",underline:!1},{default:a(()=>[r(f(de(x.value.data,x.value.name)),1)]),_:1},8,["href"])])):(d(),v("div",ks,[e[45]||(e[45]=i("p",{class:"label"},"添加详情页链接或种子ID:",-1)),n(h,{modelValue:U.value,"onUpdate:modelValue":e[14]||(e[14]=s=>U.value=s),placeholder:"请输入完整的详情页链接或种子ID",clearable:"",onKeyup:zt(Ee,["enter"])},null,8,["modelValue"]),e[46]||(e[46]=i("p",{class:"input-hint"}," 支持输入完整链接（如：https://example.com/details.php?id=123）或仅输入数字ID（如：123456） ",-1))])),i("div",Ss,[n(g,{onClick:e[15]||(e[15]=s=>M.value=!1)},{default:a(()=>[...e[47]||(e[47]=[r("取消",-1)])]),_:1}),H(x.value?.data,x.value?.name)?w("",!0):(d(),C(g,{key:0,type:"success",onClick:Ee,disabled:!U.value||U.value.trim()===""},{default:a(()=>[...e[48]||(e[48]=[r(" 添加链接 ",-1)])]),_:1},8,["disabled"])),H(x.value?.data,x.value?.name)?(d(),C(g,{key:1,type:"primary",onClick:Ge},{default:a(()=>[...e[49]||(e[49]=[r(" 设为不存在 ",-1)])]),_:1})):w("",!0)])])]),_:1})])):w("",!0),Q.value?(d(),v("div",bs,[n(O,{class:"filter-card",style:{"max-width":"600px"}},{header:a(()=>[i("div",Cs,[e[51]||(e[51]=i("span",null,"请选择转种的源站点",-1)),n(g,{type:"danger",circle:"",onClick:e[17]||(e[17]=s=>Q.value=!1),plain:""},{default:a(()=>[...e[50]||(e[50]=[r("X",-1)])]),_:1})])]),default:a(()=>[i("div",Is,[i("p",zs,[n(o,{type:"success",size:"large",style:{"margin-right":"5px"}},{default:a(()=>[...e[52]||(e[52]=[r("可获取数据",-1)])]),_:1}),n(o,{type:"primary",size:"large",style:{"margin-right":"5px"}},{default:a(()=>[...e[53]||(e[53]=[r("点击尝试使用iyuu获取链接",-1)])]),_:1}),n(o,{type:"error",size:"large",style:{"margin-right":"5px",opacity:"0.5"}},{default:a(()=>[...e[54]||(e[54]=[r("缺少配置参数",-1)])]),_:1})]),F.value.length>0?(d(),v("div",$s,[i("p",Ns,"已缓存的站点 ("+f(F.value.length)+")",1),i("div",Us,[(d(!0),v(D,null,j(Y.value.filter(s=>F.value.includes(s.name)),s=>me((d(),C(o,{key:s.name,type:Te(s,W(s.name)),class:ge([{"is-selectable":W(s.name),"cached-site-tag":!0},"site-tag"]),onClick:m=>W(s.name)&&$e(Ve(s.name)),"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.5)"},{default:a(()=>[r(f(s.name)+" ✓ ",1)]),_:2},1032,["type","class","onClick"])),[[ve,Z.value[s.name]]])),128))])])):w("",!0),Y.value.some(s=>!F.value.includes(s.name))?(d(),v("div",Es,[e[55]||(e[55]=i("p",{class:"uncached-sites-label"},"未缓存的站点",-1)),i("div",Vs,[(d(!0),v(D,null,j(Y.value.filter(s=>!F.value.includes(s.name)),s=>me((d(),C(o,{key:s.name,type:Te(s,W(s.name)),class:ge([{"is-selectable":W(s.name)},"site-tag"]),style:Nt(!s.has_cookie||s.name==="杜比"&&!s.has_passkey?"opacity: 0.5":""),size:"large",onClick:m=>W(s.name)&&$e(Ve(s.name)),"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.5)"},{default:a(()=>[r(f(s.name),1)]),_:2},1032,["type","class","style","onClick"])),[[ve,Z.value[s.name]]])),128))])])):w("",!0)]),i("div",Ds,[n(g,{type:"warning",onClick:De,loading:oe.value,plain:""},{default:a(()=>[...e[56]||(e[56]=[r("IYUU查询",-1)])]),_:1},8,["loading"]),n(g,{onClick:e[18]||(e[18]=s=>Q.value=!1)},{default:a(()=>[...e[57]||(e[57]=[r("取消",-1)])]),_:1})])]),_:1})])):w("",!0)])}}}),Ms=Ut(Ts,[["__scopeId","data-v-7bfd5d1f"]]);export{Ms as default};
