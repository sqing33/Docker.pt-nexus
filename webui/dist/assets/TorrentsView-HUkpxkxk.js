import{C as Mt,d as He,p as T,r as _,c as f,j as $,b as o,e as C,w as n,h as s,x as G,D as Pt,t as p,G as Rt,H as Lt,I as Ot,J as Bt,K as Ft,F as j,k as H,i as c,n as J,g as u,l as R,L as Q,M as jt,m as Je,N as Ke,o as At,f as q,O as Wt,u as Ve,v as Kt,P as qt,z as D,q as Yt,B as Ht}from"./index-D3C4dtEM.js";import{u as Jt,C as Xt}from"./CrossSeedPanel-or1L-M8P.js";const Xe=Mt("siteData",{state:()=>({dialogVisible:!1,currentTorrent:null,downloadersMap:new Map,allDownloaders:[]}),actions:{openDialog(Z,ee){this.currentTorrent=Z,this.dialogVisible=!0,this.allDownloaders=ee||[],this.downloadersMap.clear(),ee&&ee.forEach(te=>{this.downloadersMap.set(te.id,te.name)})},closeDialog(){this.dialogVisible=!1,this.currentTorrent=null,this.downloadersMap.clear(),this.allDownloaders=[]},setCurrentTorrent(Z){this.currentTorrent=Z},getDownloaderName(Z){return this.downloadersMap.get(Z)||"未知下载器"},getAllDownloaders(){return this.allDownloaders}}}),Gt={key:0,class:"modal-overlay"},Qt={class:"modal-header"},Zt={key:0,class:"site-data-content"},es={class:"torrent-info"},ts={class:"torrent-name"},ss={class:"name-text"},as={class:"torrent-stats"},ls={class:"stat-item stat-item--fixed"},ns={class:"stat-value"},os={class:"stat-item stat-item--fixed"},is={class:"stat-value"},rs={class:"stat-item stat-item--path"},ds=["title"],us={class:"stat-item stat-item--fixed"},cs={class:"stat-value"},ps={class:"stat-item stat-item--fixed"},vs={class:"stat-value"},fs={class:"content-area"},ms={class:"sites-container"},gs={key:0,class:"sites-grid"},_s=["onClick"],hs={class:"site-tile"},ys={class:"site-content"},ws={class:"site-name-wrapper"},xs={class:"site-name-with-link"},ks={class:"site-name-text"},Ss={class:"seeders-info"},bs={class:"right-panel"},$s={class:"downloaders-section"},Cs={class:"downloaders-list"},Is=["onClick"],Ds={class:"flow-section"},Ns={class:"flow-cards"},zs={class:"flow-card"},Ts={class:"card-content"},Vs={key:0,class:"empty-state"},Es={key:1,class:"site-info"},Us={class:"site-name"},Ms={class:"flow-card"},Ps={class:"card-content"},Rs={class:"downloader-info current"},Ls={class:"flow-card"},Os={class:"card-content"},Bs={class:"progress-section"},Fs={class:"progress-bar-container"},js={class:"progress-percentage"},As={class:"progress-steps-info"},Ws={key:0,class:"current-status"},Ks={class:"modal-footer"},qs=He({__name:"SiteDataViewer",props:{torrent:{}},emits:["refresh"],setup(Z,{emit:ee}){const te=ee,L=Xe(),ce=T(()=>L.dialogVisible),v=T(()=>L.currentTorrent),V=_(null),P=_(null),A=T(()=>!v.value||!v.value.sites?[]:Object.entries(v.value.sites).map(([r,d])=>({siteName:r,...d})).sort((r,d)=>(d.seeders||0)-(r.seeders||0))),W=()=>{S(),L.closeDialog()},k=r=>{if(r==null||r<=0)return"0 B";const d=["B","KB","MB","GB","TB","PB"],y=Math.floor(Math.log(r)/Math.log(1024));return`${(r/Math.pow(1024,y)).toFixed(2)} ${d[y]}`},g=r=>!!(r&&(r.startsWith("http")||/^\d+$/.test(r))),B=r=>(r.startsWith("http"),r),_e=r=>r.downloaderIds&&r.downloaderIds.length>0?r.downloaderIds.length===1?L.getDownloaderName(r.downloaderIds[0]):`${L.getDownloaderName(r.downloaderIds[0])} +${r.downloaderIds.length-1}`:r.downloaderId?L.getDownloaderName(r.downloaderId):"未知",X=r=>{V.value=r},F=r=>V.value===r,O=T(()=>{if(!V.value||!v.value||!v.value.sites)return null;const r=v.value.sites[V.value];return{siteName:V.value,seeders:r?.seeders||0,state:r?.state||"未知"}}),pe=r=>{P.value=r},Se=T(()=>L.getAllDownloaders()),he=T(()=>{if(!v.value)return null;const r=v.value.downloaderIds||[],d=v.value.downloaderId;return r.length>0?{id:r[0],name:L.getDownloaderName(r[0])}:d?{id:d,name:L.getDownloaderName(d)}:null}),N=_(0),ve=T(()=>{switch(N.value){case 0:return 0;case 1:return 33;case 2:return 66;case 3:return 100;default:return 0}}),ye=T(()=>{if(N.value!==0&&N.value===3)return"success"}),ne=r=>({"step-info--pending":N.value<r,"step-info--active":N.value===r,"step-info--completed":N.value>r}),oe=()=>{switch(N.value){case 1:return"正在暂停种子...";case 2:return"正在导出种子文件并添加...";case 3:return"转种完成！";default:return""}},S=()=>{N.value=0},we=async()=>{if(!V.value||!P.value||!v.value)return;const r=v.value.downloaderId||(v.value.downloaderIds&&v.value.downloaderIds.length>0?v.value.downloaderIds[0]:null);if(!r){alert("无法获取当前下载器信息");return}S();try{N.value=1;const y=await(await fetch("/api/torrent/transfer/prepare",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({source_downloader_id:r,target_downloader_id:P.value,site_name:V.value,torrent_name:v.value.name,torrent_size:v.value.size,save_path:v.value.save_path})})).json();if(!y.success){if(y.suggestions&&y.suggestions.length>0){const fe=y.suggestions.map((h,K)=>`${K+1}. ${h.name}
   站点: ${h.sites}
   大小: ${(h.size/1073741824).toFixed(2)} GB
   路径: ${h.save_path}`).join(`

`);if(confirm(`准备转移失败: ${y.message}

找到 ${y.suggestion_count} 个相似的种子:

${fe}

是否要使用第一个相似种子继续转移？`)&&y.suggestions.length>0){const h=y.suggestions[0];v.value&&(v.value.sites={[h.sites]:v.value.sites[V.value]||{}}),await se(h)}else S()}else alert(`准备转移失败: ${y.message}`),S();return}console.log(`找到 ${y.found_count} 个匹配的种子`),N.value=2;const I=await(await fetch("/api/torrent/transfer/execute",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({source_downloader_id:r,target_downloader_id:P.value,site_name:V.value,torrent_name:v.value.name,torrent_size:v.value.size,save_path:v.value.save_path})})).json();if(!I.success){alert(`转移失败: ${I.message}`),S();return}N.value=3,console.log("转移完成:",I);const ie=I.method==="torrent_file"?"种子文件":"未知方式";console.log(`转移方式: ${ie}`),te("refresh")}catch(d){console.error("转移过程中发生错误:",d),alert(`转移过程中发生错误: ${d?.message||"未知错误"}`),S()}},se=async r=>{if(!P.value||!v.value)return;const d=v.value.downloaderId||(v.value.downloaderIds&&v.value.downloaderIds.length>0?v.value.downloaderIds[0]:null);if(!d){alert("无法获取当前下载器信息"),S();return}try{console.log("使用相似种子重试转移:",r),N.value=2;const E=await(await fetch("/api/torrent/transfer/execute",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({source_downloader_id:d,target_downloader_id:P.value,site_name:r.sites,torrent_name:r.name,torrent_size:r.size,save_path:r.save_path})})).json();if(!E.success){alert(`转移失败: ${E.message}`),S();return}N.value=3,console.log("转移完成:",E);const I=E.method==="torrent_file"?"种子文件":"未知方式";console.log(`转移方式: ${I}`),te("refresh")}catch(y){console.error("重试转移过程中发生错误:",y),alert(`重试转移过程中发生错误: ${y?.message||"未知错误"}`),S()}};return(r,d)=>{const y=C("el-button"),E=C("el-icon"),I=C("el-link"),ie=C("el-tag"),fe=C("el-progress"),U=C("el-card");return ce.value?(u(),f("div",Gt,[o(U,{class:"site-data-card",shadow:"always"},{header:n(()=>[s("div",Qt,[s("span",null,"站点数据查看 - "+p(v.value?.name),1),o(y,{type:"danger",circle:"",onClick:W,plain:""},{default:n(()=>[...d[1]||(d[1]=[c("X",-1)])]),_:1})])]),default:n(()=>[v.value?(u(),f("div",Zt,[s("div",es,[s("div",ts,[o(E,{class:"torrent-icon"},{default:n(()=>[o(G(Pt))]),_:1}),s("span",ss,p(v.value.name),1)]),s("div",as,[s("div",ls,[o(E,{class:"stat-icon"},{default:n(()=>[o(G(Rt))]),_:1}),d[2]||(d[2]=s("span",{class:"stat-label"},"大小",-1)),s("span",ns,p(k(v.value.size)),1)]),s("div",os,[o(E,{class:"stat-icon"},{default:n(()=>[o(G(Lt))]),_:1}),d[3]||(d[3]=s("span",{class:"stat-label"},"上传",-1)),s("span",is,p(v.value.total_uploaded_formatted||k(v.value.total_uploaded)),1)]),s("div",rs,[o(E,{class:"stat-icon"},{default:n(()=>[o(G(Ot))]),_:1}),d[4]||(d[4]=s("span",{class:"stat-label"},"路径",-1)),s("span",{class:"stat-value",title:v.value.save_path},p(v.value.save_path),9,ds)]),s("div",us,[o(E,{class:"stat-icon"},{default:n(()=>[o(G(Bt))]),_:1}),d[5]||(d[5]=s("span",{class:"stat-label"},"下载器",-1)),s("span",cs,p(_e(v.value)),1)]),s("div",ps,[o(E,{class:"stat-icon"},{default:n(()=>[o(G(Ft))]),_:1}),d[6]||(d[6]=s("span",{class:"stat-label"},"可转种",-1)),s("span",vs,p(v.value.target_sites_count||0)+"个",1)])])]),s("div",fs,[s("div",ms,[A.value.length>0?(u(),f("div",gs,[(u(!0),f(j,null,H(A.value,h=>(u(),f("div",{key:h.siteName,class:J(["site-card",{"site-card--selected":F(h.siteName)}]),onClick:K=>X(h.siteName)},[s("div",hs,[s("div",ys,[s("div",ws,[s("div",xs,[s("span",ks,p(h.siteName),1),g(h.comment)?(u(),R(I,{key:0,href:B(h.comment),target:"_blank",underline:!1,class:"site-link-icon",onClick:d[0]||(d[0]=Q(()=>{},["stop"]))},{default:n(()=>[o(E,{size:"10"},{default:n(()=>[o(G(jt))]),_:1})]),_:1},8,["href"])):$("",!0)])]),s("div",Ss,[o(ie,{type:h.seeders>0?"warning":"info",size:"small"},{default:n(()=>[c(p(h.seeders||0)+"人做种 ",1)]),_:2},1032,["type"])])])])],10,_s))),128))])):$("",!0)]),s("div",bs,[s("div",$s,[d[7]||(d[7]=s("div",{class:"section-title"},"下载器",-1)),s("div",Cs,[(u(!0),f(j,null,H(Se.value,h=>(u(),f("div",{key:h.id,class:J(["downloader-item",{"downloader-item--selected":P.value===h.id}]),onClick:K=>pe(h.id)},p(h.name),11,Is))),128))])]),s("div",Ds,[s("div",Ns,[s("div",zs,[d[8]||(d[8]=s("div",{class:"card-title"},"选中站点",-1)),s("div",Ts,[O.value?(u(),f("div",Es,[s("div",Us,p(O.value.siteName),1),o(ie,{type:O.value.seeders>0?"warning":"info",size:"small"},{default:n(()=>[c(p(O.value.seeders)+"人做种 ",1)]),_:1},8,["type"])])):(u(),f("div",Vs,"未选择"))])]),d[11]||(d[11]=s("div",{class:"flow-divider"},[s("span",null,"→")],-1)),s("div",Ms,[d[9]||(d[9]=s("div",{class:"card-title"},"当前下载器",-1)),s("div",Ps,[s("div",Rs,p(he.value?.name||"未知"),1)])]),d[12]||(d[12]=s("div",{class:"flow-divider"},[s("span",null,"→")],-1)),s("div",Ls,[d[10]||(d[10]=s("div",{class:"card-title"},"目标下载器",-1)),s("div",Os,[s("div",{class:J(["downloader-info target",{selected:P.value}])},p(P.value?G(L).getDownloaderName(P.value):"未选择"),3)])])])]),s("div",Bs,[d[16]||(d[16]=s("div",{class:"progress-title"},"转种流程",-1)),s("div",Fs,[o(fe,{percentage:ve.value,status:ye.value,"stroke-width":8,"show-text":!0},{default:n(({percentage:h})=>[s("span",js,p(h)+"%",1)]),_:1},8,["percentage","status"]),s("div",As,[s("div",{class:J(["step-info",ne(1)])},[...d[13]||(d[13]=[s("div",{class:"step-indicator"},null,-1),s("div",{class:"step-details"},[s("div",{class:"step-name"},"暂停种子"),s("div",{class:"step-desc"},"暂停下载器中选择的站点种子")],-1)])],2),s("div",{class:J(["step-info",ne(2)])},[...d[14]||(d[14]=[s("div",{class:"step-indicator"},null,-1),s("div",{class:"step-details"},[s("div",{class:"step-name"},"导出种子"),s("div",{class:"step-desc"},"导出种子文件并添加到目标下载器")],-1)])],2),s("div",{class:J(["step-info",ne(3)])},[...d[15]||(d[15]=[s("div",{class:"step-indicator"},null,-1),s("div",{class:"step-details"},[s("div",{class:"step-name"},"转移完成"),s("div",{class:"step-desc"},"种子已成功转移到目标下载器")],-1)])],2)]),N.value>0&&N.value<=3?(u(),f("div",Ws,p(oe()),1)):$("",!0)])])])])])):$("",!0),s("div",Ks,[o(y,{type:"success",onClick:we,disabled:!V.value||!P.value||N.value>0},{default:n(()=>[...d[17]||(d[17]=[c(" 执行转种 ",-1)])]),_:1},8,["disabled"]),o(y,{type:"primary",onClick:W},{default:n(()=>[...d[18]||(d[18]=[c("关闭",-1)])]),_:1})])]),_:1})])):$("",!0)}}}),Ys=Je(qs,[["__scopeId","data-v-6ee24ce4"]]),Hs={class:"torrents-view"},Js={class:"expand-content"},Xs=["onClick"],Gs=["href"],Qs=["onClick"],Zs={class:"name-header-container"},ea={key:0,class:"current-filters",style:{"margin-right":"15px",display:"flex","align-items":"center"}},ta={style:{"white-space":"normal"}},sa={style:{display:"inline-block",width:"100%","text-align":"center"}},aa=["title"],la={style:{display:"flex","justify-content":"center","align-items":"center",width:"100%",height:"100%"}},na={key:0},oa={style:{padding:"1px 0",width:"100%"}},ia={style:{"text-align":"center","font-size":"12px","margin-top":"5px","line-height":"1"}},ra={style:{display:"flex","justify-content":"center","align-items":"center",width:"100%",height:"100%"}},da={style:{display:"flex","justify-content":"center","align-items":"center",width:"100%",height:"100%"}},ua={key:0},ca={key:1},pa={style:{display:"flex","justify-content":"center","align-items":"center",width:"100%",height:"100%"}},va={key:3,class:"modal-overlay"},fa={class:"modal-header"},ma={key:0,class:"cross-seed-content"},ga={class:"filter-card-header"},_a={class:"filter-card-body"},ha={class:"site-filter-container"},ya={style:{display:"flex","align-items":"center",gap:"15px","margin-bottom":"5px"}},wa={style:{display:"flex","align-items":"center",gap:"10px"}},xa={key:0,style:{display:"flex","align-items":"center"}},ka={key:1,style:{display:"flex","align-items":"center"}},Sa={class:"site-checkbox-container"},ba={style:{"margin-bottom":"10px"}},$a={key:0,style:{display:"flex","align-items":"center"}},Ca={style:{"margin-bottom":"10px"}},Ia={key:0,style:{display:"flex","align-items":"center"}},Da={class:"path-tree-container"},Na={style:{"margin-bottom":"10px"}},za={key:0,style:{display:"flex","align-items":"center"}},Ta={class:"filter-card-footer"},Va={class:"filter-card-header"},Ea={class:"site-operation-body"},Ua={class:"torrent-name-container"},Ma={class:"torrent-name"},Pa={key:0,class:"site-operation-link"},Ra={key:1,class:"site-operation-input"},La={class:"site-operation-buttons"},Oa={key:6,class:"filter-overlay"},Ba={class:"filter-card-header"},Fa={class:"source-site-selection-body"},ja={class:"source-site-tip"},Aa={key:0,class:"cached-sites-section"},Wa={class:"cached-sites-label"},Ka={class:"site-list-box glass-site-box cached-sites-box"},qa={key:1,class:"uncached-sites-section"},Ya={class:"site-list-box glass-site-box"},Ha={class:"filter-card-footer"},Ja=220,Xa=90,qe=30,Ye="torrents_view_first_load",Ga=He({__name:"TorrentsView",emits:["ready"],setup(Z,{emit:ee}){const te=ee,L=_(null),ce=_(!0),v=_([]),V=_(null),P=_(!1),A=_(""),W=_({prop:"name",order:"ascending"}),k=Ke({paths:[],states:[],existSiteNames:[],notExistSiteNames:[],downloaderIds:[]}),g=Ke({...k}),B=_("exist"),_e=T({get:()=>B.value==="exist"?g.existSiteNames:g.notExistSiteNames,set:t=>{B.value==="exist"?g.existSiteNames=t:g.notExistSiteNames=t}}),X=_(!1),F=_(1),O=_(50),pe=_(0),Se=_([]),he=_([]),N=_([]),ve=_({}),ye=_([]),ne=_([]),oe=_([]),S=_(null),we=_([]),se=_(!1),r=_([]),d=_(!1),y=_([]),E=_(!1),I=Jt(),ie=Xe(),fe=T(()=>!!I.taskId),U=T(()=>I.workingParams);T(()=>I.sourceInfo?.name||"");const h=_(!1),K=_(""),z=_(null),Y=_(""),xe=_({}),be=T(()=>{const t=new Intl.Collator("zh-CN",{numeric:!0});return[...N.value].sort(t.compare)}),re=_(""),Ee=T(()=>{if(!re.value)return be.value;const t=re.value.toLowerCase();return be.value.filter(e=>e.toLowerCase().includes(t))}),Ge=t=>{let e=0;for(const l of t)e+=l.charCodeAt(0)>255?14:8;return e},Qe=T(()=>{const t=v.value||[];let e=0;for(const i of t){const m=String(i?.save_path||""),b=Fe(m,qe)||"";e=Math.max(e,Ge(b))}const l=e+40;return Math.min(Ja,Math.max(Xa,Math.round(l)))}),Ze=T(()=>{const t=k,e=[];return t.paths&&t.paths.length>0&&e.push(`路径: ${t.paths.length}`),t.states&&t.states.length>0&&e.push(`状态: ${t.states.length}`),t.existSiteNames&&t.existSiteNames.length>0&&e.push(`存在于: ${t.existSiteNames.length}`),t.notExistSiteNames&&t.notExistSiteNames.length>0&&e.push(`不存在于: ${t.notExistSiteNames.length}`),t.downloaderIds&&t.downloaderIds.length>0&&e.push(`下载器: ${t.downloaderIds.length}`),e.join(", ")}),et=T(()=>{const t=k;return t.paths&&t.paths.length>0||t.states&&t.states.length>0||t.existSiteNames&&t.existSiteNames.length>0||t.notExistSiteNames&&t.notExistSiteNames.length>0||t.downloaderIds&&t.downloaderIds.length>0});T(()=>{const t=Ee.value;return B.value==="exist"?t.filter(e=>!g.notExistSiteNames.includes(e)):t.filter(e=>!g.existSiteNames.includes(e))});const Ue=t=>B.value==="exist"?!g.notExistSiteNames.includes(t):!g.existSiteNames.includes(t),tt=[{color:"#f56c6c",percentage:80},{color:"#e6a23c",percentage:99},{color:"#67c23a",percentage:100}],me=async()=>{try{const t={page_size:O.value,sort_prop:W.value.prop,sort_order:W.value.order,name_search:A.value,active_filters:k};await q.post("/api/ui_settings",t)}catch(t){console.error("无法保存UI设置:",t.message)}},st=async()=>{try{const e=(await q.get("/api/ui_settings")).data;if(O.value=e.page_size??50,W.value={prop:e.sort_prop||"name",order:"sort_order"in e?e.sort_order:"ascending"},A.value=e.name_search??"",e.active_filters){Object.assign(k,e.active_filters),k.existSiteNames||(k.existSiteNames=[]),k.notExistSiteNames||(k.notExistSiteNames=[]);const l=k;l.siteExistence&&delete l.siteExistence,l.siteNames&&delete l.siteNames}}catch(t){console.error("加载UI设置时出错:",t)}finally{P.value=!0}},at=t=>{const e=[],l=new Map;return t.sort().forEach(i=>{const m=i.replace(/^\/|\/$/g,"").split("/");let b="",w=e;m.forEach((ae,ue)=>{if(b=ue===0?`/${ae}`:`${b}/${ae}`,!l.has(b)){const le={path:ue===m.length-1?i:b,label:ae,children:[]};l.set(b,le),w.push(le)}w=l.get(b).children})}),l.forEach(i=>{i.children&&i.children.length===0&&delete i.children}),e},lt=async()=>{try{const e=(await q.get("/api/all_downloaders")).data;ne.value=e.filter(l=>l.enabled),oe.value=e}catch(t){V.value=t.message}},nt=async()=>{try{const e=(await q.get("/api/sites/status")).data;r.value=e.filter(l=>l.is_source)}catch(t){V.value=t.message}},M=async()=>{ce.value=!0,V.value=null;try{const t=new URLSearchParams({page:F.value.toString(),pageSize:O.value.toString(),nameSearch:A.value,sortProp:W.value.prop||"name",sortOrder:W.value.order||"ascending",existSiteNames:JSON.stringify(k.existSiteNames),notExistSiteNames:JSON.stringify(k.notExistSiteNames),path_filters:JSON.stringify(k.paths||[]),state_filters:JSON.stringify(k.states),downloader_filters:JSON.stringify(k.downloaderIds)}),l=(await q.get(`/api/data?${t.toString()}`)).data;if(l.error)throw new Error(l.error);v.value=l.data,pe.value=l.total,O.value!==l.pageSize&&(O.value=l.pageSize),Se.value=l.unique_paths,he.value=l.unique_states,N.value=l.all_discovered_sites,ve.value=l.site_link_rules,k.paths=l.active_path_filters,we.value=at(l.unique_paths)}catch(t){V.value=t.message}finally{ce.value=!1}},ot=async t=>{I.reset();const e=Object.entries(t.sites).map(([l,i])=>({siteName:l,...i})).filter(l=>{if(!(l.migration===1||l.migration===3))return!1;const m=l.comment&&l.comment.includes("details.php?id="),b=l.comment&&/^\d+$/.test(l.comment.trim());return m||b});I.setParams(t),await dt(t),e.length===0&&D.warning("该种子暂无可用的源站点，您可以使用 IYUU 查询来发现更多站点。"),se.value=!0},it=t=>{ie.openDialog(t,oe.value)},rt=()=>{console.log("触发种子数据刷新"),M()},dt=async t=>{E.value=!0,y.value=[];try{const l=(await q.get(`/api/cached_sites?name=${encodeURIComponent(t.name)}&size=${t.size}`)).data;l.success?(y.value=l.cached_sites||[],console.log("缓存站点查询结果:",y.value)):console.warn("查询缓存站点失败:",l.error)}catch(e){console.error("查询缓存站点时出错:",e)}finally{E.value=!1}},Me=async t=>{const e=U.value;if(!e||!t){D.error("发生内部错误：未找到选中的种子或站点信息。");return}const l=e.sites[t.siteName],i=t.siteName;if(!l){D.error(`未找到站点 [${i}] 的数据。`);return}if(!ge(l,i)){D.info(`站点 [${i}] 缺少详情链接，正在触发 IYUU 查询...`),xe.value[i]=!0,await Be(),xe.value[i]=!1;return}let m=null;const b=l?.comment?.match(/id=(\d+)/);if(b&&b[1])m=b[1];else if(l?.comment&&/^\d+$/.test(l.comment.trim()))m=l.comment.trim();else{D.error(`无法从源站点 ${i} 的详情页链接中提取种子ID。请尝试使用IYUU查询更新链接。`);return}l&&(l.torrentId=m);const w=r.value.find(ue=>ue.name===i)?.site||i.toLowerCase();D.success(`准备从站点 [${i}] 开始迁移种子...`);const ae={name:i,site:w,torrentId:m};I.setSourceInfo(ae),I.setTaskId(e.name+"_"+Date.now()),se.value=!1},de=t=>{if(!!!(U.value&&U.value.sites[t]))return!1;const l=r.value.find(i=>i.name===t);return!l||!l.has_cookie?!1:t==="杜比"||t==="HDtime"||t==="肉丝"?!!l.has_passkey:!0},Pe=()=>{I.reset()},Re=(t,e)=>{K.value=t,z.value=e,Y.value="",h.value=!0},Le=async()=>{if(!K.value||!z.value){D.error("缺少必要的参数");return}if(!Y.value||Y.value.trim()===""){D.error("请输入详情页链接或ID");return}try{const e=(await q.post("/api/sites/update_comment",{torrent_name:K.value,site_name:z.value.name,comment:Y.value.trim()})).data;e.success?(D.success("详情页链接已成功添加"),h.value=!1,Y.value="",await M()):D.error(e.error||"添加详情页链接失败")}catch(t){console.error("添加详情页链接时出错:",t),D.error("添加详情页链接时发生网络错误")}},ut=async()=>{if(!K.value||!z.value){D.error("缺少必要的参数");return}try{const t=await q.post("/api/sites/set_not_exist",{torrent_name:K.value,site_name:z.value.name});D.success("站点状态已成功设置为不存在"),h.value=!1,M()}catch(t){console.error("设置站点状态时出错:",t),D.error(t.response?.data?.error||"设置站点状态时发生错误")}},ct=()=>{D.success("转种操作已完成！"),I.reset(),M()},pt=()=>{D.success("转种操作已完成！"),I.reset(),M()},Oe=t=>{if(!U.value)return null;const e=U.value.sites[t];return e?{siteName:t,...e}:null},Be=async()=>{const t=U.value;if(!t){D.error("未找到选中的种子信息");return}d.value=!0;try{const l=(await q.post("/api/iyuu_query",{name:t.name,size:t.size})).data;if(l.success){D.success(l.message||"IYUU查询已完成"),await M();const i=v.value.find(m=>m.name===t.name&&m.size===t.size);i&&I.setParams(i)}else D.error(l.error||"IYUU查询失败")}catch(e){console.error("触发IYUU查询时出错:",e),D.error(e.response?.data?.error||"触发IYUU查询时发生网络错误")}finally{d.value=!1}},vt=t=>{O.value=t,F.value=1,M(),me()},ft=t=>{F.value=t,M()},mt=t=>{W.value=t,F.value=1,M(),me()},gt=()=>{Object.assign(g,k),X.value=!0,Yt(()=>{S.value&&S.value.setCheckedKeys(k.paths,!1)})},_t=async()=>{if(S.value){const t=S.value.getCheckedKeys(!1);g.paths=t}Object.assign(k,g),X.value=!1,F.value=1,await M(),me()},ht=()=>{g.paths=[],g.states=[],g.existSiteNames=[],g.notExistSiteNames=[],g.downloaderIds=[],B.value="exist",re.value="",S.value&&S.value.setCheckedKeys([],!1)},yt=()=>{if(g.existSiteNames=[],B.value==="exist"&&S.value){const t=S.value.getCheckedKeys(!0);g.paths=t}},wt=()=>{if(g.notExistSiteNames=[],B.value==="not-exist"&&S.value){const t=S.value.getCheckedKeys(!0);g.paths=t}},xt=()=>{g.paths=[],S.value&&S.value.setCheckedKeys([],!1)},kt=()=>{g.states=[]},St=()=>{g.downloaderIds=[]},bt=async()=>{k.paths=[],k.states=[],k.existSiteNames=[],k.notExistSiteNames=[],k.downloaderIds=[],A.value="",B.value="exist",re.value="",S.value&&S.value.setCheckedKeys([],!1),F.value=1,await M(),me()},$e=t=>{if(t==null||t<=0)return"0 B";const e=["B","KB","MB","GB","TB","PB"],l=Math.floor(Math.log(t)/Math.log(1024));return`${(t/Math.pow(1024,l)).toFixed(2)} ${e[l]}`},ge=(t,e)=>{const{comment:l}=t;return!!(l&&(l.startsWith("http")||/^\d+$/.test(l)&&ve.value[e]))},Ce=(t,e)=>{const{comment:l}=t;if(l.startsWith("http"))return l;const i=ve.value[e];return i&&/^\d+$/.test(l)?`${(i.base_url.startsWith("http")?i.base_url:`https://${i.base_url}`).replace(/\/$/,"")}/details.php?id=${l}`:null},Ie=t=>t.state==="未做种"?"danger":t.state==="不存在"?"info":t.comment?"success":t.state==="做种中"?"primary":"info",De=t=>{if(!t)return"未知下载器";const e=oe.value.find(l=>l.id===t);return e?e.name:"未知下载器"},$t=t=>{if(!t||!oe.value.find(m=>m.id===t))return"info";let l=0;for(let m=0;m<t.length;m++)l=t.charCodeAt(m)+((l<<5)-l);const i=["primary","success","warning","danger","info"];return i[Math.abs(l)%i.length]},Ct=t=>[...t].sort((l,i)=>{const m=De(l),b=De(i);return m.localeCompare(b,"zh-CN")}),Fe=(t,e=50)=>{if(!t||t.length<=e)return t;const l=Math.floor((e-3)/2);let i=t.substring(0,l),m=t.substring(t.length-l);const b=i.lastIndexOf("/"),w=m.indexOf("/");return b>0&&w>=0&&(i=i.substring(0,b),m=m.substring(w+1)),`${i}...${m}`},je=(t,e)=>{if(!!!(U.value&&U.value.sites[t.name]))return"info";const i=U.value.sites[t.name];return!t.has_cookie||(t.name==="杜比"||t.name==="肉丝")&&!t.has_passkey?"error":t.has_cookie&&i.comment?"success":"primary"},It=t=>t.includes("下载")?"primary":t.includes("做种")?"success":t.includes("暂停")?"warning":t.includes("错误")||t.includes("丢失")?"danger":"info",Dt=t=>L.value?.toggleRowExpansion(t),Nt=(t,e)=>{ye.value=e.map(l=>l.unique_id)},zt=({row:t})=>ye.value.includes(t.unique_id)?"expanded-row":"";return At(async()=>{const t=!sessionStorage.getItem(Ye);if(await st(),M(),t){try{console.log("首次加载页面，触发种子数据刷新..."),await q.post("/api/refresh_data"),console.log("种子数据刷新完成，重新获取数据..."),await M()}catch(e){console.warn("页面加载时种子数据刷新失败:",e)}sessionStorage.setItem(Ye,"loaded")}else console.log("页面已加载过，跳过种子数据刷新");lt(),nt(),te("ready",M)}),Wt(A,()=>{F.value=1,M(),me()}),(t,e)=>{const l=C("el-alert"),i=C("el-tag"),m=C("el-table-column"),b=C("el-input"),w=C("el-button"),ae=C("el-progress"),ue=C("el-table"),Ae=C("el-pagination"),le=C("el-card"),ke=C("el-divider"),We=C("el-radio-button"),Tt=C("el-radio-group"),Ne=C("el-checkbox"),ze=C("el-checkbox-group"),Vt=C("el-tree"),Et=C("el-link"),Te=Kt("loading");return u(),f("div",Hs,[V.value?(u(),R(l,{key:0,title:V.value,type:"error","show-icon":"",closable:!1,center:"",style:{"margin-bottom":"15px"}},null,8,["title"])):$("",!0),P.value?Ve((u(),R(ue,{key:1,data:v.value,border:"",height:"100%",ref_key:"tableRef",ref:L,"row-key":"unique_id","row-class-name":zt,onRowClick:Dt,onExpandChange:Nt,onSortChange:mt,"default-sort":W.value,"empty-text":"无数据或当前筛选条件下无结果",class:"glass-table"},{default:n(()=>[o(m,{type:"expand",width:"1"},{default:n(a=>[s("div",Js,[(u(!0),f(j,null,H(be.value,x=>(u(),f(j,{key:x},[a.row.sites[x]?(u(),f(j,{key:0},[a.row.sites[x].state==="未做种"?(u(),f("div",{key:0,style:{cursor:"pointer",display:"inline-block",width:"100%","text-align":"center"},onClick:Q(Ut=>Re(a.row.name,{name:x,data:a.row.sites[x]}),["stop"])},[o(i,{effect:"dark",type:Ie(a.row.sites[x]),style:{"text-align":"center",width:"100%"}},{default:n(()=>[c(p(x)+" ",1),s("div",null,"("+p($e(a.row.sites[x].uploaded))+")",1)]),_:2},1032,["type"])],8,Xs)):a.row.sites[x]&&ge(a.row.sites[x],x)?(u(),f("a",{key:1,href:Ce(a.row.sites[x],x),target:"_blank",style:{"text-decoration":"none"}},[o(i,{effect:"dark",type:Ie(a.row.sites[x]),style:{"text-align":"center"}},{default:n(()=>[c(p(x)+" ",1),s("div",null,"("+p($e(a.row.sites[x].uploaded))+")",1)]),_:2},1032,["type"])],8,Gs)):(u(),f("div",{key:2,style:{cursor:"pointer",display:"inline-block",width:"100%","text-align":"center"},onClick:Q(Ut=>Re(a.row.name,{name:x,data:a.row.sites[x]}),["stop"])},[o(i,{effect:"dark",type:Ie(a.row.sites[x]),style:{"text-align":"center",width:"100%"}},{default:n(()=>[c(p(x)+" ",1),s("div",null,"("+p($e(a.row.sites[x].uploaded))+")",1)]),_:2},1032,["type"])],8,Qs))],64)):(u(),R(i,{key:1,type:"info",effect:"plain"},{default:n(()=>[c(p(x),1)]),_:2},1024))],64))),128))])]),_:1}),o(m,{prop:"name","min-width":"450",sortable:"custom"},{header:n(()=>[s("div",Zs,[e[22]||(e[22]=s("div",null,"种子",-1)),o(b,{modelValue:A.value,"onUpdate:modelValue":e[0]||(e[0]=a=>A.value=a),placeholder:"搜索名称...",clearable:"",class:"search-input",onClick:e[1]||(e[1]=Q(()=>{},["stop"]))},null,8,["modelValue"]),s("span",{onClick:e[2]||(e[2]=Q(()=>{},["stop"])),style:{display:"flex","align-items":"center"}},[et.value?(u(),f("div",ea,[o(i,{type:"info",size:"default",effect:"plain"},{default:n(()=>[c(p(Ze.value),1)]),_:1}),o(w,{type:"danger",link:"",style:{padding:"0","margin-left":"8px"},onClick:bt},{default:n(()=>[...e[20]||(e[20]=[c("清除",-1)])]),_:1})])):$("",!0),o(w,{type:"primary",onClick:gt,plain:""},{default:n(()=>[...e[21]||(e[21]=[c("筛选",-1)])]),_:1})])])]),default:n(a=>[s("span",ta,p(a.row.name),1)]),_:1}),o(m,{prop:"site_count",label:"做种数",sortable:"custom",width:"95",align:"center","header-align":"center"},{default:n(a=>[s("span",sa,p(a.row.site_count)+" / "+p(a.row.total_site_count),1)]),_:1}),o(m,{prop:"save_path",label:"保存路径",width:Qe.value,"header-align":"center"},{default:n(a=>[s("div",{title:a.row.save_path,style:{width:"100%",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},p(Fe(a.row.save_path,qe)),9,aa)]),_:1},8,["width"]),o(m,{label:"下载器",width:"130",align:"center","header-align":"center"},{default:n(a=>[s("div",la,[a.row.downloaderIds&&a.row.downloaderIds.length>0?(u(),f("div",na,[(u(!0),f(j,null,H(Ct(a.row.downloaderIds),x=>(u(),R(i,{key:x,size:"small",type:$t(x),style:{margin:"2px"}},{default:n(()=>[c(p(De(x)),1)]),_:2},1032,["type"]))),128))])):(u(),R(i,{key:1,type:"info",size:"small"},{default:n(()=>[...e[23]||(e[23]=[c(" 未知下载器 ",-1)])]),_:1}))])]),_:1}),o(m,{label:"大小",prop:"size_formatted",width:"100",align:"center",sortable:"custom"}),o(m,{label:"总上传量",prop:"total_uploaded_formatted",width:"110",align:"center",sortable:"custom"}),o(m,{label:"进度",prop:"progress",width:"90",align:"center",sortable:"custom"},{default:n(a=>[s("div",oa,[o(ae,{percentage:a.row.progress,"stroke-width":10,color:tt,"show-text":!1,style:{width:"100%"}},null,8,["percentage"]),s("div",ia,p(a.row.progress)+"% ",1)])]),_:1}),o(m,{label:"状态",prop:"state",width:"120",align:"center","header-align":"center"},{default:n(a=>[s("div",ra,[o(i,{type:It(a.row.state),size:"large"},{default:n(()=>[c(p(a.row.state),1)]),_:2},1032,["type"])])]),_:1}),o(m,{label:"可转种",width:"100",align:"center","header-align":"center",prop:"target_sites_count",sortable:"custom"},{default:n(a=>[s("div",da,[a.row.target_sites_count!==void 0?(u(),f("span",ua,p(a.row.target_sites_count),1)):(u(),f("span",ca,"-"))])]),_:1}),o(m,{label:"操作",width:"100",align:"center","header-align":"center"},{default:n(a=>[s("div",pa,[o(w,{type:"primary",size:"small",onClick:Q(x=>ot(a.row),["stop"])},{default:n(()=>[...e[24]||(e[24]=[c(" 转种 ",-1)])]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data","default-sort"])),[[Te,ce.value]]):$("",!0),pe.value>0?(u(),R(Ae,{key:2,class:"glass-pagination",style:{"justify-content":"flex-end"},"current-page":F.value,"onUpdate:currentPage":e[3]||(e[3]=a=>F.value=a),"page-size":O.value,"onUpdate:pageSize":e[4]||(e[4]=a=>O.value=a),"page-sizes":[20,50,100],total:pe.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:vt,onCurrentChange:ft,background:""},null,8,["current-page","page-size","total"])):$("",!0),fe.value?(u(),f("div",va,[o(le,{class:"cross-seed-card",shadow:"always"},{header:n(()=>[s("div",fa,[s("span",null,"转种 - "+p(U.value?.name),1),o(w,{type:"danger",circle:"",onClick:Pe,plain:""},{default:n(()=>[...e[25]||(e[25]=[c("X",-1)])]),_:1})])]),default:n(()=>[U.value?(u(),f("div",ma,[o(Xt,{onComplete:ct,onCancel:Pe,onCloseWithRefresh:pt})])):$("",!0)]),_:1})])):$("",!0),X.value?(u(),f("div",{key:4,class:"filter-overlay",onClick:e[12]||(e[12]=Q(a=>X.value=!1,["self"]))},[o(le,{class:"filter-card"},{header:n(()=>[s("div",ga,[e[27]||(e[27]=s("span",null,"筛选选项",-1)),o(w,{type:"danger",circle:"",onClick:e[5]||(e[5]=a=>X.value=!1),plain:""},{default:n(()=>[...e[26]||(e[26]=[c("X",-1)])]),_:1})])]),default:n(()=>[s("div",_a,[o(ke,{"content-position":"left"},{default:n(()=>[...e[28]||(e[28]=[c("站点筛选",-1)])]),_:1}),s("div",ha,[s("div",ya,[o(Tt,{modelValue:B.value,"onUpdate:modelValue":e[6]||(e[6]=a=>B.value=a),size:"default"},{default:n(()=>[o(We,{label:"exist",class:"compact-radio-button"},{default:n(()=>[...e[29]||(e[29]=[c("存在于",-1)])]),_:1}),o(We,{label:"not-exist",class:"compact-radio-button"},{default:n(()=>[...e[30]||(e[30]=[c("不存在于",-1)])]),_:1})]),_:1},8,["modelValue"]),o(b,{modelValue:re.value,"onUpdate:modelValue":e[7]||(e[7]=a=>re.value=a),placeholder:"搜索站点",clearable:"",style:{width:"280px","font-size":"14px"},size:"default"},null,8,["modelValue"]),s("div",wa,[g.existSiteNames.length>0?(u(),f("div",xa,[o(i,{type:"info",size:"default",effect:"plain"},{default:n(()=>[c("存在于: "+p(g.existSiteNames.length),1)]),_:1}),o(w,{type:"danger",link:"",style:{padding:"0","margin-left":"5px"},onClick:yt},{default:n(()=>[...e[31]||(e[31]=[c("清除",-1)])]),_:1})])):$("",!0),g.notExistSiteNames.length>0?(u(),f("div",ka,[o(i,{type:"info",size:"default",effect:"plain"},{default:n(()=>[c("不存在于: "+p(g.notExistSiteNames.length),1)]),_:1}),o(w,{type:"danger",link:"",style:{padding:"0","margin-left":"5px"},onClick:wt},{default:n(()=>[...e[32]||(e[32]=[c("清除",-1)])]),_:1})])):$("",!0)])]),s("div",Sa,[o(ze,{modelValue:_e.value,"onUpdate:modelValue":e[8]||(e[8]=a=>_e.value=a)},{default:n(()=>[(u(!0),f(j,null,H(Ee.value,a=>(u(),R(Ne,{key:a,label:a,disabled:!Ue(a),class:J({"disabled-site":!Ue(a)})},{default:n(()=>[c(p(a),1)]),_:2},1032,["label","disabled","class"]))),128))]),_:1},8,["modelValue"])])]),o(ke,{"content-position":"left"},{default:n(()=>[...e[33]||(e[33]=[c("下载器",-1)])]),_:1}),s("div",ba,[g.downloaderIds.length>0?(u(),f("div",$a,[o(i,{type:"info",size:"default",effect:"plain"},{default:n(()=>[c("下载器: "+p(g.downloaderIds.length),1)]),_:1}),o(w,{type:"danger",link:"",style:{padding:"0","margin-left":"5px"},onClick:St},{default:n(()=>[...e[34]||(e[34]=[c("清除",-1)])]),_:1})])):$("",!0)]),o(ze,{modelValue:g.downloaderIds,"onUpdate:modelValue":e[9]||(e[9]=a=>g.downloaderIds=a)},{default:n(()=>[(u(!0),f(j,null,H(ne.value,a=>(u(),R(Ne,{key:a.id,label:a.id},{default:n(()=>[c(p(a.name),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"]),o(ke,{"content-position":"left"},{default:n(()=>[...e[35]||(e[35]=[c("保存路径",-1)])]),_:1}),s("div",Ca,[g.paths.length>0?(u(),f("div",Ia,[o(i,{type:"info",size:"default",effect:"plain"},{default:n(()=>[c("路径: "+p(g.paths.length),1)]),_:1}),o(w,{type:"danger",link:"",style:{padding:"0","margin-left":"5px"},onClick:xt},{default:n(()=>[...e[36]||(e[36]=[c("清除",-1)])]),_:1})])):$("",!0)]),s("div",Da,[o(Vt,{ref_key:"pathTreeRef",ref:S,data:we.value,"show-checkbox":"","node-key":"path","default-expand-all":"","expand-on-click-node":!1,"check-on-click-node":"","check-strictly":!0,props:{class:"path-tree-node"}},null,8,["data"])]),o(ke,{"content-position":"left"},{default:n(()=>[...e[37]||(e[37]=[c("状态",-1)])]),_:1}),s("div",Na,[g.states.length>0?(u(),f("div",za,[o(i,{type:"info",size:"default",effect:"plain"},{default:n(()=>[c("状态: "+p(g.states.length),1)]),_:1}),o(w,{type:"danger",link:"",style:{padding:"0","margin-left":"5px"},onClick:kt},{default:n(()=>[...e[38]||(e[38]=[c("清除",-1)])]),_:1})])):$("",!0)]),o(ze,{modelValue:g.states,"onUpdate:modelValue":e[10]||(e[10]=a=>g.states=a)},{default:n(()=>[(u(!0),f(j,null,H(he.value,a=>(u(),R(Ne,{key:a,label:a},{default:n(()=>[c(p(a),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),s("div",Ta,[o(w,{onClick:ht},{default:n(()=>[...e[39]||(e[39]=[c("清除筛选",-1)])]),_:1}),o(w,{onClick:e[11]||(e[11]=a=>X.value=!1)},{default:n(()=>[...e[40]||(e[40]=[c("取消",-1)])]),_:1}),o(w,{type:"primary",onClick:_t},{default:n(()=>[...e[41]||(e[41]=[c("确认",-1)])]),_:1})])]),_:1})])):$("",!0),h.value?(u(),f("div",{key:5,class:"filter-overlay",onClick:e[16]||(e[16]=Q(a=>h.value=!1,["self"]))},[o(le,{class:"filter-card",style:{"max-width":"500px"}},{header:n(()=>[s("div",Va,[e[43]||(e[43]=s("span",null,"站点操作",-1)),o(w,{type:"danger",circle:"",onClick:e[13]||(e[13]=a=>h.value=!1),plain:""},{default:n(()=>[...e[42]||(e[42]=[c("X",-1)])]),_:1})])]),default:n(()=>[s("div",Ea,[s("div",Ua,[e[44]||(e[44]=s("p",{class:"label"},"种子名称:",-1)),s("p",Ma,p(K.value),1)]),s("p",null,"站点名称: "+p(z.value?.name),1),s("p",null,"当前状态: "+p(z.value?.data.state),1),z.value&&z.value.data&&ge(z.value.data,z.value.name)?(u(),f("div",Pa,[e[45]||(e[45]=s("p",{class:"label"},"详情页链接:",-1)),o(Et,{href:Ce(z.value.data,z.value.name),target:"_blank",type:"primary",underline:!1},{default:n(()=>[c(p(Ce(z.value.data,z.value.name)),1)]),_:1},8,["href"])])):(u(),f("div",Ra,[e[46]||(e[46]=s("p",{class:"label"},"添加详情页链接或种子ID:",-1)),o(b,{modelValue:Y.value,"onUpdate:modelValue":e[14]||(e[14]=a=>Y.value=a),placeholder:"请输入完整的详情页链接或种子ID",clearable:"",onKeyup:qt(Le,["enter"])},null,8,["modelValue"]),e[47]||(e[47]=s("p",{class:"input-hint"}," 支持输入完整链接（如：https://example.com/details.php?id=123）或仅输入数字ID（如：9999999996） ",-1))])),s("div",La,[o(w,{onClick:e[15]||(e[15]=a=>h.value=!1)},{default:n(()=>[...e[48]||(e[48]=[c("取消",-1)])]),_:1}),ge(z.value?.data,z.value?.name)?$("",!0):(u(),R(w,{key:0,type:"success",onClick:Le,disabled:!Y.value||Y.value.trim()===""},{default:n(()=>[...e[49]||(e[49]=[c(" 添加链接 ",-1)])]),_:1},8,["disabled"])),ge(z.value?.data,z.value?.name)?(u(),R(w,{key:1,type:"primary",onClick:ut},{default:n(()=>[...e[50]||(e[50]=[c(" 设为不存在 ",-1)])]),_:1})):$("",!0)])])]),_:1})])):$("",!0),se.value?(u(),f("div",Oa,[o(le,{class:"filter-card",style:{"max-width":"600px"}},{header:n(()=>[s("div",Ba,[e[52]||(e[52]=s("span",null,"请选择转种的源站点",-1)),o(w,{type:"danger",circle:"",onClick:e[17]||(e[17]=a=>se.value=!1),plain:""},{default:n(()=>[...e[51]||(e[51]=[c("X",-1)])]),_:1})])]),default:n(()=>[s("div",Fa,[s("p",ja,[o(i,{type:"success",size:"large",style:{"margin-right":"5px"}},{default:n(()=>[...e[53]||(e[53]=[c("可获取数据",-1)])]),_:1}),o(i,{type:"primary",size:"large",style:{"margin-right":"5px"}},{default:n(()=>[...e[54]||(e[54]=[c("点击尝试使用iyuu获取链接",-1)])]),_:1}),o(i,{type:"error",size:"large",style:{"margin-right":"5px",opacity:"0.5"}},{default:n(()=>[...e[55]||(e[55]=[c("缺少配置参数",-1)])]),_:1})]),y.value.length>0?(u(),f("div",Aa,[s("p",Wa,"已缓存的站点 ("+p(y.value.length)+")",1),s("div",Ka,[(u(!0),f(j,null,H(r.value.filter(a=>y.value.includes(a.name)),a=>Ve((u(),R(i,{key:a.name,type:je(a,de(a.name)),class:J([{"is-selectable":de(a.name),"cached-site-tag":!0},"site-tag"]),onClick:x=>de(a.name)&&Me(Oe(a.name)),"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.5)"},{default:n(()=>[c(p(a.name)+" ✓ ",1)]),_:2},1032,["type","class","onClick"])),[[Te,xe.value[a.name]]])),128))])])):$("",!0),r.value.some(a=>!y.value.includes(a.name))?(u(),f("div",qa,[e[56]||(e[56]=s("p",{class:"uncached-sites-label"},"未缓存的站点",-1)),s("div",Ya,[(u(!0),f(j,null,H(r.value.filter(a=>!y.value.includes(a.name)),a=>Ve((u(),R(i,{key:a.name,type:je(a,de(a.name)),class:J([{"is-selectable":de(a.name)},"site-tag"]),style:Ht(!a.has_cookie||(a.name==="杜比"||a.name==="HDtime"||a.name==="肉丝")&&!a.has_passkey?"opacity: 0.5":""),size:"large",onClick:x=>de(a.name)&&Me(Oe(a.name)),"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.5)"},{default:n(()=>[c(p(a.name),1)]),_:2},1032,["type","class","style","onClick"])),[[Te,xe.value[a.name]]])),128))])])):$("",!0)]),s("div",Ha,[o(w,{type:"warning",onClick:Be,loading:d.value,plain:""},{default:n(()=>[...e[57]||(e[57]=[c("IYUU查询",-1)])]),_:1},8,["loading"]),o(w,{type:"success",onClick:e[18]||(e[18]=a=>it(U.value)),plain:""},{default:n(()=>[...e[58]||(e[58]=[c("上盒",-1)])]),_:1}),o(w,{onClick:e[19]||(e[19]=a=>se.value=!1)},{default:n(()=>[...e[59]||(e[59]=[c("取消",-1)])]),_:1})])]),_:1})])):$("",!0),o(Ys,{onRefresh:rt})])}}}),el=Je(Ga,[["__scopeId","data-v-55c9b30b"]]);export{el as default};
